<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.loli.net/css?family=Noto+Serif+SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{&quot;hostname&quot;:&quot;keeganli.github.com&quot;,&quot;root&quot;:&quot;&#x2F;&quot;,&quot;images&quot;:&quot;&#x2F;images&quot;,&quot;scheme&quot;:&quot;Gemini&quot;,&quot;version&quot;:&quot;8.4.0&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;display&quot;:&quot;post&quot;,&quot;padding&quot;:18,&quot;offset&quot;:12},&quot;copycode&quot;:false,&quot;bookmark&quot;:{&quot;enable&quot;:true,&quot;color&quot;:&quot;#222&quot;,&quot;save&quot;:&quot;auto&quot;},&quot;fancybox&quot;:false,&quot;mediumzoom&quot;:false,&quot;lazyload&quot;:false,&quot;pangu&quot;:false,&quot;comments&quot;:{&quot;style&quot;:&quot;tabs&quot;,&quot;active&quot;:null,&quot;storage&quot;:true,&quot;lazyload&quot;:false,&quot;nav&quot;:null},&quot;motion&quot;:{&quot;enable&quot;:true,&quot;async&quot;:false,&quot;transition&quot;:{&quot;post_block&quot;:&quot;fadeIn&quot;,&quot;post_header&quot;:&quot;fadeInDown&quot;,&quot;post_body&quot;:&quot;fadeInDown&quot;,&quot;coll_header&quot;:&quot;fadeInLeft&quot;,&quot;sidebar&quot;:&quot;fadeInUp&quot;}},&quot;prism&quot;:false,&quot;i18n&quot;:{&quot;placeholder&quot;:&quot;搜索...&quot;,&quot;empty&quot;:&quot;没有找到任何搜索结果：${query}&quot;,&quot;hits_time&quot;:&quot;找到 ${hits} 个搜索结果（用时 ${time} 毫秒）&quot;,&quot;hits&quot;:&quot;找到 ${hits} 个搜索结果&quot;}}</script>
<meta name="description" content="终身浪漫">
<meta property="og:type" content="website">
<meta property="og:title" content="GaoMing&#39;s Blog">
<meta property="og:url" content="https://keeganli.github.com/index.html">
<meta property="og:site_name" content="GaoMing&#39;s Blog">
<meta property="og:description" content="终身浪漫">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="GaoMing">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://keeganli.github.com/">



<script class="next-config" data-name="page" type="application/json">{&quot;sidebar&quot;:&quot;&quot;,&quot;isHome&quot;:true,&quot;isPost&quot;:false,&quot;lang&quot;:&quot;zh-CN&quot;,&quot;comments&quot;:&quot;&quot;,&quot;permalink&quot;:&quot;&quot;,&quot;path&quot;:&quot;index.html&quot;,&quot;title&quot;:&quot;&quot;}</script>

<script class="next-config" data-name="calendar" type="application/json">&quot;&quot;</script>
<title>GaoMing's Blog</title><script src="/js/config.js"></script>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">GaoMing's Blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">
    <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=28445534&auto=0&height=66"></iframe>
  
    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">GaoMing</p>
  <div class="site-description" itemprop="description">终身浪漫</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">26</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">26</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://keeganli.github.com/2022/05/05/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GaoMing">
      <meta itemprop="description" content="终身浪漫">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GaoMing's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/05/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-05 12:35:46 / 修改时间：14:13:47" itemprop="dateCreated datePublished" datetime="2022-05-05T12:35:46Z">2022-05-05</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>title: 计算机图形学基础知识<br>tags: 计算机图形学<br>categories: [计算机图形学,计算机图形学基础知识]</p>
<h1 id="图形学"><a href="#图形学" class="headerlink" title="图形学"></a>图形学</h1><h1 id="绪论"><a href="#绪论" class="headerlink" title="绪论"></a>绪论</h1><h3 id="图形学基本概念"><a href="#图形学基本概念" class="headerlink" title="图形学基本概念"></a>图形学基本概念</h3><ol>
<li><p>什么是计算机图形学？</p>
<p><strong>ISO定义:计算机图形学是研究通过计算机将数据转换为图形，并在专门的显示设备上显示的原理、方法和技术的学科</strong></p>
</li>
<li><p>图形组成和表示</p>
<p>几何要素和非几何要素</p>
<p>点阵法和参数法</p>
</li>
<li><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504191354296.png" alt="image-20220504191354296" style="zoom: 67%;"></li>
<li><p>计算机图形学应用</p>
<p>图形用户界面，计算机辅助设计，科学可视化，计算机艺术，虚拟现实。</p>
<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504191714897.png"></li>
<li><p>计算机图形学发展史</p>
<p>画线显示器，存储管式显示器，刷新式光栅扫描显示器，液晶显示器</p>
</li>
<li><p>计算机图形学当前研究的热点问题</p>
<p>造型技术，真实感图形绘制，人机交互。</p>
</li>
<li><p>小结</p>
<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504191847247.png" alt="image-20220504191847247" style="zoom:67%;"></li>
<li><p>课后习题</p>
<p>（1）什么是计算机图形学？其研究内容有哪些？</p>
<p>​    <strong>计算机图形学是研究通过计算机将数据转换成图形，并在专门的显示设备上显示的原理，方法和技术的学科</strong></p>
<p>（2）使用计算机图形学可以解决哪些问题？</p>
<p>​    <strong>。。。</strong></p>
</li>
</ol>
<h1 id="计算机显示—图形设备"><a href="#计算机显示—图形设备" class="headerlink" title="计算机显示—图形设备"></a>计算机显示—图形设备</h1><h2 id="计算机图形处理的硬件系统组成"><a href="#计算机图形处理的硬件系统组成" class="headerlink" title="计算机图形处理的硬件系统组成"></a>计算机图形处理的硬件系统组成</h2><h3 id="组成"><a href="#组成" class="headerlink" title="组成"></a>组成</h3><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504192614543.png" alt="image-20220504192614543" style="zoom: 80%;">

<h2 id="显示器"><a href="#显示器" class="headerlink" title="显示器"></a>显示器</h2><h3 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h3><ul>
<li><p>阴极射线管（CRT）</p>
</li>
<li><p>平板型显示器（液晶，等离子）</p>
<p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504192948818.png" alt="image-20220504192948818"></p>
</li>
</ul>
<h3 id="比较"><a href="#比较" class="headerlink" title="比较"></a>比较</h3><ol>
<li><p>LCD体积小，厚度薄，重量轻，耗能少，辐射少</p>
</li>
<li><p>CRT显示亮度高，色彩鲜艳，分辨率高</p>
<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504193016520.png" alt="image-20220504193016520" style="zoom:80%;"></li>
</ol>
<h2 id="光栅扫描显示系统"><a href="#光栅扫描显示系统" class="headerlink" title="光栅扫描显示系统"></a>光栅扫描显示系统</h2><h3 id="基本原理"><a href="#基本原理" class="headerlink" title="基本原理"></a>基本原理</h3><p>​    电子束按固定的扫描线和扫描顺序从左到右，自上而下进行扫描</p>
<h3 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h3><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504193158562.png" alt="image-20220504193158562"></p>
<h3 id="组成-1"><a href="#组成-1" class="headerlink" title="组成"></a>组成</h3><ol>
<li><p>帧缓冲存储器（帧缓存）</p>
<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504193408998.png" alt="image-20220504193408998" style="zoom:80%;">

<p><strong>帧缓冲容量</strong></p>
<p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504193621913.png" alt="image-20220504193621913"></p>
<p>像素数*所需帧缓存单元的位数（每个单元可表示几种颜色，例如真彩色默认每种基色占8bit，所以一个帧缓存单元占24bit，即24/8=3B）</p>
<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504194223915.png" alt="image-20220504194223915" style="zoom:80%;"></li>
<li><p>视频控制器</p>
</li>
<li><p>显示处理器</p>
</li>
<li><p>显示器（CRT，液晶）</p>
</li>
</ol>
<h3 id="颜色模型—三基色"><a href="#颜色模型—三基色" class="headerlink" title="颜色模型—三基色"></a>颜色模型—三基色</h3><h4 id="RGB（红绿蓝）"><a href="#RGB（红绿蓝）" class="headerlink" title="RGB（红绿蓝）"></a>RGB（红绿蓝）</h4><h4 id="CMY（三补色，蓝绿-品红-黄）"><a href="#CMY（三补色，蓝绿-品红-黄）" class="headerlink" title="CMY（三补色，蓝绿 品红 黄）"></a>CMY（三补色，蓝绿 品红 黄）</h4><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504194400694.png" alt="image-20220504194400694" style="zoom:67%;">

<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504194516441.png" alt="image-20220504194516441"></p>
<h3 id="光栅显示系统的组成"><a href="#光栅显示系统的组成" class="headerlink" title="光栅显示系统的组成"></a>光栅显示系统的组成</h3><ul>
<li>CPU</li>
<li>主存储器</li>
<li>图形显示处理器</li>
<li>视频显示控制器</li>
<li>显示器</li>
</ul>
<h1 id="直线段的扫描转换"><a href="#直线段的扫描转换" class="headerlink" title="直线段的扫描转换"></a>直线段的扫描转换</h1><h2 id="直线绘制要求"><a href="#直线绘制要求" class="headerlink" title="直线绘制要求"></a>直线绘制要求</h2><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504195205038.png" alt="image-20220504195205038"></p>
<p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504195549710.png" alt="image-20220504195549710"></p>
<h2 id="直线方程法"><a href="#直线方程法" class="headerlink" title="直线方程法"></a>直线方程法</h2><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504195702268.png" alt="image-20220504195702268"></p>
<h2 id="数值微分DDA算法"><a href="#数值微分DDA算法" class="headerlink" title="数值微分DDA算法"></a>数值微分DDA算法</h2><ul>
<li><p>灵活使用递推</p>
<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504195757303.png" alt="image-20220504195757303" style="zoom:67%;"></li>
<li><p>Yi+1 = Yi + k  Xi+1 = Xi + 1</p>
</li>
</ul>
<h2 id="中点算法"><a href="#中点算法" class="headerlink" title="中点算法"></a>中点算法</h2><ol>
<li><p>消除DDA算法中浮点运算，改为采用中点值比较。</p>
</li>
<li><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504200010020.png" alt="image-20220504200010020" style="zoom:67%;"></li>
<li><p>基本原理</p>
<ul>
<li><p>假定x是最大位移方向（0&lt;=k&lt;=1）</p>
<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504200123323.png" alt="image-20220504200123323" style="zoom:67%;"></li>
<li><p>误差项d的递推</p>
<p>di &lt; 0  ==&gt; di+1 = di + 1 - k</p>
<p>di &gt;= 0 ==&gt; di+1 = di - k</p>
<p>初始值d0 = 0.5 - k</p>
</li>
</ul>
</li>
<li><p>算法步骤</p>
<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504200503389.png" alt="image-20220504200503389" style="zoom:67%;"></li>
<li><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504201606201.png" alt="image-20220504201606201" style="zoom:67%;"></li>
</ol>
<h2 id="小结-1"><a href="#小结-1" class="headerlink" title="小结"></a>小结</h2><ol>
<li><p><strong>比较直线段扫描转换四种算法中的运算特点</strong></p>
<p>方程法：运算量大，简单好上手</p>
<p>微分DDA：运算较方程法简单，有浮点四舍五入。</p>
<p>中点（基本的<code>Bresenham</code>）：运用递推，消除浮点运算</p>
<p>改进<code>Bresenham</code>：速度快，效率高，运动递推，进一步简化中点算法</p>
</li>
<li><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504202150206.png" alt="image-20220504202150206"></p>
</li>
</ol>
<ul>
<li>​            <img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504202212110.png" alt="image-20220504202212110"></li>
</ul>
<h1 id="圆弧的扫描转换"><a href="#圆弧的扫描转换" class="headerlink" title="圆弧的扫描转换"></a>圆弧的扫描转换</h1><h2 id="方程法"><a href="#方程法" class="headerlink" title="方程法"></a>方程法</h2><h2 id="中点算法-1"><a href="#中点算法-1" class="headerlink" title="中点算法"></a>中点算法</h2><h2 id="逼近法"><a href="#逼近法" class="headerlink" title="逼近法"></a>逼近法</h2><h1 id="区域填充算法"><a href="#区域填充算法" class="headerlink" title="区域填充算法"></a>区域填充算法</h1><h2 id="逐点判断法"><a href="#逐点判断法" class="headerlink" title="逐点判断法"></a>逐点判断法</h2><h3 id="基本原理-1"><a href="#基本原理-1" class="headerlink" title="基本原理"></a>基本原理</h3><p>​    判断绘画窗口内的像素是否在多边形内，若在，用指定颜色绘制该像素</p>
<h3 id="判断点在多边形的内外关系"><a href="#判断点在多边形的内外关系" class="headerlink" title="判断点在多边形的内外关系"></a>判断点在多边形的内外关系</h3><ol>
<li><p>射线法</p>
<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504204448711.png" alt="image-20220504204448711" style="zoom:67%;">

<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504204612847.png" alt="image-20220504204612847" style="zoom:67%;">

<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504204634707.png" alt="image-20220504204634707" style="zoom:67%;"></li>
<li><p>累计角度法</p>
</li>
<li><p>编码法</p>
</li>
</ol>
<h2 id="扫描线算法"><a href="#扫描线算法" class="headerlink" title="扫描线算法"></a>扫描线算法</h2><h3 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h3><p>​    利用相邻像素的连贯性，提高算法效率</p>
<h3 id="扫描线"><a href="#扫描线" class="headerlink" title="扫描线"></a>扫描线</h3><ul>
<li>​    平行于坐标轴的直线（一般平行于X轴）</li>
</ul>
<h3 id="基本方法"><a href="#基本方法" class="headerlink" title="基本方法"></a>基本方法</h3><ol>
<li>​    将整个绘图窗口内扫描多边形的问题分解为<strong>一条条扫描线计算与多边形的相交区间</strong>，只要完成每条扫描线的生成就实现了多边形的扫描转换</li>
<li>​    一条扫描线与多边形的边有<strong>偶数</strong>个交点，<strong>每2个点形成一区间，区间内的像素位于多边形内</strong></li>
</ol>
<h3 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h3><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504205843610.png" alt="image-20220504205843610"></p>
<p><strong>边表的构造</strong></p>
<ol>
<li>首先构造一个纵向链表，链表的长度为多边形所占有的最大扫描线数，链表的每个结点，称为一个桶，则对应多边形覆盖的每一条扫描线。</li>
<li>将每条边的信息链入与该边最小y坐标（ymin）相对应的桶处。也就是说，若某边的较低端点为ymin，则该边就放在相应的扫描线桶中。</li>
<li>每条边的数据形成一个结点，内容包括:该扫描线与该边的初始交点x(即较低端点的x值)，1/k，以及该边的最大y值<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504210123315.png" alt="image-20220504210123315" style="zoom:50%;"></li>
<li>同一桶中若干条边按X|ymin由小到大排序，若X|ymax相等，则按照1/k由小到大排序。</li>
</ol>
<h3 id="活性边表（AEL）"><a href="#活性边表（AEL）" class="headerlink" title="活性边表（AEL）"></a>活性边表（AEL）</h3><p>​    存放活性边的顺序链表，且按照<strong>交点x的值从小到大排序</strong></p>
<p>​    <img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504210611397.png" alt="image-20220504210611397" style="zoom: 80%;"></p>
<h3 id="完整算法"><a href="#完整算法" class="headerlink" title="完整算法"></a>完整算法</h3><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504210719023.png" alt="image-20220504210719023"></p>
<h2 id="边缘填充法"><a href="#边缘填充法" class="headerlink" title="边缘填充法"></a>边缘填充法</h2><h2 id="小结-2"><a href="#小结-2" class="headerlink" title="小结"></a>小结</h2><ol>
<li><p><strong>多边形扫描转换的扫描线算法步骤？</strong></p>
<ul>
<li>求出扫描线与多边形所有边的交点</li>
<li>把这些交点按x坐标值升序排列</li>
<li>对排序后的交点进行奇偶配对</li>
<li>对每一对交点间区域进行填充</li>
</ul>
<p>扫描线利用了相邻像素间的连贯性，提高了算法效率</p>
</li>
<li><p><strong>扫描线算法转换多边形交点取整的三条规则</strong></p>
<p>（1）x为小数</p>
<ul>
<li>交点位于左边，向右取整</li>
<li>交点位于右边，向左取整</li>
</ul>
<p>（2）落在右上边界的像素不予填充，落在左下边界的像素给予填充</p>
<p>（3）交点是顶点</p>
<ul>
<li><p>检查两相邻边在扫描线的哪一侧，决定交点个数为0，1，2个</p>
</li>
<li><p>上同侧（2），异侧（1），下同侧（0）</p>
<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504213749718.png" alt="image-20220504213749718" style="zoom:67%;"></li>
</ul>
</li>
<li><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220504213911280.png" alt="image-20220504213911280"></p>
</li>
<li><p><strong>多边形填充过程中，对于某一条扫描线，填充可以分什么步骤?</strong></p>
<ol>
<li>求交，排序，交点配对，区间填色。</li>
<li>特殊问题：（1）交点取舍问题（2）像素取舍问题</li>
</ol>
</li>
</ol>
<h1 id="反走样"><a href="#反走样" class="headerlink" title="反走样"></a>反走样</h1><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>​    用离散量表示连续量引起的失真，就叫走样，用于消除或者减少这种效果的技术，就叫反走样。</p>
<h2 id="过取样"><a href="#过取样" class="headerlink" title="过取样"></a>过取样</h2><h3 id="简单过取样"><a href="#简单过取样" class="headerlink" title="简单过取样"></a>简单过取样</h3><p>调整位置上的像素亮度</p>
<h3 id="离散计算相交区域近似面积"><a href="#离散计算相交区域近似面积" class="headerlink" title="离散计算相交区域近似面积"></a>离散计算相交区域近似面积</h3><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505155035761.png" alt="image-20220505155035761"></p>
<h1 id="自由曲线和曲面"><a href="#自由曲线和曲面" class="headerlink" title="自由曲线和曲面"></a>自由曲线和曲面</h1><h2 id="曲线的表示形式"><a href="#曲线的表示形式" class="headerlink" title="曲线的表示形式"></a>曲线的表示形式</h2><ol>
<li><p>参数表示</p>
<p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505155246801.png" alt="image-20220505155246801"></p>
</li>
<li><p>非参数表示</p>
<p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505155227913.png" alt="image-20220505155227913"></p>
</li>
</ol>
<h2 id="参数表示优点"><a href="#参数表示优点" class="headerlink" title="参数表示优点"></a>参数表示优点</h2><ol>
<li>容易确定曲线边界，由参数区间确定</li>
<li>表示形式不变性，不依赖坐标系的选取</li>
<li>表示能力强，利于控制点来控制曲线形状。</li>
</ol>
<h2 id="切矢量，法矢量，曲率"><a href="#切矢量，法矢量，曲率" class="headerlink" title="切矢量，法矢量，曲率"></a>切矢量，法矢量，曲率</h2><h3 id="位置矢量"><a href="#位置矢量" class="headerlink" title="位置矢量"></a>位置矢量</h3><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505155638171.png" alt="image-20220505155638171"></p>
<h3 id="切矢量"><a href="#切矢量" class="headerlink" title="切矢量"></a>切矢量</h3><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505155753892.png" alt="image-20220505155753892"></p>
<h3 id="法矢量"><a href="#法矢量" class="headerlink" title="法矢量"></a>法矢量</h3><p>与切矢量垂直</p>
<h3 id="曲率，曲率半径"><a href="#曲率，曲率半径" class="headerlink" title="曲率，曲率半径"></a>曲率，曲率半径</h3><h2 id="参数多项式曲线"><a href="#参数多项式曲线" class="headerlink" title="参数多项式曲线"></a>参数多项式曲线</h2><h3 id="n次多项式曲线"><a href="#n次多项式曲线" class="headerlink" title="n次多项式曲线"></a>n次多项式曲线</h3><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505160112360.png" alt="image-20220505160112360"></p>
<h3 id="矩阵表示"><a href="#矩阵表示" class="headerlink" title="矩阵表示"></a>矩阵表示</h3><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505160159896.png" alt="image-20220505160159896">



<h2 id="三次Hermite（厄密多）曲线"><a href="#三次Hermite（厄密多）曲线" class="headerlink" title="三次Hermite（厄密多）曲线"></a>三次Hermite（厄密多）曲线</h2><h3 id="矩阵表示-1"><a href="#矩阵表示-1" class="headerlink" title="矩阵表示"></a>矩阵表示</h3><h2 id="Bezier曲线"><a href="#Bezier曲线" class="headerlink" title="Bezier曲线"></a>Bezier曲线</h2><h3 id="Bezier基函数"><a href="#Bezier基函数" class="headerlink" title="Bezier基函数"></a>Bezier基函数</h3><h4 id="n阶基函数"><a href="#n阶基函数" class="headerlink" title="n阶基函数"></a>n阶基函数</h4><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505160848721.png" alt="image-20220505160848721" style="zoom:150%;">

<h3 id="Bezier基函数的基本性质"><a href="#Bezier基函数的基本性质" class="headerlink" title="Bezier基函数的基本性质"></a>Bezier基函数的基本性质</h3><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505161014350.png" alt="image-20220505161014350" style="zoom:150%;">



<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505161120951.png" alt="image-20220505161120951" style="zoom:150%;">

<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505161143010.png" alt="image-20220505161143010" style="zoom:150%;">

<h2 id="Bezier曲线-1"><a href="#Bezier曲线-1" class="headerlink" title="Bezier曲线"></a>Bezier曲线</h2><h3 id="一次Bezier曲线"><a href="#一次Bezier曲线" class="headerlink" title="一次Bezier曲线"></a>一次Bezier曲线</h3><p>​    n = 1,有两个控制点P0和P1（Bezier多项式是一次多项式）</p>
<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505161804409.png" alt="image-20220505161804409" style="zoom:150%;">



<h3 id="二次Bezier曲线"><a href="#二次Bezier曲线" class="headerlink" title="二次Bezier曲线"></a>二次Bezier曲线</h3><p>​    n = 2,有三个控制点P0,P1和P2,Bezier多项式是二次多项式</p>
<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505161929123.png" alt="image-20220505161929123" style="zoom:150%;">

<h3 id="三次Bezier曲线"><a href="#三次Bezier曲线" class="headerlink" title="三次Bezier曲线"></a>三次Bezier曲线</h3><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505162220892.png" alt="image-20220505162220892" style="zoom:150%;">

<h2 id="几何作图法"><a href="#几何作图法" class="headerlink" title="几何作图法"></a>几何作图法</h2><ol>
<li><p>线段P0P1上选择一个点P(t)</p>
<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505162333343.png" alt="image-20220505162333343" style="zoom:150%;"></li>
<li><p>依次对每一条边执行a过程</p>
</li>
</ol>
<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505162554936.png" alt="image-20220505162554936" style="zoom:150%;">

<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505162628570.png" alt="image-20220505162628570" style="zoom:150%;">

<h2 id="德卡斯特里奥算法"><a href="#德卡斯特里奥算法" class="headerlink" title="德卡斯特里奥算法"></a>德卡斯特里奥算法</h2><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505162828809.png" alt="image-20220505162828809"></p>
<h2 id="Bezier曲面"><a href="#Bezier曲面" class="headerlink" title="Bezier曲面"></a>Bezier曲面</h2><p>​    利用两组正交的Bezier曲线逼近，由控制点网格描述的曲面</p>
<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505170118940.png" alt="image-20220505170118940" style="zoom:150%;">

<h2 id="B样条曲线"><a href="#B样条曲线" class="headerlink" title="B样条曲线"></a>B样条曲线</h2><p>​    B样条有三大要素：*<strong>节点，控制点，阶次。*</strong></p>
<p>​    控制点和贝塞尔的一样，就是空间上决定曲线形状的点。</p>
<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505171231575.png" alt="image-20220505171231575" style="zoom:150%;">

<h2 id="小结-3"><a href="#小结-3" class="headerlink" title="小结"></a>小结</h2><ol>
<li><img src="/.com//Users\user\AppData\Roaming\Typora\typora-user-images\image-20220505171407855.png" alt="image-20220505171407855" style="zoom:150%;">

<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505171453760.png" alt="image-20220505171453760"></li>
<li><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505171519983.png" alt="image-20220505171519983"></p>
<p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505172010436.png" alt="image-20220505172010436"></p>
<p>deCasteljau ==&gt;P(0.6)</p>
<p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505172114508.png" alt="image-20220505172114508"></p>
</li>
<li><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505172145921.png" alt="image-20220505172145921" style="zoom:150%;">

<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505172406789.png" alt="image-20220505172406789" style="zoom:150%;"></li>
<li><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505172803428.png" alt="image-20220505172803428"></p>
<p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505173008774.png" alt="image-20220505173008774"></p>
</li>
</ol>
<h1 id="图形变换-几何变换"><a href="#图形变换-几何变换" class="headerlink" title="图形变换-几何变换"></a>图形变换-几何变换</h1><h2 id="学习如何使图形变化"><a href="#学习如何使图形变化" class="headerlink" title="学习如何使图形变化"></a>学习如何使图形变化</h2><h2 id="平移变换"><a href="#平移变换" class="headerlink" title="平移变换"></a>平移变换</h2><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505194941095.png" alt="image-20220505194941095"></p>
<h2 id="旋转变换"><a href="#旋转变换" class="headerlink" title="旋转变换"></a>旋转变换</h2><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505195047273.png" alt="image-20220505195047273"></p>
<ol>
<li><p>变换前后坐标关系</p>
<p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505195211191.png" alt="image-20220505195211191"></p>
</li>
</ol>
<h2 id="放缩变换"><a href="#放缩变换" class="headerlink" title="放缩变换"></a>放缩变换</h2><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505195456720.png" alt="image-20220505195456720"></p>
<h2 id="齐次坐标"><a href="#齐次坐标" class="headerlink" title="齐次坐标"></a>齐次坐标</h2><h3 id="齐次坐标的引入"><a href="#齐次坐标的引入" class="headerlink" title="齐次坐标的引入"></a>齐次坐标的引入</h3><ul>
<li>几何变换矩阵运算表示形式不统一</li>
<li>对多个点同时进行相同的多次变换时，分别利用矩阵计算各点变换的计算量大</li>
<li>统一运算，对连续变换==&gt;合成变换矩阵</li>
</ul>
<h3 id="齐次坐标的定义"><a href="#齐次坐标的定义" class="headerlink" title="齐次坐标的定义"></a>齐次坐标的定义</h3><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505195939728.png" alt="image-20220505195939728"></p>
<p>二维空间的二维物体 == &gt; 三维空间的二维物体</p>
<h3 id="平移变换-1"><a href="#平移变换-1" class="headerlink" title="平移变换"></a><strong>平移变换</strong></h3><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505200130935.png" alt="image-20220505200130935"></p>
<h3 id="旋转变换-1"><a href="#旋转变换-1" class="headerlink" title="旋转变换"></a><strong>旋转变换</strong></h3><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505200151565.png" alt="image-20220505200151565"></p>
<h3 id="放缩变换-1"><a href="#放缩变换-1" class="headerlink" title="放缩变换"></a><strong>放缩变换</strong></h3><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505200216788.png" alt="image-20220505200216788" style="zoom:150%;">

<h3 id="对称变换"><a href="#对称变换" class="headerlink" title="对称变换"></a><strong>对称变换</strong></h3><h4 id="关于X轴的对称变换"><a href="#关于X轴的对称变换" class="headerlink" title="关于X轴的对称变换"></a>关于X轴的对称变换</h4><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505201721730.png" alt="image-20220505201721730" style="zoom:150%;">

<h4 id="关于Y轴的对称变换"><a href="#关于Y轴的对称变换" class="headerlink" title="关于Y轴的对称变换"></a>关于Y轴的对称变换</h4><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505201749735.png" alt="image-20220505201749735" style="zoom:150%;">

<h3 id="错切变换"><a href="#错切变换" class="headerlink" title="错切变换"></a>错切变换</h3><p>​    <strong>依赖轴</strong>：不变</p>
<p>​    <strong>方向轴</strong>：余下的轴</p>
<h3 id="变换性质"><a href="#变换性质" class="headerlink" title="变换性质"></a>变换性质</h3><ol>
<li>平移和旋转具有可加性</li>
<li>放缩具有可乘性</li>
</ol>
<h3 id="逆变换（反变换）"><a href="#逆变换（反变换）" class="headerlink" title="逆变换（反变换）"></a>逆变换（反变换）</h3><ol>
<li>正向平移 – 反向平移</li>
<li>逆时针旋转 –顺时针旋转 </li>
<li>逆放缩</li>
</ol>
<p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505200707438.png" alt="image-20220505200707438"></p>
<p>本质：高维空间的低维物体，高维表示低维</p>
<h3 id="复合变换"><a href="#复合变换" class="headerlink" title="复合变换"></a>复合变换</h3><h4 id="实例1-关于任意参照点Pr（Xr-Yr）的旋转变换"><a href="#实例1-关于任意参照点Pr（Xr-Yr）的旋转变换" class="headerlink" title="实例1 - 关于任意参照点Pr（Xr,Yr）的旋转变换"></a>实例1 - 关于任意参照点Pr（Xr,Yr）的旋转变换</h4><ol>
<li><p>平移对象使基准点到坐标原点</p>
<p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505200130935.png" alt="image-20220505200130935"></p>
</li>
<li><p>绕坐标原点旋转</p>
<p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505200151565.png" alt="image-20220505200151565"></p>
</li>
<li><p>平移对象使参照点回到原始位置</p>
<p>​    a.步骤的逆变换</p>
<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505201138965.png" alt="image-20220505201138965" style="zoom:150%;"></li>
</ol>
<h4 id="实例2-关于任意参照点Pr（Xr-Yr）的放缩变换"><a href="#实例2-关于任意参照点Pr（Xr-Yr）的放缩变换" class="headerlink" title="实例2 - 关于任意参照点Pr（Xr,Yr）的放缩变换"></a>实例2 - 关于任意参照点Pr（Xr,Yr）的放缩变换</h4><ol>
<li><p>平移对象使基准点到坐标原点</p>
<p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505200130935.png" alt="image-20220505200130935"></p>
</li>
<li><p>放缩</p>
<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505200216788.png" alt="image-20220505200216788" style="zoom:150%;"></li>
<li><p>平移对象使参照点回到原始位置</p>
<p>​    a.步骤的逆变换</p>
<img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505201138965.png" alt="image-20220505201138965" style="zoom:150%;"></li>
</ol>
<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ol>
<li>左行右列原则（对矩阵的初等变换）</li>
<li>变换的现后顺序改变会可能导致变换结果的不同（AB != BA ）</li>
<li><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505201550325.png" alt="image-20220505201550325"></li>
</ol>
<h2 id="三维几何变换"><a href="#三维几何变换" class="headerlink" title="三维几何变换"></a>三维几何变换</h2><h3 id="平移"><a href="#平移" class="headerlink" title="平移"></a><strong>平移</strong></h3><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505202132122.png" alt="image-20220505202132122"></p>
<h3 id="放缩"><a href="#放缩" class="headerlink" title="放缩"></a><strong>放缩</strong></h3><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505202148078.png" alt="image-20220505202148078"></p>
<h3 id="旋转"><a href="#旋转" class="headerlink" title="旋转"></a><strong>旋转</strong></h3><h4 id="绕X轴"><a href="#绕X轴" class="headerlink" title="绕X轴"></a>绕X轴</h4><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505202308439.png" alt="image-20220505202308439"></p>
<h4 id="绕Y轴"><a href="#绕Y轴" class="headerlink" title="绕Y轴"></a>绕Y轴</h4><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505202320307.png" alt="image-20220505202320307"></p>
<h4 id="绕Z轴"><a href="#绕Z轴" class="headerlink" title="绕Z轴"></a>绕Z轴</h4><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505202337905.png" alt="image-20220505202337905"></p>
<h3 id="错切"><a href="#错切" class="headerlink" title="错切"></a><strong>错切</strong></h3><h4 id="z为依赖轴"><a href="#z为依赖轴" class="headerlink" title="z为依赖轴"></a>z为依赖轴</h4><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505202413961.png" alt="image-20220505202413961"></p>
<h3 id="对称变换-1"><a href="#对称变换-1" class="headerlink" title="对称变换"></a>对称变换</h3><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505202450475.png" alt="image-20220505202450475"></p>
<h1 id="图形裁剪"><a href="#图形裁剪" class="headerlink" title="图形裁剪"></a>图形裁剪</h1><h2 id="直线段的裁剪"><a href="#直线段的裁剪" class="headerlink" title="直线段的裁剪"></a>直线段的裁剪</h2><h2 id="位置关系"><a href="#位置关系" class="headerlink" title="位置关系"></a>位置关系</h2><ol>
<li>完全落在窗口内</li>
<li>完全落在窗口外</li>
<li>部分在内，部分在外</li>
</ol>
<h2 id="区域编码法（Cohen-Sutherland）"><a href="#区域编码法（Cohen-Sutherland）" class="headerlink" title="区域编码法（Cohen-Sutherland）"></a>区域编码法（Cohen-Sutherland）</h2><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505204207733.png" alt="image-20220505204207733"></p>
<h3 id="算法步骤"><a href="#算法步骤" class="headerlink" title="算法步骤"></a>算法步骤</h3><ol>
<li>两端点编码全为<strong>0000</strong> ==&gt; 线段<strong>完全在窗口内</strong></li>
<li>两端点编码<strong>按位与不为0000</strong> ==&gt;线段<strong>完全在窗口外</strong></li>
<li>两端点编码<strong>按位与为0000</strong> ==&gt; 计算边界延长线和线段交点，若<strong>交点在延长线，完全在外</strong>，<strong>否则</strong>部分在内，<strong>部分在内，根据交点裁剪</strong></li>
</ol>
<h2 id="中点分割裁剪法"><a href="#中点分割裁剪法" class="headerlink" title="中点分割裁剪法"></a>中点分割裁剪法</h2><h3 id="思想"><a href="#思想" class="headerlink" title="思想"></a>思想</h3><p>​    首先根据编码法判断线段与窗口的位置关系，如果部分在内，采用找到离线段两端点最远的可见点，两个可见点间的连线即为要输出的可见线段。</p>
<h3 id="算法步骤-1"><a href="#算法步骤-1" class="headerlink" title="算法步骤"></a>算法步骤</h3><p>P141</p>
<h2 id="多边形的裁剪"><a href="#多边形的裁剪" class="headerlink" title="多边形的裁剪"></a>多边形的裁剪</h2><h3 id="Sutherland-Hodgman算法（逐边裁剪算法）"><a href="#Sutherland-Hodgman算法（逐边裁剪算法）" class="headerlink" title="Sutherland-Hodgman算法（逐边裁剪算法）"></a>Sutherland-Hodgman算法（逐边裁剪算法）</h3><h4 id="算法思想"><a href="#算法思想" class="headerlink" title="算法思想"></a>算法思想</h4><p>​    依次使用窗口的四条边对多边形进行裁剪</p>
<h4 id="算法步骤-2"><a href="#算法步骤-2" class="headerlink" title="算法步骤"></a>算法步骤</h4><p>P145</p>
<p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505210636164.png" alt="image-20220505210636164"></p>
<h4 id="算法优缺"><a href="#算法优缺" class="headerlink" title="算法优缺"></a>算法优缺</h4><p>​    算法简单，可推广至任意凸多边形，对凹多边形可能会出现问题（可能会出现多余线段）</p>
<h4 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h4><p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505211002320.png" alt="image-20220505211002320"></p>
<h3 id="Weiler-Atherton算法（双边裁剪算法）"><a href="#Weiler-Atherton算法（双边裁剪算法）" class="headerlink" title="Weiler-Atherton算法（双边裁剪算法）"></a>Weiler-Atherton算法（双边裁剪算法）</h3><p>​    见习题 和 课本 P146</p>
<h2 id="习题"><a href="#习题" class="headerlink" title="习题"></a>习题</h2><h3 id="简要说明二维观察的过程-几何变换、窗口裁剪的作用是什么"><a href="#简要说明二维观察的过程-几何变换、窗口裁剪的作用是什么" class="headerlink" title="简要说明二维观察的过程,几何变换、窗口裁剪的作用是什么?"></a>简要说明二维观察的过程,几何变换、窗口裁剪的作用是什么?</h3><p>​    <img src="/.com//Users/86176/OneDrive/%E6%A1%8C%E9%9D%A2/IMG_3723.JPG" alt="IMG_3723"></p>
<pre><code>###     在二维平面上将某一图形关于任意参照点P(x，y)逆时针旋转日角度，试写出该图形变换所对应的变换矩阵，并给出具体求解过程。
</code></pre>
<p><img src="/.com//Users/86176/OneDrive/%E6%A1%8C%E9%9D%A2/IMG_3724.JPG" alt="IMG_3724"></p>
<h3 id><a href="#" class="headerlink" title></a><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505212705629.png" alt="image-20220505212705629"></h3><p><img src="/.com//Users/86176/OneDrive/%E6%A1%8C%E9%9D%A2/IMG_3725.JPG" alt="IMG_3725"> </p>
<p><img src="https://gitee.com/lkksxxdxxd/pic-go/raw/master/img/image-20220505212801019.png" alt="image-20220505212801019"></p>
<p><img src="/.com//Users/86176/OneDrive/%E6%A1%8C%E9%9D%A2/IMG_3726.JPG" alt="IMG_3726"></p>
<p><img src="/.com//Users/86176/OneDrive/%E6%A1%8C%E9%9D%A2/IMG_3727.JPG" alt="IMG_3727"></p>
<h1 id="几何造型基础"><a href="#几何造型基础" class="headerlink" title="几何造型基础"></a>几何造型基础</h1><h2 id="三维模型"><a href="#三维模型" class="headerlink" title="三维模型"></a>三维模型</h2><p>​    线框，曲面，实体</p>
<h2 id="几何造型功能"><a href="#几何造型功能" class="headerlink" title="几何造型功能"></a>几何造型功能</h2><ol>
<li>形体输入</li>
<li>图形控制</li>
<li>图形修改</li>
<li>图形分析</li>
</ol>
<h2 id="线框模型"><a href="#线框模型" class="headerlink" title="线框模型"></a>线框模型</h2><h3 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h3><ol>
<li>简单，处理速度快</li>
<li>没有固定的轮廓</li>
<li>线框模型与形体之间不存在一一对应关系：</li>
<li>没有形体的表面信息，不适于真实感显示，由此导致表示的形体可能产生二义性。</li>
</ol>
<h2 id="曲面模型"><a href="#曲面模型" class="headerlink" title="曲面模型"></a>曲面模型</h2><h3 id="优缺点-1"><a href="#优缺点-1" class="headerlink" title="优缺点"></a>优缺点</h3><p>​    不能有效地表示实体</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://keeganli.github.com/2022/04/26/Linux%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GaoMing">
      <meta itemprop="description" content="终身浪漫">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GaoMing's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/04/26/Linux%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/" class="post-title-link" itemprop="url">Linux应用开发</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-04-25 22:24:23 / 修改时间：14:31:16" itemprop="dateCreated datePublished" datetime="2022-04-25T22:24:23Z">2022-04-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Linux%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">Linux应用开发</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="shell程序设计"><a href="#shell程序设计" class="headerlink" title="shell程序设计"></a>shell程序设计</h1><h2 id="实验内容"><a href="#实验内容" class="headerlink" title="实验内容"></a>实验内容</h2><ul>
<li>设计shell程序实现签到签退系统。</li>
</ul>
<h2 id="核心代码"><a href="#核心代码" class="headerlink" title="核心代码"></a>核心代码</h2><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">#! &#x2F;usr&#x2F;bin&#x2F;env bash
function main()&#123;
    echo &quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;;
    echo &quot;     Welcome to the Attendance System&quot;;
    echo &quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;;

    # init and create the file;
    if [[ ! -e UserInfo.dat ]]; then  #-e 判断对象是否存在 
            touch userinfo.dat   #保存用户名和密码
         chmod 777 UserInfo.dat #若要rwx属性则4+2+1&#x3D;7；
    fi
    if [[ ! -e KaoqinInfo.dat ]]; then
        touch KaoqinInfo.dat   #保存迟到早退信息
       chmod 777 KaoqinInfo.dat
    fi
    if [[ ! -e KaoqinInfoCheckOut.dat ]]; then
        touch KaoqinInfoCheckOut.dat   #保存迟到早退信息
       chmod 777 KaoqinInfoCheckOut.dat
    fi
    Choose;
    read -p &quot;Input your option : &quot; choice
    if [[ $choice -eq 1 ]];
        then 
            read -p &quot;Account Name : &quot; username
            read -p &quot;Password : &quot; password
            Logining $username $password;
            menu $username;
    elif [[ $choice -eq 2 ]];
        then
            read -p &quot;Register Account Name : &quot; username
            read -p &quot;Register Account Password : &quot; password
            Register $username;
    fi

&#125;
function Choose()&#123;
    echo &quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;;
    echo &quot; 1 : Sign                     2 : Register&quot;
    echo &quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;;
&#125;
function signIn()&#123;
    # Choose;
    # read -p &quot;Input your option : &quot; cho
    if [[ $cho -eq 1 ]];
        then 
            # read -p &quot;Account Name : &quot; username
            # read -p &quot;Password : &quot; password
            Logining $username $password;
        else
            read -p &quot;Register Account Name : &quot; username
            read -p &quot;Register Account Password : &quot; password
            Register $username $password;
    fi
&#125;
function Register()&#123;
    echo $username:$password &gt;&gt; UserInfo.dat
    echo &quot;Please Sign In or Input :wq To Quit&quot;
    read -p &quot;Acount Name or Quit: &quot; infos
    if [[ $infos &#x3D;&#x3D;  &quot;:wq&quot; ]];
        then 
            return 0;
        else
            read -p &quot;Account Password : &quot; password;
            menu $username
    fi
&#125;
function Logining()&#123;
    while read line
        do
            if [[ &quot;$line&quot; &#x3D;&#x3D; &quot;$username:$password&quot; ]]; 
            then 
                return 0
            fi
    done &lt; UserInfo.dat
    echo &quot;Wrong Accout Name or Password&quot;;
    read -p &quot;Accout Name : &quot; username
    read -p &quot;Accout Password : &quot; password
    Logining $username $password
&#125;
function menu()&#123;
      
    while [[ 1 &#x3D;&#x3D; 1 ]];
    do
        echo &quot;&quot;;
        echo &quot;                       ***Menu***                           &quot;;
        echo &quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;;
        echo &quot;         (1)            CheckIn                             &quot;;
        echo &quot;         (2)           CheckOuts                            &quot;;
        echo &quot;         (3)   View attendance information                  &quot;;
        echo &quot;         (4)             Quit                               &quot;;
        echo &quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;;
        read -p &quot;Please Input Your Choice : &quot; ans
        case $ans in
            1 )
                CheckIn $username; ;;               
            2 )
                CheckOut $username; ;;
            3 )
                Status $username; ;;
            4 )
               exit 0; ;;
            * )
                echo -e &quot;Please Choose Options!\n&quot;
       esac
    done
&#125;
function CheckIn()&#123;
    hour&#x3D;&#96;date +%H&#96;
    if [[ $hour -gt 8 ]]; then
        echo &quot;&quot;;
        echo &quot;-------------------------------------&quot;;
        echo &quot;You&#39;re late for work !  Recorded!&quot;
        echo &quot;$username : Lated Time : &#96;date&#96;&quot; &gt;&gt; KaoqinInfo.dat
    else
        echo &quot;You Have Successfully Signed! Have A Nice Day!&quot;
    fi
&#125;
function CheckOut()&#123;
    echo &quot;CheckOut Successful&quot;
     hour&#x3D;&#96;date +%H&#96;
     if [[ $hour -lt 18 ]]; then
         echo &quot;You are leaving early now! Recorded!&quot;
         echo &quot;$username : CheckOut Early : Time:&#96;date&#96;&quot; &gt;&gt; KaoqinInfoCheckOut.dat
     fi
     main;
&#125;
function Status()&#123;
    while [[ 1 &#x3D;&#x3D; 1 ]]
    do 
        echo &quot;&quot;;
        echo &quot;        ***Query Service***          &quot;;
        echo &quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;;
        echo &quot;     (1)    Late Arrivals            &quot;;
        echo &quot;     (2)   Early Departures           &quot;;
        echo &quot;     (3)        Quit                 &quot;;
        echo &quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;;
        read -p &quot;PLease Input Your Options : &quot; chos
        case $chos in
            1 ) 
                QuerySer $username; ;;
            2 ) 
                EarlyDep $username; ;;
            3 ) 
                return 0; ;;
            * )
                echo -e &quot;Please Choose Options!\n&quot;
        esac
    done
            
&#125;
function EarlyDep () &#123; 
    grep  &quot;$username&quot; KaoqinInfoCheckOut.dat
&#125;

function QuerySer()&#123;
    grep &quot;$username&quot; KaoqinInfo.dat;
&#125;
main<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="C程序开发工具"><a href="#C程序开发工具" class="headerlink" title="C程序开发工具"></a>C程序开发工具</h1><h2 id="实验内容-1"><a href="#实验内容-1" class="headerlink" title="实验内容"></a>实验内容</h2><ul>
<li><p>熟悉<code>vim</code>编辑器的基本操作</p>
</li>
<li><p>掌握<code>gcc</code>和<code>gdb</code>的使用方法</p>
</li>
<li><p> 熟悉使用<code>make</code>管理多文件项目</p>
</li>
<li><p>设计机考座次生成程序</p>
</li>
</ul>
<h2 id="设计思路"><a href="#设计思路" class="headerlink" title="设计思路"></a>设计思路</h2><p><code>slove</code>设计思路：</p>
<ul>
<li>依次分配每个教室的每个座位</li>
<li>因为之前生成的指定的人数大小的随机数，保证每次启动程序排序结果均不同。</li>
<li>依次往座位放入学生序号，并保证当前座位的学生与前面座位的学生不同专业和班级，若无法保证，进入（4）</li>
<li>将无法放入的学生序号暂时存入临时队列，在下次无法放入学生时，从临时队列查找是否有满足要求的学生放入。</li>
<li>直至最后，如果临时数组仍有学生，则先判断座位剩余情况，若剩余座位充足，则尝试放入学生，若还有不可放入学生，最后遍历全部座位，尝试插入或者交换。</li>
<li>根据flag，返回函数结果</li>
</ul>
<h2 id="核心代码-1"><a href="#核心代码-1" class="headerlink" title="核心代码"></a>核心代码</h2>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://keeganli.github.com/2022/01/23/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8F%8A%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GaoMing">
      <meta itemprop="description" content="终身浪漫">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GaoMing's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/01/23/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8F%8A%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/" class="post-title-link" itemprop="url">计算机及操作系统基础</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-01-23 14:18:11 / 修改时间：09:37:58" itemprop="dateCreated datePublished" datetime="2022-01-23T14:18:11Z">2022-01-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E5%B8%88/" itemprop="url" rel="index"><span itemprop="name">数据处理师</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E5%B8%88/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8F%8A%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/" itemprop="url" rel="index"><span itemprop="name">计算机及操作系统基础</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="计算机基础知识"><a href="#计算机基础知识" class="headerlink" title="计算机基础知识"></a>计算机基础知识</h1><h2 id="计算机技术的发展"><a href="#计算机技术的发展" class="headerlink" title="计算机技术的发展"></a>计算机技术的发展</h2><ol>
<li>第一代计算机（1946-1957）<ul>
<li> 电子管</li>
<li>机器语言和汇编语言</li>
<li>体积大，运算速度低，成本高，可靠性差，内存容量小</li>
<li>主要用于科学计算，从事军事和科学研究方面的工作</li>
</ul>
</li>
<li>第二代计算机（1958-1964）<ul>
<li> 晶体管</li>
<li>高级程序设计语言</li>
<li>较第一代均有较大提升</li>
<li>运用扩展到数据处理，自动控制等方面</li>
</ul>
</li>
<li><h2 id="第三代计算机（1965-1970）"><a href="#第三代计算机（1965-1970）" class="headerlink" title="第三代计算机（1965-1970）"></a>第三代计算机（1965-1970）</h2></li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://keeganli.github.com/2022/01/21/Web%E9%A1%B9%E7%9B%AE%E4%B9%8B%E4%BA%BA%E4%BA%8B%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GaoMing">
      <meta itemprop="description" content="终身浪漫">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GaoMing's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/01/21/Web%E9%A1%B9%E7%9B%AE%E4%B9%8B%E4%BA%BA%E4%BA%8B%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/" class="post-title-link" itemprop="url">Web项目之人事资源管理系统</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-01-21 10:55:00 / 修改时间：04:08:22" itemprop="dateCreated datePublished" datetime="2022-01-21T10:55:00Z">2022-01-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Web%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">Web应用开发</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Web%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/Web%E9%A1%B9%E7%9B%AE/" itemprop="url" rel="index"><span itemprop="name">Web项目</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Web%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/Web%E9%A1%B9%E7%9B%AE/%E4%BA%BA%E4%BA%8B%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/" itemprop="url" rel="index"><span itemprop="name">人事资源管理系统</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="项目Gitee"><a href="#项目Gitee" class="headerlink" title="项目Gitee"></a>项目Gitee</h1><p><a target="_blank" rel="noopener" href="https://gitee.com/lkksxxdxxd/WebProgect">地址</a></p>
<p><a target="_blank" rel="noopener" href="http://keegan.cn/">博客地址</a></p>
<h1 id="项目需求"><a href="#项目需求" class="headerlink" title="项目需求"></a>项目需求</h1><h2 id="人力资源管理系统定位"><a href="#人力资源管理系统定位" class="headerlink" title="人力资源管理系统定位"></a>人力资源管理系统定位</h2><ul>
<li> 实现的人力资源管理系统面向股东，员工以及实习生服务。</li>
<li>通过实现各模块功能，通过系统的方法进行公司的人员的加入,内部调动及离职人员变动,并为这些人员流动提供辅助管理。</li>
<li>以确保在适当的职位上又各种适当的人才能够既有效率又有效能地完成各项任务。</li>
</ul>
<h2 id="用户权限与认证"><a href="#用户权限与认证" class="headerlink" title="用户权限与认证"></a>用户权限与认证</h2><ul>
<li> 本模块实现的功能是用户的注册以及权限的分配，连接数据库和<code>shiro</code>实现用户安全，结合<code>thymeleaf-shiro</code>实现用户权限分组。</li>
<li><code>JS</code>设计登录的密码长度判断，用户名格式是否正确。</li>
<li>登陆成功跳转到主页，或者选择注册，注册成功后，跳转到登录。</li>
<li>不同权限用户可查看的页面不同，操作权限也不同。</li>
</ul>
<h2 id="部门管理"><a href="#部门管理" class="headerlink" title="部门管理"></a>部门管理</h2><ul>
<li>前端方面，需要画树状图，在点击结点的时候，显示其对应部门下的所有员工。</li>
<li>在这里，树状图的绘制通过模板的<code>fuel ux</code>库完成。</li>
<li>在前端中得到从后端传来的<code>json</code>字符串作为画树状图的数据源，在js中用其<code>parse</code>函数转换为<code>js</code>对象，并定义渲染时的回调函数。</li>
<li>在点击结点的时候，调用一个<code>jumptoDepartment</code>函数，根据点击的节点自动跳转到相应的部门人员显示页面。</li>
<li>后端方面，建立一颗树用来表示部门之间的从属关系，每个结点中用一个<code>List</code>储存子部门的各个信息，同时给前端提供其相应的函数。</li>
</ul>
<h2 id="薪资管理"><a href="#薪资管理" class="headerlink" title="薪资管理"></a>薪资管理</h2><ul>
<li>员工信息统计：<pre><code>包括基础工资，所属部门，每月加班时长累计，每月考勤请假情况等；并且实现查询功能，员工信息添加功能，删除功能，分页功能，模糊查询功能，分页查询功能。
</code></pre>
</li>
<li>薪资明细表：<br> 算出员工的奖金，处罚金，纳税金额，最后结算工资；并且实现查询功能，删除功能，分页功能，模糊查询功能，分页查询功能。</li>
</ul>
<h2 id="考勤管理"><a href="#考勤管理" class="headerlink" title="考勤管理"></a>考勤管理</h2><ul>
<li> 本模块实现的功能是查看员工的考勤状况</li>
<li>将员工的考勤状态分为：1：出勤，2：请假，3：出差，4：加班，5：补休，6：调班，7：停工。</li>
<li>页面在显示状态的同时也显示出员工的ID，姓名，状态的开始和结束时间，并添加备注。</li>
<li>在每个员工表格行的末尾添加修改功能，点击修改跳转到修改页面，可以修改该员工考勤状态、时间和备注。</li>
<li>另外增加了筛选功能，可以通过选择考勤状况查看处于该状态的员工。</li>
</ul>
<h2 id="人事处理"><a href="#人事处理" class="headerlink" title="人事处理"></a>人事处理</h2><ul>
<li>此模块实现调动管理管理模块，包括职员入职、转正、调岗、调薪、离职、复职等业务。</li>
</ul>
<h2 id="发布部署到服务器"><a href="#发布部署到服务器" class="headerlink" title="发布部署到服务器"></a>发布部署到服务器</h2><ul>
<li>项目最终打包（jar）发布到服务器。</li>
</ul>
<h1 id="项目设计"><a href="#项目设计" class="headerlink" title="项目设计"></a>项目设计</h1><h2 id="登录注册"><a href="#登录注册" class="headerlink" title="登录注册"></a>登录注册</h2><img src="https://ibb.co/G5Lyn1V" alt="https://ibb.co/G5Lyn1V" style="zoom: 33%;">

<h2 id="部门管理-1"><a href="#部门管理-1" class="headerlink" title="部门管理"></a>部门管理</h2><img src="https://ibb.co/rttNvzg" alt="https://ibb.co/rttNvzg" style="zoom: 50%;">

<h2 id="薪资管理-1"><a href="#薪资管理-1" class="headerlink" title="薪资管理"></a>薪资管理</h2><img src="/.com//Users\86176\OneDrive\桌面\3.png" style="zoom:60%;">

<h2 id="考勤管理-1"><a href="#考勤管理-1" class="headerlink" title="考勤管理"></a>考勤管理</h2><img src="/.com//Users\86176\OneDrive\桌面\4.png" style="zoom: 33%;">

<h2 id="人事处理-1"><a href="#人事处理-1" class="headerlink" title="人事处理"></a>人事处理</h2><p><img src="/.com//Users\86176\OneDrive\桌面\5.png"></p>
<h2 id="数据库设计"><a href="#数据库设计" class="headerlink" title="数据库设计"></a>数据库设计</h2><h3 id="Userall（用户）"><a href="#Userall（用户）" class="headerlink" title="Userall（用户）"></a><code>Userall</code>（用户）</h3><table>
<thead>
<tr>
<th align="center">名</th>
<th align="center">类型</th>
<th align="center">长度</th>
<th align="center">小数点</th>
<th align="center">不是null</th>
<th align="center"></th>
</tr>
</thead>
<tbody><tr>
<td align="center">user</td>
<td align="center">varchar</td>
<td align="center">255</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">key</td>
</tr>
<tr>
<td align="center">password</td>
<td align="center">varchar</td>
<td align="center">255</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">salt</td>
<td align="center">varchar</td>
<td align="center">255</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center"></td>
</tr>
</tbody></table>
<h3 id="UserPer（用户权限）"><a href="#UserPer（用户权限）" class="headerlink" title="UserPer（用户权限）"></a><code>UserPer</code>（用户权限）</h3><table>
<thead>
<tr>
<th align="center">名</th>
<th align="center">类型</th>
<th align="center">长度</th>
<th align="center">小数点</th>
<th align="center">不是null</th>
<th align="center"></th>
</tr>
</thead>
<tbody><tr>
<td align="center">user</td>
<td align="center">varchar</td>
<td align="center">255</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">key</td>
</tr>
<tr>
<td align="center">perms</td>
<td align="center">varchar</td>
<td align="center">255</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center"></td>
</tr>
</tbody></table>
<h3 id="department（部门）"><a href="#department（部门）" class="headerlink" title="department（部门）"></a><code>department</code>（部门）</h3><table>
<thead>
<tr>
<th align="center">名</th>
<th align="center">类型</th>
<th align="center">长度</th>
<th align="center">小数点</th>
<th align="center">不是null</th>
<th align="center"></th>
</tr>
</thead>
<tbody><tr>
<td align="center">department</td>
<td align="center">varchar</td>
<td align="center">255</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">d_id</td>
<td align="center">int</td>
<td align="center">255</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">key</td>
</tr>
<tr>
<td align="center">parid</td>
<td align="center">int</td>
<td align="center">255</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center"></td>
</tr>
</tbody></table>
<h3 id="employees（职员【所有】）"><a href="#employees（职员【所有】）" class="headerlink" title="employees（职员【所有】）"></a><code>employees</code>（职员【所有】）</h3><table>
<thead>
<tr>
<th align="center">名</th>
<th align="center">类型</th>
<th align="center">长度</th>
<th align="center">小数点</th>
<th align="center">不是null</th>
<th align="center"></th>
</tr>
</thead>
<tbody><tr>
<td align="center">id</td>
<td align="center">int</td>
<td align="center">11</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">key</td>
</tr>
<tr>
<td align="center">name</td>
<td align="center">varchar</td>
<td align="center">255</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">age</td>
<td align="center">int</td>
<td align="center">11</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">sex</td>
<td align="center">varchar</td>
<td align="center">2</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">phone</td>
<td align="center">varchar</td>
<td align="center">255</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">email</td>
<td align="center">varchar</td>
<td align="center">255</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">dName</td>
<td align="center">varchar</td>
<td align="center">255</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">pName</td>
<td align="center">varchar</td>
<td align="center">255</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">gName</td>
<td align="center">varchar</td>
<td align="center">255</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">flag</td>
<td align="center">bit</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
</tbody></table>
<h3 id="gangwei（岗位）"><a href="#gangwei（岗位）" class="headerlink" title="gangwei（岗位）"></a><code>gangwei</code>（岗位）</h3><table>
<thead>
<tr>
<th align="center">名</th>
<th align="center">类型</th>
<th align="center">长度</th>
<th align="center">小数点</th>
<th align="center">不是null</th>
<th align="center"></th>
</tr>
</thead>
<tbody><tr>
<td align="center">name</td>
<td align="center">varchar</td>
<td align="center">255</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">g_id</td>
<td align="center">int</td>
<td align="center">255</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">key</td>
</tr>
</tbody></table>
<h3 id="kaoqin（考勤）"><a href="#kaoqin（考勤）" class="headerlink" title="kaoqin（考勤）"></a><code>kaoqin</code>（考勤）</h3><table>
<thead>
<tr>
<th align="center">名</th>
<th align="center">类型</th>
<th align="center">长度</th>
<th align="center">小数点</th>
<th align="center">不是null</th>
<th align="center"></th>
</tr>
</thead>
<tbody><tr>
<td align="center">id</td>
<td align="center">int</td>
<td align="center">11</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">key</td>
</tr>
<tr>
<td align="center">name</td>
<td align="center">varchar</td>
<td align="center">255</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">type</td>
<td align="center">int</td>
<td align="center">11</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">start</td>
<td align="center">date</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">end</td>
<td align="center">date</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">remark</td>
<td align="center">varchar</td>
<td align="center">255</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center"></td>
</tr>
</tbody></table>
<h3 id="position（职位）"><a href="#position（职位）" class="headerlink" title="position（职位）"></a><code>position</code>（职位）</h3><table>
<thead>
<tr>
<th align="center">名</th>
<th align="center">类型</th>
<th align="center">长度</th>
<th align="center">小数点</th>
<th align="center">不是null</th>
<th align="center"></th>
</tr>
</thead>
<tbody><tr>
<td align="center">position</td>
<td align="center">varchar</td>
<td align="center">255</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">p_id</td>
<td align="center">int</td>
<td align="center">255</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">key</td>
</tr>
<tr>
<td align="center">level</td>
<td align="center">int</td>
<td align="center">255</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center"></td>
</tr>
</tbody></table>
<h3 id="salary（薪资）"><a href="#salary（薪资）" class="headerlink" title="salary（薪资）"></a><code>salary</code>（薪资）</h3><table>
<thead>
<tr>
<th align="center">名</th>
<th align="center">类型</th>
<th align="center">长度</th>
<th align="center">小数点</th>
<th align="center">不是null</th>
<th align="center"></th>
</tr>
</thead>
<tbody><tr>
<td align="center">time</td>
<td align="center">varchar</td>
<td align="center">255</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">gid</td>
<td align="center">int</td>
<td align="center">11</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">key</td>
</tr>
<tr>
<td align="center">pid</td>
<td align="center">int</td>
<td align="center">11</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">username</td>
<td align="center">varchar</td>
<td align="center">255</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">basicSalary</td>
<td align="center">int</td>
<td align="center">11</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">dname</td>
<td align="center">varchar</td>
<td align="center">255</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">workovertime</td>
<td align="center">int</td>
<td align="center">11</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">checkaccout</td>
<td align="center">int</td>
<td align="center">11</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
</tbody></table>
<h1 id="项目核心代码"><a href="#项目核心代码" class="headerlink" title="项目核心代码"></a>项目核心代码</h1><h1 id="详细设计"><a href="#详细设计" class="headerlink" title="详细设计"></a>详细设计</h1><h2 id="登录与注册"><a href="#登录与注册" class="headerlink" title="登录与注册"></a>登录与注册</h2><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/index"</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token class-name">RequestMethod</span><span class="token punctuation">.</span>GET<span class="token punctuation">)</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">indexPage</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> map<span class="token punctuation">,</span> <span class="token class-name">HttpSession</span> session<span class="token punctuation">,</span> <span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">Model</span> model<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token comment">/** 
         * 使用shiro编写认证的操作 
         */</span>  
        <span class="token comment">//1.获取Subject  </span>
        <span class="token class-name">Subject</span> subject <span class="token operator">=</span> <span class="token class-name">SecurityUtils</span><span class="token punctuation">.</span><span class="token function">getSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//2.封装用户数据  </span>
        <span class="token class-name">UsernamePasswordToken</span> token <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UsernamePasswordToken</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>  
<span class="token comment">//3.执行登录方法  </span>
            subject<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            session<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token keyword">return</span> <span class="token string">"index"</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">UnknownAccountException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token comment">//登录失败，用户名错误  </span>
            model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"msg"</span><span class="token punctuation">,</span> <span class="token string">"用户名不存在！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token keyword">return</span> <span class="token string">"login"</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IncorrectCredentialsException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token comment">//登录失败，密码错误  </span>
            model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"msg"</span><span class="token punctuation">,</span> <span class="token string">"用户名或密码错误！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token keyword">return</span> <span class="token string">"login"</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
<span class="token punctuation">&#125;</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/login"</span><span class="token punctuation">)</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">regPageToLogin</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> map<span class="token punctuation">,</span> <span class="token class-name">HttpSession</span> session<span class="token punctuation">,</span> <span class="token class-name">Model</span> model<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
  
        <span class="token class-name">Userall</span> userall <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Userall</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>username <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> password <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token keyword">return</span> <span class="token string">"reg"</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>password<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token operator">||</span> password<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token keyword">return</span> <span class="token string">"reg"</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
        <span class="token class-name">Userall</span> userall1 <span class="token operator">=</span> userCheckServiceImpl<span class="token punctuation">.</span><span class="token function">selectByKeyName</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>userall1 <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">,</span> <span class="token string">"用户名重复"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token keyword">return</span> <span class="token string">"reg"</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>  
            <span class="token class-name">Integer</span> id <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token keyword">boolean</span> flag <span class="token operator">=</span> userCheckServiceImpl<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token keyword">if</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token comment">//设置用户权限  </span>
  
                <span class="token class-name">String</span> role <span class="token operator">=</span> employServiceImpl<span class="token punctuation">.</span><span class="token function">getRole</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
                userCheckServiceImpl<span class="token punctuation">.</span><span class="token function">insertUserPer</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> role<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token keyword">return</span> <span class="token string">"login"</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  
                <span class="token class-name">Userall</span> usercheck <span class="token operator">=</span> userCheckServiceImpl<span class="token punctuation">.</span><span class="token function">selectByNameAndPassword</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token keyword">if</span> <span class="token punctuation">(</span>usercheck <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                    <span class="token keyword">return</span> <span class="token string">"reg"</span><span class="token punctuation">;</span>  
                <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  
                    <span class="token keyword">return</span> <span class="token string">"login"</span><span class="token punctuation">;</span>  
                <span class="token punctuation">&#125;</span>  
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">,</span> <span class="token string">"用户名不符合数字格式"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token keyword">return</span> <span class="token string">"reg"</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
<span class="token punctuation">&#125;</span>  
<span class="token comment">/** 
     * 执行认证逻辑 
     * 
     * @param authenticationToken 
     * @return 
     * @throws AuthenticationException 
     */</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">protected</span> <span class="token class-name">AuthenticationInfo</span> <span class="token function">doGetAuthenticationInfo</span><span class="token punctuation">(</span><span class="token class-name">AuthenticationToken</span> authenticationToken<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">AuthenticationException</span> <span class="token punctuation">&#123;</span>  
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"执行认证：Authentiction"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
        <span class="token comment">//假设数据库的用户名和密码  </span>
        <span class="token class-name">UsernamePasswordToken</span> token <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">UsernamePasswordToken</span><span class="token punctuation">)</span> authenticationToken<span class="token punctuation">;</span>  
  
        <span class="token class-name">Userall</span> user <span class="token operator">=</span> userCheckService<span class="token punctuation">.</span><span class="token function">selectByKeyName</span><span class="token punctuation">(</span>token<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">String</span> <span class="token class-name">DBPassword</span> <span class="token operator">=</span> user<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">String</span> <span class="token class-name">Salt</span> <span class="token operator">=</span> user<span class="token punctuation">.</span><span class="token function">getSalt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Salt</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SimpleAuthenticationInfo</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span><span class="token class-name">DBPassword</span><span class="token punctuation">,</span> <span class="token class-name">ByteSource<span class="token punctuation">.</span>Util</span><span class="token punctuation">.</span><span class="token function">bytes</span><span class="token punctuation">(</span><span class="token class-name">Salt</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">&#125;</span>  
<span class="token annotation punctuation">@Override</span>  
   <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
       <span class="token class-name">String</span> <span class="token class-name">Salt</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecureRandomNumberGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nextBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
       <span class="token comment">//加密  </span>
       <span class="token class-name">SimpleHash</span> simpleHash <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleHash</span><span class="token punctuation">(</span><span class="token string">"md5"</span><span class="token punctuation">,</span>password<span class="token punctuation">,</span><span class="token class-name">Salt</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
       <span class="token class-name">String</span> <span class="token class-name">NewPassword</span> <span class="token operator">=</span> simpleHash<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
       <span class="token comment">//System.out.println(password);  </span>
       userallMapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span><span class="token class-name">NewPassword</span><span class="token punctuation">,</span><span class="token class-name">Salt</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
       <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  
   <span class="token punctuation">&#125;</span>  	<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-signin<span class="token punctuation">"</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/index<span class="token punctuation">"</span></span> <span class="token attr-name">id</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>signForm<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-signin-heading text-center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sign-title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>登录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>../static/images/login-top.png<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>login-wrap<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>User ID<span class="token punctuation">"</span></span> <span class="token attr-name">autofocus</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">id</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>required<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Password<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">id</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>required<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>请输入4~10位密码<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">  
                <span class="token keyword">var</span> password <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.form-control'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token keyword">var</span> message <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.message'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
               password<span class="token punctuation">.</span><span class="token function-variable function">onblur</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                        message<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'密码长度错误，应为4~10位'</span><span class="token punctuation">;</span>  
                        message<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">'message wrong'</span><span class="token punctuation">;</span>  
  
                    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  
                        message<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'密码长度正确'</span><span class="token punctuation">;</span>  
                        message<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">'message right'</span><span class="token punctuation">;</span>  
                    <span class="token punctuation">&#125;</span>  
                <span class="token punctuation">&#125;</span>  
            </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-lg btn-login btn-block<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mycheck()<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span>  
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fa fa-check<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>registration<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/reg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
                    注册  
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>login-wrap<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">autofocus</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>输入编号，实习生请输入0<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>required<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">autofocus</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>required<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>请输入4~10位密码<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;error&#125;<span class="token punctuation">"</span></span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>red<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">  
                <span class="token keyword">var</span> password <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.form-control'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token keyword">var</span> message <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.message'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
                password<span class="token punctuation">.</span><span class="token function-variable function">onblur</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                        message<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'密码长度错误，应为4~10位'</span><span class="token punctuation">;</span>  
                        message<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">'message wrong'</span><span class="token punctuation">;</span>  
  
                    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  
                        message<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'密码长度正确'</span><span class="token punctuation">;</span>  
                        message<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">'message right'</span><span class="token punctuation">;</span>  
                    <span class="token punctuation">&#125;</span>  
                <span class="token punctuation">&#125;</span>  
            </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-lg btn-login btn-block<span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mycheck()<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fa fa-check<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>registration<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
                Already Registered.  
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>login.html<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
                    Login  
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>  
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="部门管理-2"><a href="#部门管理-2" class="headerlink" title="部门管理"></a>部门管理</h2><h3 id="Controller层"><a href="#Controller层" class="headerlink" title="Controller层"></a>Controller层</h3><h3 id="Service层"><a href="#Service层" class="headerlink" title="Service层"></a>Service层</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> departmentTree <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">Department</span> department<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span>departmentTree<span class="token punctuation">></span></span> children<span class="token punctuation">;</span>
    <span class="token function">departmentTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">departmentTree</span><span class="token punctuation">(</span><span class="token class-name">DepartmentMapper</span> departmentMapper<span class="token punctuation">,</span> <span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        department <span class="token operator">=</span> departmentMapper<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        department<span class="token punctuation">.</span><span class="token function">setdId</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        children <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span>departmentTree<span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> childrenId <span class="token operator">:</span> departmentMapper<span class="token punctuation">.</span><span class="token function">geIdtByParId</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            children<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">departmentTree</span><span class="token punctuation">(</span>departmentMapper<span class="token punctuation">,</span> childrenId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">// 获取该节点下所有的员工</span>
    <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employees</span><span class="token punctuation">></span></span> <span class="token function">getAllEmployee</span><span class="token punctuation">(</span><span class="token class-name">EmployeesMapper</span> employeesMapper<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employees</span><span class="token punctuation">></span></span> ans <span class="token operator">=</span> employeesMapper<span class="token punctuation">.</span><span class="token function">getBydName</span><span class="token punctuation">(</span>department<span class="token punctuation">.</span><span class="token function">getDepartment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>departmentTree tmp <span class="token operator">:</span> children<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            ans<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>tmp<span class="token punctuation">.</span><span class="token function">getAllEmployee</span><span class="token punctuation">(</span>employeesMapper<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> ans<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token class-name">Department</span> <span class="token function">getDepartment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> department<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span>departmentTree<span class="token punctuation">></span></span> <span class="token function">getChildren</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> children<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> departmentTool <span class="token keyword">implements</span> departmantToolService <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">DepartmentMapper</span> departmentMapper<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">EmployeesMapper</span> employeesMapper<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">getJSONByNode</span><span class="token punctuation">(</span>departmentTree node<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">JSONObject</span> JSON <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 获取该节点之下的所有值</span>
        <span class="token class-name">String</span> ch <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>departmentTree son <span class="token operator">:</span> node<span class="token punctuation">.</span><span class="token function">getChildren</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                ch <span class="token operator">=</span> <span class="token function">getJSONByNode</span><span class="token punctuation">(</span>son<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span>
                ch <span class="token operator">=</span> ch <span class="token operator">+</span> <span class="token string">","</span> <span class="token operator">+</span> <span class="token function">getJSONByNode</span><span class="token punctuation">(</span>son<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> <span class="token string">"&#123;"</span> <span class="token operator">+</span> <span class="token string">"\"name\": \""</span> <span class="token operator">+</span> node<span class="token punctuation">.</span><span class="token function">getDepartment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDepartment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token operator">+</span> <span class="token string">"\" ,\"type\": \""</span> <span class="token operator">+</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span><span class="token function">getChildren</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token string">"folder"</span> <span class="token operator">:</span> <span class="token string">"item"</span><span class="token punctuation">)</span>
                <span class="token operator">+</span> <span class="token string">"\" ,\"id\": "</span> <span class="token operator">+</span> node<span class="token punctuation">.</span><span class="token function">getDepartment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getdId</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token operator">+</span> <span class="token string">" ,\"children\": "</span> <span class="token operator">+</span> <span class="token string">"["</span> <span class="token operator">+</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token string">""</span> <span class="token operator">:</span> ch<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"]"</span>
                <span class="token operator">+</span> <span class="token string">"&#125;"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">// 获取根节点</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> departmentTree <span class="token function">getRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">departmentTree</span><span class="token punctuation">(</span>departmentMapper<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">// 获取JSON</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// JSONObject JSON = new JSONObject();</span>
        <span class="token keyword">return</span> <span class="token string">"["</span> <span class="token operator">+</span> <span class="token function">getJSONByNode</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">departmentTree</span><span class="token punctuation">(</span>departmentMapper<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">// 根据id寻找某个部门下所有的员工</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employees</span><span class="token punctuation">></span></span> <span class="token function">getEmployeeById</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">departmentTree</span><span class="token punctuation">(</span>departmentMapper<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAllEmployee</span><span class="token punctuation">(</span>employeesMapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Mapper层"><a href="#Mapper层" class="headerlink" title="Mapper层"></a>Mapper层</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Mapper</span>  
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DepartmentMapper</span> <span class="token punctuation">&#123;</span>  
    <span class="token keyword">int</span> <span class="token function">deleteByPrimaryKey</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> dId<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">int</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">Department</span> <span class="token keyword">record</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">int</span> <span class="token function">insertSelective</span><span class="token punctuation">(</span><span class="token class-name">Department</span> <span class="token keyword">record</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token class-name">Department</span> <span class="token function">selectByPrimaryKey</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> dId<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">int</span> <span class="token function">updateByPrimaryKeySelective</span><span class="token punctuation">(</span><span class="token class-name">Department</span> <span class="token keyword">record</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">int</span> <span class="token function">updateByPrimaryKey</span><span class="token punctuation">(</span><span class="token class-name">Department</span> <span class="token keyword">record</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select * from department where d_id = #&#123;id&#125; "</span><span class="token punctuation">)</span>  
    <span class="token class-name">Department</span> <span class="token function">getById</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select d_id from department where parid = #&#123;id&#125; "</span><span class="token punctuation">)</span>  
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> <span class="token function">geIdtByParId</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 通过父节点找到所有子节点的id  </span>
    <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select * from department"</span><span class="token punctuation">)</span>  
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Department</span><span class="token punctuation">></span></span> <span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">&#125;</span>  
<span class="token annotation punctuation">@Mapper</span>  
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">EmployeesMapper</span> <span class="token punctuation">&#123;</span>  
    <span class="token keyword">int</span> <span class="token function">deleteByPrimaryKey</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">int</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">Employees</span> <span class="token keyword">record</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">int</span> <span class="token function">insertSelective</span><span class="token punctuation">(</span><span class="token class-name">Employees</span> <span class="token keyword">record</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token class-name">Employees</span> <span class="token function">selectByPrimaryKey</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">int</span> <span class="token function">updateByPrimaryKeySelective</span><span class="token punctuation">(</span><span class="token class-name">Employees</span> <span class="token keyword">record</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">int</span> <span class="token function">updateByPrimaryKey</span><span class="token punctuation">(</span><span class="token class-name">Employees</span> <span class="token keyword">record</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select * from employees"</span><span class="token punctuation">)</span>  
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employees</span><span class="token punctuation">></span></span> <span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select * from employees where dName = #&#123;dName&#125; "</span><span class="token punctuation">)</span>  
    <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employees</span><span class="token punctuation">></span></span> <span class="token function">getBydName</span><span class="token punctuation">(</span><span class="token class-name">String</span> dName<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="前端HTML-amp-JS"><a href="#前端HTML-amp-JS" class="headerlink" title="前端HTML&amp;JS"></a>前端HTML&amp;JS</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> <span class="token function-variable function">DMPTree</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//main function to initiate the module</span>
        <span class="token function-variable function">init</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">var</span> <span class="token function-variable function">DataSourceTree</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_data  <span class="token operator">=</span> options<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_delay <span class="token operator">=</span> options<span class="token punctuation">.</span>delay<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
            <span class="token class-name">DataSourceTree</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
                <span class="token function-variable function">data</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    <span class="token keyword">var</span> nodes<span class="token punctuation">;</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">isEmptyObject</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        nodes <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_data<span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>
                    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                        <span class="token keyword">if</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>children <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> options<span class="token punctuation">.</span>children <span class="token operator">==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                            nodes <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
                        <span class="token punctuation">&#125;</span>
                        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                            nodes <span class="token operator">=</span> options<span class="token punctuation">.</span>children<span class="token punctuation">;</span>
                        <span class="token punctuation">&#125;</span>
                    <span class="token punctuation">&#125;</span>
                    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> data<span class="token operator">:</span> nodes <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_delay<span class="token punctuation">)</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> treeDataSourceDynamicStr <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#dataTreeSrc"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> treeDataSourceDynamic <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>treeDataSourceDynamicStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> deparmentTreeSrc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataSourceTree</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
                data<span class="token operator">:</span> treeDataSourceDynamic<span class="token punctuation">,</span>
                delay<span class="token operator">:</span> <span class="token number">400</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#DepartmentTree'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tree</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
                dataSource<span class="token operator">:</span> deparmentTreeSrc<span class="token punctuation">,</span>
                loadingHTML<span class="token operator">:</span> <span class="token string">'&lt;img src="../static/images/input-spinner.gif"/>'</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
前端管理跳转函数：
<span class="token operator">&lt;</span>script<span class="token operator">></span>
    <span class="token keyword">function</span> <span class="token function">jumpToDepartment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">var</span> dmpid <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#DepartmentTree'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tree</span><span class="token punctuation">(</span><span class="token string">'selectedItems'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>id<span class="token punctuation">;</span>
        window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">"/index/department/"</span> <span class="token operator">+</span> dmpid<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
<span class="token constant">HTML</span>接收后端传入json字符串：
<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"hidden"</span> id<span class="token operator">=</span><span class="token string">"dataTreeSrc"</span> th<span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">"$&#123;treeDataSrc&#125;"</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="薪资管理-2"><a href="#薪资管理-2" class="headerlink" title="薪资管理"></a>薪资管理</h2><h3 id="Controller层-1"><a href="#Controller层-1" class="headerlink" title="Controller层"></a>Controller层</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/index/salary_search"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">salary_select</span><span class="token punctuation">(</span><span class="token class-name">Model</span> model<span class="token punctuation">,</span><span class="token class-name">String</span> username<span class="token punctuation">,</span>
                                <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>required <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span>defaultValue<span class="token operator">=</span><span class="token string">"1"</span><span class="token punctuation">,</span>value<span class="token operator">=</span><span class="token string">"pageNum"</span><span class="token punctuation">)</span><span class="token class-name">Integer</span> pageNum<span class="token punctuation">,</span>
                                <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>defaultValue<span class="token operator">=</span><span class="token string">"5"</span><span class="token punctuation">,</span>value<span class="token operator">=</span><span class="token string">"pageSize"</span><span class="token punctuation">)</span><span class="token class-name">Integer</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>pageNum<span class="token operator">==</span><span class="token keyword">null</span> <span class="token operator">||</span> pageNum<span class="token operator">&lt;=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            pageNum <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>pageSize <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            pageSize <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token class-name">PageHelper</span><span class="token punctuation">.</span><span class="token function">startPage</span><span class="token punctuation">(</span>pageNum<span class="token punctuation">,</span>pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Salary</span><span class="token punctuation">></span></span> users<span class="token operator">=</span>salaryServiceImpl<span class="token punctuation">.</span><span class="token function">findUserByName</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">PageInfo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Salary</span><span class="token punctuation">></span></span> pageInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PageInfo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Salary</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>users<span class="token punctuation">,</span>pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
            model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"pageInfo"</span><span class="token punctuation">,</span>pageInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
            model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"salary"</span><span class="token punctuation">,</span>users<span class="token punctuation">)</span><span class="token punctuation">;</span>
            model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">,</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> <span class="token string">"salary_search"</span><span class="token punctuation">;</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/index/salary_delete/&#123;id&#125;"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">salary_delete</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        salaryServiceImpl<span class="token punctuation">.</span><span class="token function">salary_delete</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"redirect:/index/salary"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/index/salary_insert"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">insertPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token string">"salary_insert"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/index/salaryBack"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">Salary</span> salary<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        salaryServiceImpl<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"redirect:/index/salary_control"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Service层-1"><a href="#Service层-1" class="headerlink" title="Service层"></a>Service层</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Salary</span><span class="token punctuation">></span></span> <span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">salary_delete</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Salary</span><span class="token punctuation">></span></span> <span class="token function">findUserByName</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Salary</span> salary<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">Salary</span> salary<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Mapper层-1"><a href="#Mapper层-1" class="headerlink" title="Mapper层"></a>Mapper层</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select * from salary"</span><span class="token punctuation">)</span>
 <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Salary</span><span class="token punctuation">></span></span> <span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select * from kaoqin"</span><span class="token punctuation">)</span>
 <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Salary</span><span class="token punctuation">></span></span> <span class="token function">getKaqqinInformation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token comment">/*
     删除用户
*/</span>
 <span class="token annotation punctuation">@Delete</span><span class="token punctuation">(</span><span class="token string">"delete from salary\n"</span> <span class="token operator">+</span>
         <span class="token string">"    where gid = #&#123;gid,jdbcType=INTEGER&#125;"</span><span class="token punctuation">)</span>
 <span class="token keyword">int</span> <span class="token function">salary_delete</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> gid<span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token comment">/*
     查询用户信息
  */</span>
 <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select * from salary where username like CONCAT('%',#&#123;name&#125;,'%')"</span><span class="token punctuation">)</span>
 <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Salary</span><span class="token punctuation">></span></span> <span class="token function">findUserByName</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token annotation punctuation">@Insert</span><span class="token punctuation">(</span><span class="token string">"insert into salary (`time`, pid, username, \n"</span> <span class="token operator">+</span>
         <span class="token string">"      basicSalary, dname, workovertime, \n"</span> <span class="token operator">+</span>
         <span class="token string">"      checkaccount)\n"</span> <span class="token operator">+</span>
         <span class="token string">"    values (#&#123;time,jdbcType=VARCHAR&#125;, #&#123;pid,jdbcType=INTEGER&#125;, #&#123;username,jdbcType=VARCHAR&#125;, \n"</span> <span class="token operator">+</span>
         <span class="token string">"      #&#123;basicsalary,jdbcType=INTEGER&#125;, #&#123;dname,jdbcType=VARCHAR&#125;, #&#123;workovertime,jdbcType=INTEGER&#125;, \n"</span> <span class="token operator">+</span>
         <span class="token string">"      #&#123;checkaccount,jdbcType=INTEGER&#125;)"</span><span class="token punctuation">)</span>
 <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Salary</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="考勤管理-2"><a href="#考勤管理-2" class="headerlink" title="考勤管理"></a>考勤管理</h2><h3 id="Controller层-2"><a href="#Controller层-2" class="headerlink" title="Controller层"></a>Controller层</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/index/employee_table2"</span><span class="token punctuation">)</span>  
<span class="token keyword">public</span>  <span class="token class-name">String</span> <span class="token class-name">KaoqinList</span><span class="token punctuation">(</span><span class="token class-name">Model</span> model<span class="token punctuation">,</span>  
<span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>required <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span>defaultValue<span class="token operator">=</span><span class="token string">"1"</span><span class="token punctuation">,</span>value<span class="token operator">=</span><span class="token string">"pageNum"</span><span class="token punctuation">)</span><span class="token class-name">Integer</span> pageNum<span class="token punctuation">,</span>  
<span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>defaultValue<span class="token operator">=</span><span class="token string">"10"</span><span class="token punctuation">,</span>value<span class="token operator">=</span><span class="token string">"pageSize"</span><span class="token punctuation">)</span><span class="token class-name">Integer</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  
        <span class="token comment">//为了程序的严谨性，判断非空：  </span>
        <span class="token comment">//设置默认当前页  </span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>pageNum<span class="token operator">==</span><span class="token keyword">null</span> <span class="token operator">||</span> pageNum<span class="token operator">&lt;=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  
        pageNum <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
        <span class="token comment">//设置默认每页显示的数据数  </span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>pageSize <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  
        pageSize <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
        <span class="token comment">// System.out.println("当前页是："+pageNum+"显示条数是："+pageSize);  </span>
  
        <span class="token comment">//1.引入分页插件,pageNum是第几页，pageSize是每页显示多少条,默认查询总数count  </span>
        <span class="token class-name">PageHelper</span><span class="token punctuation">.</span><span class="token function">startPage</span><span class="token punctuation">(</span>pageNum<span class="token punctuation">,</span>pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//2.紧跟的查询就是一个分页查询-必须紧跟.后面的其他查询不会被分页，除非再次调用PageHelper.startPage  </span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Kaoqin</span><span class="token punctuation">></span></span> kaoqins <span class="token operator">=</span> kaoqinServiceImpl<span class="token punctuation">.</span><span class="token function">kaoqinList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//3.使用PageInfo包装查询后的结果,5是连续显示的条数,结果list类型是Page&lt;E>  </span>
        <span class="token class-name">PageInfo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Kaoqin</span><span class="token punctuation">></span></span> pageInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PageInfo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Kaoqin</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>kaoqins<span class="token punctuation">,</span>pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//4.使用model传参数回前端  </span>
        model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"pageInfo"</span><span class="token punctuation">,</span>pageInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"kaoqins"</span><span class="token punctuation">,</span>kaoqins<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token string">"kaoqin_table"</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
<span class="token comment">//根据考勤类型查找  </span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/find"</span><span class="token punctuation">)</span>  
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> type<span class="token punctuation">,</span> <span class="token class-name">Model</span> model<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Kaoqin</span><span class="token punctuation">></span></span> kaoqins <span class="token operator">=</span>  kaoqinServiceImpl<span class="token punctuation">.</span><span class="token function">findKaoqin</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"kaoqins"</span><span class="token punctuation">,</span>kaoqins<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token string">"kaoqin_table"</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
<span class="token comment">//根据id更新考勤内容  </span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/update/&#123;id&#125;"</span><span class="token punctuation">)</span>  
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">Model</span> model<span class="token punctuation">,</span> <span class="token annotation punctuation">@PathVariable</span> <span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  
        <span class="token class-name">Kaoqin</span> kaoqin <span class="token operator">=</span> kaoqinServiceImpl<span class="token punctuation">.</span><span class="token function">findKaoqinById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"kaoqin"</span><span class="token punctuation">,</span>kaoqin<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token string">"updateKaoqin"</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
<span class="token comment">//更新考勤  </span>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/update"</span><span class="token punctuation">)</span>  
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">updateKaoqin</span><span class="token punctuation">(</span><span class="token class-name">Kaoqin</span> kaoqin<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  
        kaoqinServiceImpl<span class="token punctuation">.</span><span class="token function">updateKaoqin</span><span class="token punctuation">(</span>kaoqin<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token string">"redirect:/index/employee_table2"</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Service层-2"><a href="#Service层-2" class="headerlink" title="Service层"></a>Service层</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Autowired</span>  
<span class="token class-name">KaoqinMapper</span> kaoqinMapper<span class="token punctuation">;</span>  
<span class="token annotation punctuation">@Override</span>  
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Kaoqin</span><span class="token punctuation">></span></span> <span class="token function">kaoqinList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  
    <span class="token keyword">return</span> kaoqinMapper<span class="token punctuation">.</span><span class="token function">kaoqinList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">&#125;</span>  
<span class="token annotation punctuation">@Override</span>  
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Kaoqin</span><span class="token punctuation">></span></span> <span class="token function">findKaoqin</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> type<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  
    <span class="token keyword">return</span> kaoqinMapper<span class="token punctuation">.</span><span class="token function">findKaoqin</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">&#125;</span>  
<span class="token annotation punctuation">@Override</span>  
<span class="token keyword">public</span> <span class="token class-name">Kaoqin</span> <span class="token function">findKaoqinById</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  
    <span class="token keyword">return</span> kaoqinMapper<span class="token punctuation">.</span><span class="token function">findKaoqinById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">&#125;</span>  
<span class="token annotation punctuation">@Override</span>  
<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">updateKaoqin</span><span class="token punctuation">(</span><span class="token class-name">Kaoqin</span> kaoqin<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  
    <span class="token keyword">return</span> kaoqinMapper<span class="token punctuation">.</span><span class="token function">updateKaoqin</span><span class="token punctuation">(</span>kaoqin<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">&#125;</span>  
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Kaoqin</span><span class="token punctuation">></span></span> <span class="token function">kaoqinList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Kaoqin</span><span class="token punctuation">></span></span> <span class="token function">findKaoqin</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token class-name">Kaoqin</span> <span class="token function">findKaoqinById</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>   
<span class="token keyword">int</span> <span class="token function">updateKaoqin</span><span class="token punctuation">(</span><span class="token class-name">Kaoqin</span> kaoqin<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Mapper层-2"><a href="#Mapper层-2" class="headerlink" title="Mapper层"></a>Mapper层</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select * from kaoqin"</span><span class="token punctuation">)</span>  
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Kaoqin</span><span class="token punctuation">></span></span> <span class="token function">kaoqinList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select * from kaoqin where type = #&#123;type&#125;"</span><span class="token punctuation">)</span>  
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Kaoqin</span><span class="token punctuation">></span></span> <span class="token function">findKaoqin</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select * from kaoqin where id = #&#123;id&#125;"</span><span class="token punctuation">)</span>  
<span class="token class-name">Kaoqin</span> <span class="token function">findKaoqinById</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token annotation punctuation">@Update</span><span class="token punctuation">(</span><span class="token string">"update kaoqin set type = #&#123;type&#125;, start = #&#123;start&#125;, end = #&#123;end&#125;, remark = #&#123;remark&#125; where id = #&#123;id&#125;"</span><span class="token punctuation">)</span>  
<span class="token keyword">int</span> <span class="token function">updateKaoqin</span><span class="token punctuation">(</span><span class="token class-name">Kaoqin</span> kaoqin<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="人事处理-2"><a href="#人事处理-2" class="headerlink" title="人事处理"></a>人事处理</h2><h3 id="Controller层-3"><a href="#Controller层-3" class="headerlink" title="Controller层"></a>Controller层</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">employeeListPage</span><span class="token punctuation">(</span><span class="token class-name">Model</span> model<span class="token punctuation">,</span> <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>defaultValue <span class="token operator">=</span> <span class="token string">"1"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> pageNum<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">PageHelper</span><span class="token punctuation">.</span><span class="token function">startPage</span><span class="token punctuation">(</span>pageNum<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employees</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> employServiceImpl<span class="token punctuation">.</span><span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PageInfo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employees</span><span class="token punctuation">></span></span> pageInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PageInfo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employees</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
        model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"pageInfo"</span><span class="token punctuation">,</span> pageInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
        model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"employee"</span><span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"employee_table"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/index/addEmployee"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">addStus</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span><span class="token keyword">int</span> age<span class="token punctuation">,</span><span class="token class-name">String</span> sex<span class="token punctuation">,</span>
                          <span class="token class-name">String</span> dname<span class="token punctuation">,</span><span class="token class-name">String</span> pname<span class="token punctuation">,</span><span class="token class-name">String</span> gname<span class="token punctuation">,</span><span class="token keyword">boolean</span> flag<span class="token punctuation">,</span><span class="token keyword">int</span> id<span class="token punctuation">,</span><span class="token class-name">String</span> email<span class="token punctuation">,</span><span class="token class-name">String</span> phone<span class="token punctuation">,</span>
                          <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>defaultValue <span class="token operator">=</span> <span class="token string">"1"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> pageNum<span class="token punctuation">,</span>
                          <span class="token class-name">Model</span> model<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Employees</span> employees <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employees</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>age<span class="token punctuation">,</span>sex<span class="token punctuation">,</span>dname<span class="token punctuation">,</span>pname<span class="token punctuation">,</span>gname<span class="token punctuation">,</span>email<span class="token punctuation">,</span>phone<span class="token punctuation">,</span>id<span class="token punctuation">,</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            employServiceImpl<span class="token punctuation">.</span><span class="token function">addEmployees</span><span class="token punctuation">(</span>employees<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token string">"addStu"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> <span class="token string">"index"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/index/delEmployee"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">delEmployee</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span><span class="token keyword">int</span> age<span class="token punctuation">,</span><span class="token class-name">String</span> sex<span class="token punctuation">,</span>
                             <span class="token class-name">String</span> dname<span class="token punctuation">,</span><span class="token class-name">String</span> pname<span class="token punctuation">,</span><span class="token class-name">String</span> gname<span class="token punctuation">,</span><span class="token keyword">boolean</span> flag<span class="token punctuation">,</span><span class="token keyword">int</span> id<span class="token punctuation">,</span><span class="token class-name">String</span> email<span class="token punctuation">,</span><span class="token class-name">String</span> phone<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token class-name">Employees</span> employees <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employees</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>age<span class="token punctuation">,</span>sex<span class="token punctuation">,</span>dname<span class="token punctuation">,</span>pname<span class="token punctuation">,</span>gname<span class="token punctuation">,</span>email<span class="token punctuation">,</span>phone<span class="token punctuation">,</span>id<span class="token punctuation">,</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span>
        employServiceImpl<span class="token punctuation">.</span><span class="token function">delEmployees</span><span class="token punctuation">(</span>employees<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"delSuccess"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Sevice层"><a href="#Sevice层" class="headerlink" title="Sevice层"></a>Sevice层</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">EmployeesMapper</span> employeesMapper<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addEmployees</span><span class="token punctuation">(</span><span class="token class-name">Employees</span> employees<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
         employeesMapper<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>employees<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">delEmployees</span><span class="token punctuation">(</span><span class="token class-name">Employees</span> employees<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        employeesMapper<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>employees<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employees</span><span class="token punctuation">></span></span> <span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> employeesMapper<span class="token punctuation">.</span><span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Mapper层-3"><a href="#Mapper层-3" class="headerlink" title="Mapper层"></a>Mapper层</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select * from employees"</span><span class="token punctuation">)</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employees</span><span class="token punctuation">></span></span> <span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token annotation punctuation">@Delete</span><span class="token punctuation">(</span><span class="token string">"DELETE from employees where name = #&#123;name&#125; and age = #&#123;age&#125; and sex = #&#123;sex&#125; and id = #&#123;id&#125; "</span><span class="token punctuation">)</span>
<span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">Employees</span> employee<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token annotation punctuation">@Insert</span><span class="token punctuation">(</span><span class="token string">"INSERT INTO employees VALUES(#&#123;id&#125;,#&#123;name&#125;,#&#123;age&#125;,#&#123;sex&#125;,#&#123;phone&#125;,#&#123;email&#125;,#&#123;dname&#125;,#&#123;pname&#125;,#&#123;gname&#125;,#&#123;flag&#125;)"</span><span class="token punctuation">)</span>
<span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token class-name">Employees</span> employee<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="用户权限分组"><a href="#用户权限分组" class="headerlink" title="用户权限分组"></a>用户权限分组</h2><h3 id="shiroConfiguration"><a href="#shiroConfiguration" class="headerlink" title="shiroConfiguration"></a>shiroConfiguration</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ShiroConfiguration</span> <span class="token punctuation">&#123;</span>  
    <span class="token comment">/** 
     * LifecycleBeanPostProcessor，这是个DestructionAwareBeanPostProcessor的子类， 
     * 负责org.apache.shiro.util.Initializable类型bean的生命周期的，初始化和销毁。 
     * 主要是AuthorizingRealm类的子类，以及EhCacheManager类。 
     */</span>  
    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"lifecycleBeanPostProcessor"</span><span class="token punctuation">)</span>  
    <span class="token keyword">public</span> <span class="token class-name">LifecycleBeanPostProcessor</span> <span class="token function">lifecycleBeanPostProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">LifecycleBeanPostProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
  
    <span class="token comment">/** 
     * HashedCredentialsMatcher，这个类是为了对密码进行编码的， 
     * 防止密码在数据库里明码保存，当然在登陆认证的时候， 
     * 这个类也负责对form里输入的密码进行编码。 
     */</span>  
    <span class="token annotation punctuation">@Bean</span>  
    <span class="token keyword">public</span> <span class="token class-name">HashedCredentialsMatcher</span> <span class="token function">hashedCredentialsMatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token class-name">HashedCredentialsMatcher</span> hashedCredentialsMatcher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashedCredentialsMatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        hashedCredentialsMatcher<span class="token punctuation">.</span><span class="token function">setHashAlgorithmName</span><span class="token punctuation">(</span><span class="token string">"md5"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> hashedCredentialsMatcher<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token comment">/** 
     * ShiroRealm，这是个自定义的认证类，继承自AuthorizingRealm， 
    * 负责用户的认证和权限的处理，可以参考JdbcRealm的实现。 
     */</span>  
    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"shiroRealm"</span><span class="token punctuation">)</span>  
    <span class="token annotation punctuation">@DependsOn</span><span class="token punctuation">(</span><span class="token string">"lifecycleBeanPostProcessor"</span><span class="token punctuation">)</span>  
    <span class="token keyword">public</span> <span class="token class-name">ShiroRealm</span> <span class="token function">shiroRealm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token class-name">ShiroRealm</span> realm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ShiroRealm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        realm<span class="token punctuation">.</span><span class="token function">setCredentialsMatcher</span><span class="token punctuation">(</span><span class="token function">hashedCredentialsMatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> realm<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token comment">/** 
     * SecurityManager，权限管理，这个类组合了登陆，登出，权限，session的处理，是个比较重要的类。 
     * // 
     */</span>  
    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"securityManager"</span><span class="token punctuation">)</span>  
    <span class="token keyword">public</span> <span class="token class-name">DefaultWebSecurityManager</span> <span class="token function">securityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token class-name">DefaultWebSecurityManager</span> securityManager <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultWebSecurityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        securityManager<span class="token punctuation">.</span><span class="token function">setRealm</span><span class="token punctuation">(</span><span class="token function">shiroRealm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> securityManager<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
  
    <span class="token comment">/** 
     * ShiroFilterFactoryBean，是个factorybean，为了生成ShiroFilter。 
     * 它主要保持了三项数据，securityManager，filters，filterChainDefinitionManager。 
     */</span>  
    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"shiroFilter"</span><span class="token punctuation">)</span>  
    <span class="token keyword">public</span> <span class="token class-name">ShiroFilterFactoryBean</span> <span class="token function">shiroFilterFactoryBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token class-name">ShiroFilterFactoryBean</span> shiroFilterFactoryBean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ShiroFilterFactoryBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        shiroFilterFactoryBean<span class="token punctuation">.</span><span class="token function">setSecurityManager</span><span class="token punctuation">(</span><span class="token function">securityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Filter</span><span class="token punctuation">></span></span> filters <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Filter</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">LogoutFilter</span> logoutFilter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LogoutFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        logoutFilter<span class="token punctuation">.</span><span class="token function">setRedirectUrl</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        shiroFilterFactoryBean<span class="token punctuation">.</span><span class="token function">setFilters</span><span class="token punctuation">(</span>filters<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> filterChainDefinitionManager <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//登录  </span>
        <span class="token comment">// 添加shiro的内置过滤器  </span>
        <span class="token comment">/** 
         * anon：无需认证就可以访问 
         * authc：必须认证了才能访问 
         * user：必须拥有记住我功能才能用 
         * perms：拥有对某个资源的权限才能访问 
         * role：拥有某个角色的权限才能访问 
         */</span>  
        filterChainDefinitionManager<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">,</span><span class="token string">"anon"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        filterChainDefinitionManager<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"/logout"</span><span class="token punctuation">,</span> <span class="token string">"anon"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        filterChainDefinitionManager<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"/index"</span><span class="token punctuation">,</span><span class="token string">"anon"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        filterChainDefinitionManager<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"/index/**"</span><span class="token punctuation">,</span> <span class="token string">"authc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        shiroFilterFactoryBean<span class="token punctuation">.</span><span class="token function">setFilterChainDefinitionMap</span><span class="token punctuation">(</span>filterChainDefinitionManager<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
        shiroFilterFactoryBean<span class="token punctuation">.</span><span class="token function">setLoginUrl</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        shiroFilterFactoryBean<span class="token punctuation">.</span><span class="token function">setSuccessUrl</span><span class="token punctuation">(</span><span class="token string">"/index"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        shiroFilterFactoryBean<span class="token punctuation">.</span><span class="token function">setUnauthorizedUrl</span><span class="token punctuation">(</span><span class="token string">"/403"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> shiroFilterFactoryBean<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
  
    <span class="token comment">/**  
     * DefaultAdvisorAutoProxyCreator，Spring的一个bean，由Advisor决定对哪些类的方法进行AOP代理。  
     */</span>  
    <span class="token annotation punctuation">@Bean</span>  
    <span class="token annotation punctuation">@ConditionalOnMissingBean</span>  
    <span class="token keyword">public</span> <span class="token class-name">DefaultAdvisorAutoProxyCreator</span> <span class="token function">defaultAdvisorAutoProxyCreator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token class-name">DefaultAdvisorAutoProxyCreator</span> defaultAAP <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultAdvisorAutoProxyCreator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        defaultAAP<span class="token punctuation">.</span><span class="token function">setProxyTargetClass</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> defaultAAP<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token comment">/** 
     * AuthorizationAttributeSourceAdvisor，shiro里实现的Advisor类， 
     * 内部使用AopAllianceAnnotationsAuthorizingMethodInterceptor来拦截用以下注解的方法。 
     */</span>  
    <span class="token annotation punctuation">@Bean</span>  
    <span class="token keyword">public</span> <span class="token class-name">AuthorizationAttributeSourceAdvisor</span> <span class="token function">authorizationAttributeSourceAdvisor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token class-name">AuthorizationAttributeSourceAdvisor</span> aASA <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AuthorizationAttributeSourceAdvisor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        aASA<span class="token punctuation">.</span><span class="token function">setSecurityManager</span><span class="token punctuation">(</span><span class="token function">securityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> aASA<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token comment">/** 
     * 配置 shiroDialect 用于thymeleaf和 
     * @return 
     */</span>  
    <span class="token annotation punctuation">@Bean</span>  
    <span class="token keyword">public</span> <span class="token class-name">ShiroDialect</span> <span class="token function">getShiroDialect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ShiroDialect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
<span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="shiroRealm"><a href="#shiroRealm" class="headerlink" title="shiroRealm"></a>shiroRealm</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ShiroRealm</span> <span class="token keyword">extends</span> <span class="token class-name">AuthorizingRealm</span> <span class="token punctuation">&#123;</span>  
    <span class="token annotation punctuation">@Autowired</span>  
    userCheckServiceImpl userCheckService<span class="token punctuation">;</span>  
  
  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">protected</span> <span class="token class-name">AuthorizationInfo</span> <span class="token function">doGetAuthorizationInfo</span><span class="token punctuation">(</span><span class="token class-name">PrincipalCollection</span> principalCollection<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"执行授权：Authorization"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
  
        <span class="token class-name">SimpleAuthorizationInfo</span> info <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleAuthorizationInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
  
        <span class="token class-name">Subject</span> subject <span class="token operator">=</span> <span class="token class-name">SecurityUtils</span><span class="token punctuation">.</span><span class="token function">getSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">Userall</span> userall <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Userall</span><span class="token punctuation">)</span>subject<span class="token punctuation">.</span><span class="token function">getPrincipal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">String</span> role <span class="token operator">=</span> userCheckService<span class="token punctuation">.</span><span class="token function">getUserPer</span><span class="token punctuation">(</span>userall<span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>role<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        info<span class="token punctuation">.</span><span class="token function">addStringPermission</span><span class="token punctuation">(</span>role<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
        <span class="token keyword">return</span> info<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
  
    <span class="token comment">/** 
     * 执行认证逻辑 
     * 
     * @param authenticationToken 
     * @return 
     * @throws AuthenticationException 
     */</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">protected</span> <span class="token class-name">AuthenticationInfo</span> <span class="token function">doGetAuthenticationInfo</span><span class="token punctuation">(</span><span class="token class-name">AuthenticationToken</span> authenticationToken<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">AuthenticationException</span> <span class="token punctuation">&#123;</span>  
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"执行认证：Authentiction"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
        <span class="token comment">//假设数据库的用户名和密码  </span>
        <span class="token class-name">UsernamePasswordToken</span> token <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">UsernamePasswordToken</span><span class="token punctuation">)</span> authenticationToken<span class="token punctuation">;</span>  
  
        <span class="token class-name">Userall</span> user <span class="token operator">=</span> userCheckService<span class="token punctuation">.</span><span class="token function">selectByKeyName</span><span class="token punctuation">(</span>token<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
       <span class="token class-name">String</span> <span class="token class-name">DBPassword</span> <span class="token operator">=</span> user<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">String</span> <span class="token class-name">Salt</span> <span class="token operator">=</span> user<span class="token punctuation">.</span><span class="token function">getSalt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Salt</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SimpleAuthenticationInfo</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span><span class="token class-name">DBPassword</span><span class="token punctuation">,</span> <span class="token class-name">ByteSource<span class="token punctuation">.</span>Util</span><span class="token punctuation">.</span><span class="token function">bytes</span><span class="token punctuation">(</span><span class="token class-name">Salt</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
<span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="thymeleaf-shiro"><a href="#thymeleaf-shiro" class="headerlink" title="thymeleaf+shiro"></a>thymeleaf+shiro</h3><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menu-list nav-active<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">shiro:</span>hasAnyPermissions</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>boss,deputy,fudeputy,staff<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span>  <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fa fa-th-list<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>人事归档<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>  
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sub-menu-list<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>active<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/index/employee_table<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>人事归档<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>  
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>active<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">shiro:</span>hasAnyPermissions</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>boss,deputy,fudeputy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span>  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/index/addStu<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>员工入职<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>  
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>active<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">shiro:</span>hasAnyPermissions</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>boss,deputy,fudeputy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span>  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/index/delStu<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>员工离职<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="项目部署"><a href="#项目部署" class="headerlink" title="项目部署"></a>项目部署</h1><p><a target="_blank" rel="noopener" href="http://182.92.153.231:1212/">部署网址</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://keeganli.github.com/2022/01/21/STM32RCC%E4%BD%8D%E5%9F%9F%E5%88%9D%E5%A7%8B%E5%8C%96%E6%97%B6%E9%92%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GaoMing">
      <meta itemprop="description" content="终身浪漫">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GaoMing's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/01/21/STM32RCC%E4%BD%8D%E5%9F%9F%E5%88%9D%E5%A7%8B%E5%8C%96%E6%97%B6%E9%92%9F/" class="post-title-link" itemprop="url">STM32RCC位域初始化时钟</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-01-20 16:53:15 / 修改时间：09:55:46" itemprop="dateCreated datePublished" datetime="2022-01-20T16:53:15Z">2022-01-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">嵌入式开发</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/STM32/" itemprop="url" rel="index"><span itemprop="name">STM32</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><ol>
<li>使用位域初始化RCC寄存器。</li>
<li>学习使用<code>CobeMX</code>生成代码。</li>
<li>使用<a target="_blank" rel="noopener" href="https://gitee.com/lkksxxdxxd/stm32/tree/master/doc">RM0008.pdf创</a>建自己的RCC寄存器。</li>
<li>初始化STM32时钟代替<code>CobeMX</code>生成的函数并运行查看RCC是否被正常初始化。</li>
</ol>
<h1 id="项目地址"><a href="#项目地址" class="headerlink" title="项目地址"></a>项目地址</h1><p><a target="_blank" rel="noopener" href="https://gitee.com/lkksxxdxxd/stm32">地址</a></p>
<h1 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h1><h2 id="生成代码"><a href="#生成代码" class="headerlink" title="生成代码"></a>生成代码</h2><ul>
<li>使用<code>CobeMX</code>初始化代码</li>
</ul>
<h2 id="uVision编写"><a href="#uVision编写" class="headerlink" title="uVision编写"></a><code>uVision</code>编写</h2><ol>
<li><p>创建自己的<code>RCC.h</code></p>
<ul>
<li><p>参考文献可以看到<code>RCC</code>所有的寄存器，按照文献相应创建结构体，并设置位域。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">__LkkRccInit_H_</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">__LkkRccInit_H_</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"stm32f1xx_hal.h"</span></span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">uint32_t</span> HSION <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> HSIRDY <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES0 <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> HSITRIM <span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> HSICAL <span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> HSEON <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> HSERDY <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> HSEBYP <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> CSSON <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES1 <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> PLLON <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> PLLRDY <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES2 <span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>Rcc_CR<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">uint32_t</span> SW <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> SWS <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> HPRE <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> PPRE1 <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> PPRE2 <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> ADCPRE <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> PLLSRC <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> PLLXTPRE <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> PLLMUL <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> USBPRE <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES0 <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> MCO <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES1 <span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>Rcc_CFGR<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">uint32_t</span> LSIRDYF <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> LSERDYF <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> HSIRDYF <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> HSERDYF <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> PLLRDYF <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES0 <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> CSSF <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> LSIRDYIE <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> LSERDYIE <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> HSIRDYIE <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> HSERDYIE <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> PLLRDYIE <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES1 <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> LSIRDYC <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> LSERDYC <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> HSIRDYC <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> HSERDYC <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> PLLRDYC <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES2 <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> CSSC <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES3 <span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>Rcc_CIR<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">uint32_t</span> AFIORST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES0 <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> IOPARST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> IOPBRST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> IOPCRST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> IOPDRST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> IOPERST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> IOPFRST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> IOPGRST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> ADC1RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> ADC2RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TIM1RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> SPI1RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TIM8RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> USART1RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> ADC3RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES1 <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TIM9RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TIM10RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TIM11RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES2 <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>Rcc_APB2RSTR<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">uint32_t</span> TIM2RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TIM3RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TIM4RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TM5RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TM6RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TM7RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TIM12RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TIM13RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TIM14RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES0 <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> WWDGRST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES1 <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> SPI2RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> SPI3RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES2 <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> USART2RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> USART3RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> UART4RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> UART5RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> I2C1RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> I2C2RST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> USBRST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES3 <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> CANRST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES4 <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> BKPRST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> PWRRST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> DACRST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES5 <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>Rcc_APB1RSTR<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">uint32_t</span> DMA1EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> DMA2EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> SRAMEN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES0 <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> FLITFEN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES1 <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> CRCEN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES2 <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> FSMCEN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES3 <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> SDIOEN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES4 <span class="token operator">:</span> <span class="token number">21</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>Rcc_AHBENR<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">uint32_t</span> AFIOEN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES0 <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> IOPAEN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> IOPBEN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> IOPCEN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> IOPDEN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> IOPEEN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> IOPFEN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> IOPGEN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> ADC1EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> ADC2EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TIM1EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> SPI1EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TIM8EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> USART1EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> ADC3EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES1 <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TIM9EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TIM10EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TIM11EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES2 <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>Rcc_APB2ENR<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">uint32_t</span> TIM2EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TIM3EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TIM4EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TIM5EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TIM6EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TIM7EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TIM12EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TIM13EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> TIM14EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES0 <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> WWDGEN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES1 <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> SPI2EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> SPI3EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES2 <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> USART2EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> USART3EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> UART4EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> UART5EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> I2C1EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> I2C2EN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> USBEN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES3 <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> CANEN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES4 <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> BKPEN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> PWREN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> DACEN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES5 <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>Rcc_APB1ENR<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">uint32_t</span> LSEON <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> LSERDY <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> LSEBYP <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES0 <span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RTCSEL <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES1 <span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RTCEN <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> BDRST <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES2 <span class="token operator">:</span> <span class="token number">15</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>Rcc_BDCR<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span><span class="token punctuation">&#123;</span>
	<span class="token class-name">uint32_t</span> LSION<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token class-name">uint32_t</span> LSIRDY<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token class-name">uint32_t</span> RES0<span class="token operator">:</span><span class="token number">22</span><span class="token punctuation">;</span>
	<span class="token class-name">uint32_t</span> RMVF<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token class-name">uint32_t</span> RES1<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token class-name">uint32_t</span> PINRSTF<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token class-name">uint32_t</span> PORRSTF<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token class-name">uint32_t</span> SFTRSTF<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token class-name">uint32_t</span> IWDGRSTF<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token class-name">uint32_t</span> WWDGRSTF<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token class-name">uint32_t</span> LPWRRSTF<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>Rcc_CSR<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>
    Rcc_CR rcc_CR<span class="token punctuation">;</span>
    Rcc_CFGR rcc_CFGR<span class="token punctuation">;</span>
    Rcc_CIR rcc_CIR<span class="token punctuation">;</span>
    Rcc_APB2RSTR rcc_APB2RSTR<span class="token punctuation">;</span>
    Rcc_APB1RSTR rcc_APB1RSTR<span class="token punctuation">;</span>
    Rcc_AHBENR rcc_AHBENR<span class="token punctuation">;</span>
    Rcc_APB2ENR rcc_APB2ENR<span class="token punctuation">;</span>
    Rcc_APB1ENR rcc_APB1ENR<span class="token punctuation">;</span>
    Rcc_BDCR rcc_BDCR<span class="token punctuation">;</span>
	Rcc_CSR rcc_CSR<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>Lkk_Rcc<span class="token punctuation">;</span>


<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">uint32_t</span> LPDS <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> PDDS <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> CWUF <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> CSBF <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> PVDE <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> PLS <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> DBP <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES0 <span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>Pwr_CR<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">uint32_t</span> WUF <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> SBF <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> PVDO <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES0 <span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> EWUP <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES1 <span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>Pwr_CSR<span class="token punctuation">;</span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>
    Pwr_CR pwr_CR<span class="token punctuation">;</span>
    Pwr_CSR pwr_CSR<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>Lkk_Pwr<span class="token punctuation">;</span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">uint32_t</span> LATENCY <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> HLFCYA <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> PRFTBE <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> PRFTBS <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> RES0 <span class="token operator">:</span> <span class="token number">26</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>Lkk_FLASH_ACR<span class="token punctuation">;</span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>
    Lkk_FLASH_ACR lkk_flash_ACR<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>Lkk_FLASH<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">/* __My_RCC_H_ */</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
</li>
<li><p>编写<code>RCC.c</code>初始化<code>RCC</code></p>
<ul>
<li> 为<code>RCC</code>分配地址</li>
</ul>
  <pre class="line-numbers language-c" data-language="c"><code class="language-c">Lkk_Rcc <span class="token operator">*</span>lkk_Rcc <span class="token operator">=</span> <span class="token punctuation">(</span>Lkk_Rcc <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token number">0x40021000UL</span><span class="token punctuation">;</span> 
Lkk_FLASH <span class="token operator">*</span>lkk_FlASH <span class="token operator">=</span> <span class="token punctuation">(</span>Lkk_FLASH <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token number">0x40022000UL</span><span class="token punctuation">;</span>
Lkk_Pwr <span class="token operator">*</span>lkk_PWR <span class="token operator">=</span> <span class="token punctuation">(</span>Lkk_Pwr<span class="token operator">*</span><span class="token punctuation">)</span><span class="token number">0x40007000UL</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>  这里也初始化了<code>FLASH</code>和<code>PWR</code>，因为通过调试发现<code>RCC</code>初始化时也会涉及到他俩。</p>
<p>  地址可以参考我上传的RM0008.pdf的第50页(<code>Memory Map</code>)。</p>
<ul>
<li> 开启时钟,我选择的是<code>HSI</code>，与<code>CobeMX</code>的时钟树相对应</li>
</ul>
  <pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/**
	Rcc_CR init
**/</span>
lkk_Rcc<span class="token operator">-></span>rcc_CR<span class="token punctuation">.</span>HSION <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span> <span class="token comment">//open HSI</span>
lkk_Rcc<span class="token operator">-></span>rcc_CR<span class="token punctuation">.</span>HSIRDY <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span><span class="token comment">//ready HSI</span>
lkk_Rcc<span class="token operator">-></span>rcc_CR<span class="token punctuation">.</span>HSITRIM <span class="token operator">=</span> <span class="token number">0x10</span><span class="token punctuation">;</span><span class="token comment">//HSI adjustment</span>
lkk_Rcc<span class="token operator">-></span>rcc_CR<span class="token punctuation">.</span>HSICAL <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span><span class="token comment">//HSI correcting</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>关闭<code>HSE</code></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">//close HSE</span>
lkk_Rcc<span class="token operator">-></span>rcc_CR<span class="token punctuation">.</span>HSEON <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span>
lkk_Rcc<span class="token operator">-></span>rcc_CR<span class="token punctuation">.</span>HSERDY <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span>
lkk_Rcc<span class="token operator">-></span>rcc_CR<span class="token punctuation">.</span>HSEBYP <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span>
lkk_Rcc<span class="token operator">-></span>rcc_CR<span class="token punctuation">.</span>CSSON <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>关闭<code>PLL</code>初始化<code>PLLMUL</code></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/**
	PLL frequency doubling coefficient
	The PLL frequency doubling coefficient is determined by software settings. 
	It can only be written when PLL is off
**/</span>
lkk_Rcc<span class="token operator">-></span>rcc_CR<span class="token punctuation">.</span>PLLON <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span> 
lkk_Rcc<span class="token operator">-></span>rcc_CFGR<span class="token punctuation">.</span>PLLMUL <span class="token operator">=</span> <span class="token number">0x0E</span><span class="token punctuation">;</span>
	<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>初始化<code>RCC_CFGR</code></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/**
	Rcc_CFGR init
**/</span>
lkk_Rcc<span class="token operator">-></span>rcc_CFGR<span class="token punctuation">.</span>SW <span class="token operator">=</span> <span class="token number">0x02</span><span class="token punctuation">;</span> <span class="token comment">//System clock switching</span>
lkk_Rcc<span class="token operator">-></span>rcc_CFGR<span class="token punctuation">.</span>SWS <span class="token operator">=</span> <span class="token number">0x02</span><span class="token punctuation">;</span>	
lkk_Rcc<span class="token operator">-></span>rcc_CFGR<span class="token punctuation">.</span>HPRE <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span>	<span class="token comment">//AHB Prescaler</span>
lkk_Rcc<span class="token operator">-></span>rcc_CFGR<span class="token punctuation">.</span>PPRE1 <span class="token operator">=</span> <span class="token number">0x04</span><span class="token punctuation">;</span>	<span class="token comment">//APB1 Prescaler</span>
lkk_Rcc<span class="token operator">-></span>rcc_CFGR<span class="token punctuation">.</span>PPRE2 <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span>	<span class="token comment">//APB2 Prescaler</span>
lkk_Rcc<span class="token operator">-></span>rcc_CFGR<span class="token punctuation">.</span>ADCPRE <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span>	<span class="token comment">//ADC Prescaler</span>
lkk_Rcc<span class="token operator">-></span>rcc_CFGR<span class="token punctuation">.</span>PLLSRC <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span>	<span class="token comment">//PLL input clock source</span>
lkk_Rcc<span class="token operator">-></span>rcc_CFGR<span class="token punctuation">.</span>MCO <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span>	<span class="token comment">//MCO microcontroller clock output : None</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>初始化<code>RCC_AHBENR</code></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">//Rcc_AHBENR init</span>
lkk_Rcc<span class="token operator">-></span>rcc_AHBENR<span class="token punctuation">.</span>SRAMEN <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span>	<span class="token comment">//SRAM clock enable</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
<li><p>初始化<code>FLASH</code></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/**
	FLASH
**/</span>

lkk_FlASH<span class="token operator">-></span>lkk_flash_ACR<span class="token punctuation">.</span>LATENCY <span class="token operator">=</span> <span class="token number">0x02</span><span class="token punctuation">;</span>
lkk_FlASH<span class="token operator">-></span>lkk_flash_ACR<span class="token punctuation">.</span>PRFTBE <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span>
lkk_Rcc<span class="token operator">-></span>rcc_AHBENR<span class="token punctuation">.</span>FLITFEN <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span>	<span class="token comment">//Flash memory interface circuit clock enable</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>初始化<code>RCC_APB2ENR</code></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">//Rcc_APB2ENR init</span>
lkk_Rcc<span class="token operator">-></span>rcc_APB2ENR<span class="token punctuation">.</span>AFIOEN <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span> <span class="token comment">//Auxiliary function IO clock enable</span>
lkk_Rcc<span class="token operator">-></span>rcc_APB2ENR<span class="token punctuation">.</span>IOPAEN <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span>	<span class="token comment">//IO port a clock enable</span>
lkk_Rcc<span class="token operator">-></span>rcc_APB2ENR<span class="token punctuation">.</span>IOPCEN <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span>	<span class="token comment">//IO port c clock enable</span>
lkk_Rcc<span class="token operator">-></span>rcc_APB2ENR<span class="token punctuation">.</span>IOPDEN <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span>	<span class="token comment">//IO port d clock enable</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>初始化<code>RCC_APB1ENR</code></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">lkk_Rcc<span class="token operator">-></span>rcc_APB1ENR<span class="token punctuation">.</span>PWREN <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>初始化<code>RCC_BDCR</code></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">//Rcc_BDCR init</span>
lkk_Rcc<span class="token operator">-></span>rcc_BDCR<span class="token punctuation">.</span>RTCSEL <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
<li><p>初始化<code>RCC_CSR</code></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">//Rcc_CSR init</span>
lkk_Rcc<span class="token operator">-></span>rcc_CSR<span class="token punctuation">.</span>PINRSTF <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span>
lkk_Rcc<span class="token operator">-></span>rcc_CSR<span class="token punctuation">.</span>PORRSTF <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span>
lkk_Rcc<span class="token operator">-></span>rcc_CR<span class="token punctuation">.</span>PLLON <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span>
<span class="token comment">//初始化了RLLMUL后再打开！！！</span>
<span class="token comment">//原理见RM0008.pdf的第102页</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>初始化<code>PWR</code></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">//PWR	</span>
lkk_PWR<span class="token operator">-></span>pwr_CR<span class="token punctuation">.</span>PLS <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
<li><p>完整初始化函数</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"LkkRccInit.h"</span></span>
<span class="token keyword">void</span> <span class="token function">Lkk_Clock_Config</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	Lkk_Rcc <span class="token operator">*</span>lkk_Rcc <span class="token operator">=</span> <span class="token punctuation">(</span>Lkk_Rcc <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token number">0x40021000UL</span><span class="token punctuation">;</span> 
	Lkk_FLASH <span class="token operator">*</span>lkk_FlASH <span class="token operator">=</span> <span class="token punctuation">(</span>Lkk_FLASH <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token number">0x40022000UL</span><span class="token punctuation">;</span>
	Lkk_Pwr <span class="token operator">*</span>lkk_PWR <span class="token operator">=</span> <span class="token punctuation">(</span>Lkk_Pwr<span class="token operator">*</span><span class="token punctuation">)</span><span class="token number">0x40007000UL</span><span class="token punctuation">;</span>
	<span class="token comment">/**
		Rcc_CR init
	**/</span>
    lkk_Rcc<span class="token operator">-></span>rcc_CR<span class="token punctuation">.</span>HSION <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span> <span class="token comment">//open HSI</span>
	lkk_Rcc<span class="token operator">-></span>rcc_CR<span class="token punctuation">.</span>HSIRDY <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span><span class="token comment">//ready HSI</span>
	
	lkk_Rcc<span class="token operator">-></span>rcc_CR<span class="token punctuation">.</span>HSITRIM <span class="token operator">=</span> <span class="token number">0x10</span><span class="token punctuation">;</span><span class="token comment">//HSI adjustment</span>
	lkk_Rcc<span class="token operator">-></span>rcc_CR<span class="token punctuation">.</span>HSICAL <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span><span class="token comment">//HSI correcting</span>
	
	<span class="token comment">//close HSE</span>
	lkk_Rcc<span class="token operator">-></span>rcc_CR<span class="token punctuation">.</span>HSEON <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span>
	lkk_Rcc<span class="token operator">-></span>rcc_CR<span class="token punctuation">.</span>HSERDY <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span>
	lkk_Rcc<span class="token operator">-></span>rcc_CR<span class="token punctuation">.</span>HSEBYP <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span>
	lkk_Rcc<span class="token operator">-></span>rcc_CR<span class="token punctuation">.</span>CSSON <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span>
	
	<span class="token comment">/**
		PLL frequency doubling coefficient
		The PLL frequency doubling coefficient is determined by software settings. 
		It can only be written when PLL is off
	**/</span>
	lkk_Rcc<span class="token operator">-></span>rcc_CR<span class="token punctuation">.</span>PLLON <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span> 
	lkk_Rcc<span class="token operator">-></span>rcc_CFGR<span class="token punctuation">.</span>PLLMUL <span class="token operator">=</span> <span class="token number">0x0E</span><span class="token punctuation">;</span>
	
	<span class="token comment">/**
		Rcc_CFGR init
	**/</span>
	
	lkk_Rcc<span class="token operator">-></span>rcc_CFGR<span class="token punctuation">.</span>SW <span class="token operator">=</span> <span class="token number">0x02</span><span class="token punctuation">;</span> <span class="token comment">//System clock switching</span>
	lkk_Rcc<span class="token operator">-></span>rcc_CFGR<span class="token punctuation">.</span>SWS <span class="token operator">=</span> <span class="token number">0x02</span><span class="token punctuation">;</span>
	
	lkk_Rcc<span class="token operator">-></span>rcc_CFGR<span class="token punctuation">.</span>HPRE <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span>	<span class="token comment">//AHB Prescaler</span>
	lkk_Rcc<span class="token operator">-></span>rcc_CFGR<span class="token punctuation">.</span>PPRE1 <span class="token operator">=</span> <span class="token number">0x04</span><span class="token punctuation">;</span>	<span class="token comment">//APB1 Prescaler</span>
	lkk_Rcc<span class="token operator">-></span>rcc_CFGR<span class="token punctuation">.</span>PPRE2 <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span>	<span class="token comment">//APB2 Prescaler</span>
	lkk_Rcc<span class="token operator">-></span>rcc_CFGR<span class="token punctuation">.</span>ADCPRE <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span>	<span class="token comment">//ADC Prescaler</span>
	lkk_Rcc<span class="token operator">-></span>rcc_CFGR<span class="token punctuation">.</span>PLLSRC <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span>	<span class="token comment">//PLL input clock source</span>
	
	lkk_Rcc<span class="token operator">-></span>rcc_CFGR<span class="token punctuation">.</span>MCO <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span>	<span class="token comment">//MCO microcontroller clock output : None</span>
	
	<span class="token comment">//Rcc_AHBENR init</span>
	lkk_Rcc<span class="token operator">-></span>rcc_AHBENR<span class="token punctuation">.</span>SRAMEN <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span>	<span class="token comment">//SRAM clock enable</span>
	
	<span class="token comment">/**
		FLASH
	**/</span>

	lkk_FlASH<span class="token operator">-></span>lkk_flash_ACR<span class="token punctuation">.</span>LATENCY <span class="token operator">=</span> <span class="token number">0x02</span><span class="token punctuation">;</span>
	lkk_FlASH<span class="token operator">-></span>lkk_flash_ACR<span class="token punctuation">.</span>PRFTBE <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span>
	
	lkk_Rcc<span class="token operator">-></span>rcc_AHBENR<span class="token punctuation">.</span>FLITFEN <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span>	<span class="token comment">//Flash memory interface circuit clock enable</span>
	
	<span class="token comment">//Rcc_APB2ENR init</span>
	lkk_Rcc<span class="token operator">-></span>rcc_APB2ENR<span class="token punctuation">.</span>AFIOEN <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span> <span class="token comment">//Auxiliary function IO clock enable</span>
	lkk_Rcc<span class="token operator">-></span>rcc_APB2ENR<span class="token punctuation">.</span>IOPAEN <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span>	<span class="token comment">//IO port a clock enable</span>
	lkk_Rcc<span class="token operator">-></span>rcc_APB2ENR<span class="token punctuation">.</span>IOPCEN <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span>	<span class="token comment">//IO port c clock enable</span>
	lkk_Rcc<span class="token operator">-></span>rcc_APB2ENR<span class="token punctuation">.</span>IOPDEN <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span>	<span class="token comment">//IO port d clock enable</span>
	
	<span class="token comment">//Rcc_APB1ENR init</span>
	lkk_Rcc<span class="token operator">-></span>rcc_APB1ENR<span class="token punctuation">.</span>PWREN <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span>
	
	<span class="token comment">//Rcc_BDCR init</span>
	lkk_Rcc<span class="token operator">-></span>rcc_BDCR<span class="token punctuation">.</span>RTCSEL <span class="token operator">=</span> <span class="token number">0x0</span><span class="token punctuation">;</span>
	
	<span class="token comment">//Rcc_CSR init</span>
	lkk_Rcc<span class="token operator">-></span>rcc_CSR<span class="token punctuation">.</span>PINRSTF <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span>
	lkk_Rcc<span class="token operator">-></span>rcc_CSR<span class="token punctuation">.</span>PORRSTF <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span>
	
	lkk_Rcc<span class="token operator">-></span>rcc_CR<span class="token punctuation">.</span>PLLON <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">;</span>

	<span class="token comment">//PWR</span>
	lkk_PWR<span class="token operator">-></span>pwr_CR<span class="token punctuation">.</span>PLS <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
</li>
<li><p><code>main.c</code>添加自定的RCC头文件，引入初始化函数代替</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/* USER CODE BEGIN Header */</span>
<span class="token comment">/**
  ******************************************************************************
  * @file           : main.c
  * @brief          : Main program body
  ******************************************************************************
  * @attention
  *
  * &lt;h2>&lt;center>&amp;copy; Copyright (c) 2021 STMicroelectronics.
  * All rights reserved.&lt;/center>&lt;/h2>
  *
  * This software component is licensed by ST under BSD 3-Clause license,
  * the "License"; You may not use this file except in compliance with the
  * License. You may obtain a copy of the License at:
  *                        opensource.org/licenses/BSD-3-Clause
  *
  ******************************************************************************
  */</span>
<span class="token comment">/* USER CODE END Header */</span>
<span class="token comment">/* Includes ------------------------------------------------------------------*/</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"main.h"</span></span>

<span class="token comment">/* Private includes ----------------------------------------------------------*/</span>
<span class="token comment">/* USER CODE BEGIN Includes */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"LkkRccInit.h"</span></span>
<span class="token comment">/* USER CODE END Includes */</span>

<span class="token comment">/* Private typedef -----------------------------------------------------------*/</span>
<span class="token comment">/* USER CODE BEGIN PTD */</span>

<span class="token comment">/* USER CODE END PTD */</span>

<span class="token comment">/* Private define ------------------------------------------------------------*/</span>
<span class="token comment">/* USER CODE BEGIN PD */</span>
<span class="token comment">/* USER CODE END PD */</span>

<span class="token comment">/* Private macro -------------------------------------------------------------*/</span>
<span class="token comment">/* USER CODE BEGIN PM */</span>

<span class="token comment">/* USER CODE END PM */</span>

<span class="token comment">/* Private variables ---------------------------------------------------------*/</span>

<span class="token comment">/* USER CODE BEGIN PV */</span>

<span class="token comment">/* USER CODE END PV */</span>

<span class="token comment">/* Private function prototypes -----------------------------------------------*/</span>
<span class="token keyword">void</span> <span class="token function">SystemClock_Config</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">MX_GPIO_Init</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/* USER CODE BEGIN PFP */</span>
<span class="token keyword">void</span> <span class="token function">Lkk_Clock_Config</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/* USER CODE END PFP */</span>

<span class="token comment">/* Private user code ---------------------------------------------------------*/</span>
<span class="token comment">/* USER CODE BEGIN 0 */</span>

<span class="token comment">/* USER CODE END 0 */</span>

<span class="token comment">/**
  * @brief  The application entry point.
  * @retval int
  */</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token comment">/* USER CODE BEGIN 1 */</span>

  <span class="token comment">/* USER CODE END 1 */</span>

  <span class="token comment">/* MCU Configuration--------------------------------------------------------*/</span>

  <span class="token comment">/* Reset of all peripherals, Initializes the Flash interface and the Systick. */</span>
  <span class="token function">HAL_Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">/* USER CODE BEGIN Init */</span>

  <span class="token comment">/* USER CODE END Init */</span>

  <span class="token comment">/* Configure the system clock */</span>
  <span class="token function">SystemClock_Config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">/* USER CODE BEGIN SysInit */</span>
  <span class="token function">Lkk_Clock_Config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">/* USER CODE END SysInit */</span>

  <span class="token comment">/* Initialize all configured peripherals */</span>
  <span class="token function">MX_GPIO_Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">/* USER CODE BEGIN 2 */</span>
  
  <span class="token comment">/* USER CODE END 2 */</span>

  <span class="token comment">/* Infinite loop */</span>
  <span class="token comment">/* USER CODE BEGIN WHILE */</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    <span class="token comment">/* USER CODE END WHILE */</span>

    <span class="token comment">/* USER CODE BEGIN 3 */</span>
  <span class="token punctuation">&#125;</span>
  <span class="token comment">/* USER CODE END 3 */</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<h1 id="软仿真查看"><a href="#软仿真查看" class="headerlink" title="软仿真查看"></a>软仿真查看</h1><ul>
<li>选择RCC,单步跟踪查看</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://keeganli.github.com/2022/01/12/Android%E9%A1%B9%E7%9B%AE%E2%80%94%E2%80%94%E5%B8%96%E8%AF%9DAPP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GaoMing">
      <meta itemprop="description" content="终身浪漫">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GaoMing's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/01/12/Android%E9%A1%B9%E7%9B%AE%E2%80%94%E2%80%94%E5%B8%96%E8%AF%9DAPP/" class="post-title-link" itemprop="url">Android项目——帖话APP</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-01-12 13:24:10" itemprop="dateCreated datePublished" datetime="2022-01-12T13:24:10Z">2022-01-12</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2022-01-18 04:14:03" itemprop="dateModified" datetime="2022-01-18T04:14:03Z">2022-01-18</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%A7%BB%E5%8A%A8%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">移动应用开发</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%A7%BB%E5%8A%A8%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/Android%E9%A1%B9%E7%9B%AE/" itemprop="url" rel="index"><span itemprop="name">Android项目</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%A7%BB%E5%8A%A8%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/Android%E9%A1%B9%E7%9B%AE/%E5%B8%96%E8%AF%9DAPP/" itemprop="url" rel="index"><span itemprop="name">帖话APP</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="项目介绍"><a href="#项目介绍" class="headerlink" title="项目介绍"></a>项目介绍</h1><ul>
<li>贴话APP实现的功能类似于百度贴吧，实现发帖，读帖，修改帖，删帖功能，</li>
<li>项目特色在于借助个人服务器的数据库实现网络服务，利用本地<code>LitaPal</code>实现用户数据缓存。</li>
<li>没有唯一用户的说法，使用人可以以任何用户名发帖，他人发帖可以看到。</li>
<li>实现了<code>NavigationView</code>侧边栏功能和<code>WebView</code>个人博客，上传图片的功能，支持用户登录，头像上传和帖子图片上传。</li>
<li>设计使用高德地图开发包实现地图功能。</li>
<li>使用<code>CardView</code>美化<code>RecylerView</code>，支持<code>ToolBar</code>和<code>Scrolling </code>美化页面动画。</li>
</ul>
<h1 id="项目搭建"><a href="#项目搭建" class="headerlink" title="项目搭建"></a>项目搭建</h1><h2 id="首页"><a href="#首页" class="headerlink" title="首页"></a>首页</h2><ul>
<li><p>首页采用<code>Android Stdio</code>模板（自带侧边栏），首页采用碎片，用<code>RecylerView</code>和<code>CardView</code>搭建，侧边栏采用<code>NavigationView</code>搭建。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainActivity</span> <span class="token keyword">extends</span> <span class="token class-name">AppCompatActivity</span>  
        <span class="token keyword">implements</span> <span class="token class-name">NavigationView<span class="token punctuation">.</span>OnNavigationItemSelectedListener</span> <span class="token punctuation">&#123;</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Connection</span> conn <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">PreparedStatement</span> stmt <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">SwipeRefreshLayout</span> swipeRefreshLayout<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">News</span><span class="token punctuation">></span></span> sNewsList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">News</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">setContentView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">Toolbar</span> toolbar <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Toolbar</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>toolbar<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        toolbar<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">"主页"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
         <span class="token function">setSupportActionBar</span><span class="token punctuation">(</span>toolbar<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">DrawerLayout</span> drawer <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">DrawerLayout</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>drawer_layout<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">ActionBarDrawerToggle</span> toggle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ActionBarDrawerToggle</span><span class="token punctuation">(</span>  
                <span class="token keyword">this</span><span class="token punctuation">,</span> drawer<span class="token punctuation">,</span> toolbar<span class="token punctuation">,</span> <span class="token class-name">R</span><span class="token punctuation">.</span>string<span class="token punctuation">.</span>navigation_drawer_open<span class="token punctuation">,</span> <span class="token class-name">R</span><span class="token punctuation">.</span>string<span class="token punctuation">.</span>navigation_drawer_close<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        drawer<span class="token punctuation">.</span><span class="token function">setDrawerListener</span><span class="token punctuation">(</span>toggle<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        toggle<span class="token punctuation">.</span><span class="token function">syncState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">NavigationView</span> navigationView <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">NavigationView</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>nav_view<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        navigationView<span class="token punctuation">.</span><span class="token function">setNavigationItemSelectedListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onBackPressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token class-name">DrawerLayout</span> drawer <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">DrawerLayout</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>drawer_layout<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>drawer<span class="token punctuation">.</span><span class="token function">isDrawerOpen</span><span class="token punctuation">(</span><span class="token class-name">GravityCompat</span><span class="token punctuation">.</span>START<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            drawer<span class="token punctuation">.</span><span class="token function">closeDrawer</span><span class="token punctuation">(</span><span class="token class-name">GravityCompat</span><span class="token punctuation">.</span>START<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  
            <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onBackPressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">onCreateOptionsMenu</span><span class="token punctuation">(</span><span class="token class-name">Menu</span> menu<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token comment">// Inflate the menu; this adds items to the action bar if it is present.  </span>
        <span class="token function">getMenuInflater</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">inflate</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>menu<span class="token punctuation">.</span>main<span class="token punctuation">,</span> menu<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">onOptionsItemSelected</span><span class="token punctuation">(</span><span class="token class-name">MenuItem</span> item<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">int</span> id <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">getItemId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>action_settings<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token class-name">Intent</span> intent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token class-name">PublishPost</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token function">startActivity</span><span class="token punctuation">(</span>intent<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            item<span class="token punctuation">.</span><span class="token function">setIntent</span><span class="token punctuation">(</span>intent<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
        <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onOptionsItemSelected</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">"StatementWithEmptyBody"</span><span class="token punctuation">)</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">onNavigationItemSelected</span><span class="token punctuation">(</span><span class="token class-name">MenuItem</span> item<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token comment">// Handle navigation view item clicks here.  </span>
        <span class="token keyword">int</span> id <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">getItemId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>nav_camera<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token class-name">Intent</span> intent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            intent<span class="token punctuation">.</span><span class="token function">setClass</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token class-name">PublishPost</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token function">startActivityForResult</span><span class="token punctuation">(</span>intent<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>nav_gallery<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token class-name">Intent</span> intent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            intent<span class="token punctuation">.</span><span class="token function">setClass</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token class-name">WebBlog</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token function">startActivity</span><span class="token punctuation">(</span>intent<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>nav_slideshow<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
  
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>nav_manage<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
  
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>nav_share<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
  
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>nav_send<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
  
        <span class="token punctuation">&#125;</span>  
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onActivityResult</span><span class="token punctuation">(</span><span class="token keyword">int</span> requestCode<span class="token punctuation">,</span> <span class="token keyword">int</span> resultCode<span class="token punctuation">,</span> <span class="token class-name">Intent</span> data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>requestCode<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>  
                <span class="token keyword">if</span> <span class="token punctuation">(</span>requestCode <span class="token operator">==</span> RESULT_OK<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                    <span class="token class-name">String</span> result <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">getStringExtra</span><span class="token punctuation">(</span><span class="token string">"message"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token class-name">Intent</span> intent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token function">startActivity</span><span class="token punctuation">(</span>intent<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> result<span class="token punctuation">,</span> <span class="token class-name">Toast</span><span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span>  
    <span class="token punctuation">&#125;</span>  
<span class="token punctuation">&#125;</span>  
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>其中，onCreate函数初始化界面，引入ToolBar和NavigationView，onNavigationItemSelected函数设置侧边栏的点击事件的响应，onOptionsItemSelected函数设置ToolBar右边下拉框点击事件的响应。</p>
</li>
<li><p>布局</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>android.support.v4.widget.DrawerLayout</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res/android<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">xmlns:</span>app</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res-auto<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">xmlns:</span>tools</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/tools<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/drawer_layout<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>fitsSystemWindows</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">tools:</span>openDrawer</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>start<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span>  
        <span class="token attr-name">layout</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@layout/app_bar_main<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>android.support.design.widget.NavigationView</span>  
        <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/nav_view<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_gravity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>start<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>fitsSystemWindows</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">app:</span>headerLayout</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@layout/nav_header_main<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">app:</span>menu</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@menu/activity_main_drawer<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>android.support.design.widget.NavigationView</span><span class="token punctuation">></span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>android.support.v4.widget.DrawerLayout</span><span class="token punctuation">></span></span>  
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>其中<code>&lt;include&gt;</code>导入主页面，<code>&lt;android.support.design.widget.NavigationView&gt;</code>标签设置侧边栏，<code>app:headerLayout</code>和<code>app:menu</code>设置侧边栏的头部和身体。</p>
</li>
</ul>
<h2 id="首页碎片显示"><a href="#首页碎片显示" class="headerlink" title="首页碎片显示"></a>首页碎片显示</h2><ol>
<li><p>首页内容显示采用<code>碎片+RecylerView+CardView</code>，核心代码如下</p>
<p>​    </p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NewsTitleFragment</span> <span class="token keyword">extends</span> <span class="token class-name">Fragment</span> <span class="token punctuation">&#123;</span>  
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> isTwoPane<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Connection</span> conn <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">PreparedStatement</span> stmt <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">News</span><span class="token punctuation">></span></span> sNewsList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">News</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">CountDownLatch</span> ctl <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CountDownLatch</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">SwipeRefreshLayout</span> swipeRefreshLayout<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">NewsAdapter</span> newsAdapter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NewsAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token annotation punctuation">@Nullable</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token class-name">View</span> <span class="token function">onCreateView</span><span class="token punctuation">(</span><span class="token class-name">LayoutInflater</span> inflater<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">ViewGroup</span> container<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token class-name">View</span> view <span class="token operator">=</span> inflater<span class="token punctuation">.</span><span class="token function">inflate</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>news_title_frag<span class="token punctuation">,</span> container<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">RecyclerView</span> newsTitleRecyclerView <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">RecyclerView</span><span class="token punctuation">)</span> view<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>news_title_recycle_view<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">LinearLayoutManager</span> layoutManager <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinearLayoutManager</span><span class="token punctuation">(</span><span class="token function">getActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token annotation punctuation">@Override</span>  
            <span class="token keyword">protected</span> <span class="token keyword">int</span> <span class="token function">getExtraLayoutSpace</span><span class="token punctuation">(</span><span class="token class-name">RecyclerView<span class="token punctuation">.</span>State</span> state<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token keyword">return</span> <span class="token number">300</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  
        newsTitleRecyclerView<span class="token punctuation">.</span><span class="token function">setLayoutManager</span><span class="token punctuation">(</span>layoutManager<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token annotation punctuation">@SuppressLint</span><span class="token punctuation">(</span><span class="token string">"HandlerLeak"</span><span class="token punctuation">)</span> <span class="token keyword">final</span>  
        <span class="token class-name">Handler</span> handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token annotation punctuation">@Override</span>  
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleMessage</span><span class="token punctuation">(</span><span class="token class-name">Message</span> msg<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                sNewsList <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">News</span><span class="token punctuation">></span></span><span class="token punctuation">)</span> msg<span class="token punctuation">.</span>obj<span class="token punctuation">;</span>  
                <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"sNewList.length : "</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>sNewsList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  
        <span class="token class-name">Thread</span> thread <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
        thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token annotation punctuation">@Override</span>  
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string">"ppppp: ???"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>  
                    conn <span class="token operator">=</span> <span class="token class-name">MySQLConnections</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"blog"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token punctuation">&#125;</span>  
                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>  
                    <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"select id,author,title,content from Blog"</span><span class="token punctuation">;</span>  
                    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">News</span><span class="token punctuation">></span></span> list_tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">News</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>conn <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                        stmt <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        conn<span class="token punctuation">.</span><span class="token function">setAutoCommit</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        <span class="token class-name">ResultSet</span> rs <span class="token operator">=</span> stmt<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//用rs接收sql语句返回的查询结果  </span>
                        <span class="token comment">//执行查询语句并且保存结果  </span>
                        <span class="token keyword">while</span> <span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                            <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            <span class="token class-name">News</span> news <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">News</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            news<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            news<span class="token punctuation">.</span><span class="token function">setAuthor</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"author"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            news<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"title"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            news<span class="token punctuation">.</span><span class="token function">setContent</span><span class="token punctuation">(</span><span class="token string">"\u3000\u3000"</span> <span class="token operator">+</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"content"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"Title"</span><span class="token punctuation">,</span> news<span class="token punctuation">.</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            list_tmp<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>news<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        <span class="token punctuation">&#125;</span>  
                        <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span>list_tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        sNewsList <span class="token operator">=</span> list_tmp<span class="token punctuation">;</span>  
                        <span class="token class-name">Message</span> msg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        msg<span class="token punctuation">.</span>obj <span class="token operator">=</span> list_tmp<span class="token punctuation">;</span>  
                        handler<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        rs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token punctuation">&#125;</span>  
                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>  
                <span class="token punctuation">&#125;</span>  
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>  
            thread<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
        swipeRefreshLayout <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">SwipeRefreshLayout</span><span class="token punctuation">)</span> view<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>swip_refresh<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        swipeRefreshLayout<span class="token punctuation">.</span><span class="token function">setOnRefreshListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SwipeRefreshLayout<span class="token punctuation">.</span>OnRefreshListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  
            <span class="token annotation punctuation">@Override</span>  
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token function">refreshContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        newsAdapter<span class="token punctuation">.</span><span class="token function">setmNewList</span><span class="token punctuation">(</span>sNewsList<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"length:"</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>sNewsList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string">"What???"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        newsTitleRecyclerView<span class="token punctuation">.</span><span class="token function">setAdapter</span><span class="token punctuation">(</span>newsAdapter<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> view<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">refreshContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token annotation punctuation">@SuppressLint</span><span class="token punctuation">(</span><span class="token string">"HandlerLeak"</span><span class="token punctuation">)</span> <span class="token keyword">final</span>  
        <span class="token class-name">Handler</span> handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token annotation punctuation">@Override</span>  
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleMessage</span><span class="token punctuation">(</span><span class="token class-name">Message</span> msg<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                sNewsList <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">News</span><span class="token punctuation">></span></span><span class="token punctuation">)</span> msg<span class="token punctuation">.</span>obj<span class="token punctuation">;</span>  
				   newsAdapter<span class="token punctuation">.</span><span class="token function">addList</span><span class="token punctuation">(</span>sNewsList<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                swipeRefreshLayout<span class="token punctuation">.</span><span class="token function">setRefreshing</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"sNewList.length : "</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>sNewsList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  
        <span class="token class-name">Thread</span> thread <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
        thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token annotation punctuation">@Override</span>  
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string">"ppppp: ???"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>  
                    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    conn <span class="token operator">=</span> <span class="token class-name">MySQLConnections</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"blog"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token punctuation">&#125;</span>  
                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>  
                    <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"select id,author,title,content from Blog"</span><span class="token punctuation">;</span>  
                    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">News</span><span class="token punctuation">></span></span> list_tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">News</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>conn <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                        stmt <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        conn<span class="token punctuation">.</span><span class="token function">setAutoCommit</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        <span class="token class-name">ResultSet</span> rs <span class="token operator">=</span> stmt<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//用rs接收sql语句返回的查询结果  </span>
                        <span class="token comment">//执行查询语句并且保存结果  </span>
                        <span class="token keyword">while</span> <span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                            <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            <span class="token class-name">News</span> news <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">News</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            news<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            news<span class="token punctuation">.</span><span class="token function">setAuthor</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"author"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            news<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"title"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            news<span class="token punctuation">.</span><span class="token function">setContent</span><span class="token punctuation">(</span><span class="token string">"\u3000\u3000"</span> <span class="token operator">+</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"content"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"Title"</span><span class="token punctuation">,</span> news<span class="token punctuation">.</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            list_tmp<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>news<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        <span class="token punctuation">&#125;</span>  
                        sNewsList <span class="token operator">=</span> list_tmp<span class="token punctuation">;</span>  
                        <span class="token class-name">Message</span> msg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        msg<span class="token punctuation">.</span>obj <span class="token operator">=</span> list_tmp<span class="token punctuation">;</span>  
                        handler<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        rs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token punctuation">&#125;</span>  
                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token punctuation">&#125;</span>  
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
   <span class="token punctuation">&#125;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onActivityCreated</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onActivityCreated</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>new_content_layout<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            isTwoPane <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  
            isTwoPane <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">class</span> <span class="token class-name">NewsAdapter</span> <span class="token keyword">extends</span> <span class="token class-name">RecyclerView<span class="token punctuation">.</span>Adapter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">NewsAdapter<span class="token punctuation">.</span>ViewHolder</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">News</span><span class="token punctuation">></span></span> mNewsList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">News</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">private</span> <span class="token class-name">LayoutInflater</span> mInflater<span class="token punctuation">;</span>  
        <span class="token keyword">class</span> <span class="token class-name">ViewHolder</span> <span class="token keyword">extends</span> <span class="token class-name">RecyclerView<span class="token punctuation">.</span>ViewHolder</span> <span class="token punctuation">&#123;</span>  
            <span class="token class-name">TextView</span> newsTitleText<span class="token punctuation">;</span>  
            <span class="token class-name">CardView</span> newsCardView<span class="token punctuation">;</span>  
            <span class="token class-name">TextView</span> newsContentPreView<span class="token punctuation">;</span>  
            <span class="token class-name">ImageView</span> imageViewPreView<span class="token punctuation">;</span>  
            <span class="token keyword">public</span> <span class="token class-name">ViewHolder</span><span class="token punctuation">(</span><span class="token class-name">View</span> view<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token keyword">super</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                newsCardView <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">CardView</span><span class="token punctuation">)</span> view<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>item_cardview<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                newsTitleText <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">TextView</span><span class="token punctuation">)</span> view<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>news_title<span class="token punctuation">)</span><span class="token punctuation">;</span> 
                newsContentPreView <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">TextView</span><span class="token punctuation">)</span> view<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>news_contentPre<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                imageViewPreView <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ImageView</span><span class="token punctuation">)</span> view<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>imagePreRandon<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span>  
        <span class="token keyword">public</span> <span class="token class-name">NewsAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token punctuation">&#125;</span>  
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setmNewList</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">News</span><span class="token punctuation">></span></span> list<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token keyword">this</span><span class="token punctuation">.</span>mNewsList <span class="token operator">=</span> list<span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
        <span class="token annotation punctuation">@Override</span>  
        <span class="token keyword">public</span> <span class="token class-name">ViewHolder</span> <span class="token function">onCreateViewHolder</span><span class="token punctuation">(</span><span class="token class-name">ViewGroup</span> parent<span class="token punctuation">,</span> <span class="token keyword">int</span> viewType<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
            <span class="token class-name">View</span> view <span class="token operator">=</span> <span class="token class-name">LayoutInflater</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>parent<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">inflate</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>new_item<span class="token punctuation">,</span> parent<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token keyword">final</span> <span class="token class-name">ViewHolder</span> holder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ViewHolder</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            view<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token annotation punctuation">@Override</span>  
                <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                    <span class="token class-name">News</span> news <span class="token operator">=</span> mNewsList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>holder<span class="token punctuation">.</span><span class="token function">getAdapterPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>isTwoPane<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                        <span class="token class-name">NewsContentFragment</span> newsContentFragment <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">NewsContentFragment</span><span class="token punctuation">)</span> <span class="token function">getFragmentManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
                                <span class="token punctuation">.</span><span class="token function">findFragmentById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>news_content_fragment<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        newsContentFragment<span class="token punctuation">.</span><span class="token function">refresh</span><span class="token punctuation">(</span>news<span class="token punctuation">.</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> news<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  
                        <span class="token class-name">NewsContentActivity</span><span class="token punctuation">.</span><span class="token function">actionStart</span><span class="token punctuation">(</span><span class="token function">getActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> news<span class="token punctuation">.</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> news<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token punctuation">&#125;</span>  
                <span class="token punctuation">&#125;</span>  
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token keyword">return</span> holder<span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
        <span class="token annotation punctuation">@Override</span>  
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onBindViewHolder</span><span class="token punctuation">(</span><span class="token class-name">ViewHolder</span> holder<span class="token punctuation">,</span> <span class="token keyword">int</span> position<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token class-name">News</span> news <span class="token operator">=</span> mNewsList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            holder<span class="token punctuation">.</span>newsTitleText<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>news<span class="token punctuation">.</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            holder<span class="token punctuation">.</span>newsContentPreView<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>news<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>news<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">10</span> <span class="token operator">?</span> <span class="token number">10</span> <span class="token operator">:</span> news<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token keyword">int</span> cnt <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                holder<span class="token punctuation">.</span>imageViewPreView<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>img_1<span class="token punctuation">)</span><span class="token punctuation">;</span>  
           <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                holder<span class="token punctuation">.</span>imageViewPreView<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>img_2<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                holder<span class="token punctuation">.</span>imageViewPreView<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>img_3<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                holder<span class="token punctuation">.</span>imageViewPreView<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>img_5<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                holder<span class="token punctuation">.</span>imageViewPreView<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>img_5<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                holder<span class="token punctuation">.</span>imageViewPreView<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>img_6<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                holder<span class="token punctuation">.</span>imageViewPreView<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>img_7<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                holder<span class="token punctuation">.</span>imageViewPreView<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>img_8<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                holder<span class="token punctuation">.</span>imageViewPreView<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>img_9<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                holder<span class="token punctuation">.</span>imageViewPreView<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>img_10<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                holder<span class="token punctuation">.</span>imageViewPreView<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>img_11<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  
                holder<span class="token punctuation">.</span>imageViewPreView<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>img_12<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span>  
  
        <span class="token annotation punctuation">@Override</span>  
        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getItemCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token keyword">return</span> mNewsList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
    <span class="token punctuation">&#125;</span>  
<span class="token punctuation">&#125;</span>  
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>重写<code>onCreateView</code>函数承载每个子项的布局，函数中<strong>开启线程和回调函数负责于服务器服务器建立连接</strong><code>MySQLConnections.getConnection(&quot;blog&quot;)</code>，同时进行select查询；建立<code>SwipeRefreshLayout</code>实现下拉刷新事件。</p>
<p><code>onActivityCreated</code>函数判断是平板显示还是手机显示，若是平板显示，则调用<strong>帖子内容碎片</strong>，否则调用<strong>内容活动Activity</strong>。</p>
<p>建立内容类适配器<code>NewsAdapter</code>，初始化<code>CardView_item</code>的内容，同时重写<code>onCreateViewHolder</code>函数，负责<strong>接收点击CardView_item跳转到帖子详情页面的事件</strong>。</p>
<p>重写<code>onBindViewHolder</code>函数承载每个子项Holder绑定数据，函数实现了随机图片显示。<code>swipeRefreshLayout.setOnRefreshListener</code>实现<strong>下拉刷新事件</strong>，重写<code>OnRefresh</code>函数使用<code>refreshContent</code>函数实现下拉<strong>刷新内容数据的更新</strong>。</p>
<p><code>getItemCount</code>函数获取<strong>帖子个数</strong>。</p>
</li>
</ul>
</li>
<li><p>碎片布局</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RelativeLayout</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res/android<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>orientation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>vertical<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ImageView</span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>scaleType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>centerCrop<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@drawable/bg_wood<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>android.support.v4.widget.SwipeRefreshLayout</span>  
        <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/swip_refresh<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>orientation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>vertical<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>android.support.v7.widget.RecyclerView</span>  
            <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/news_title_recycle_view<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>overScrollMode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>never<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>android.support.v4.widget.SwipeRefreshLayout</span><span class="token punctuation">></span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RelativeLayout</span><span class="token punctuation">></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>主页内容碎片采用<strong>RelativeLayout</strong>布局，<imageView>标签设置<strong>背景图片</strong>，<strong>SwipeRefreshLayout</strong>实现下拉<strong>刷新</strong><code>RecylarView</code>。</imageView></li>
</ul>
</li>
<li><p><code>RecylerView</code>的子布局</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>android.support.v7.widget.CardView</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res/android<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">xmlns:</span>app</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res-auto<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">xmlns:</span>card_view</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res-auto<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>layout_marginBottom</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>16dp<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>layout_marginLeft</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>12dp<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>layout_marginRight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>12dp<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>layout_marginTop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2dp<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">app:</span>cardCornerRadius</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>15dp<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">app:</span>cardElevation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>10dp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>361dp<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>282dp<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>background</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#fff<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>orientation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>vertical<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>weightSum</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ImageView</span>  
            <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/imagePreRandon<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>182dp<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>scaleType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>centerCrop<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>113dp<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_centerVertical</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_margin</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>12dp<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>orientation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>vertical<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextView</span>  
                <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/news_title<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>42dp<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>padding</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>5dp<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>textSize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>18sp<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>textStyle</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bold<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextView</span>  
                <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/news_contentPre<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>padding</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>5dp<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">></span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>android.support.v7.widget.CardView</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><code>RecyclerView</code>的子<code>view</code>采用<strong>CardView布局</strong></li>
</ul>
</li>
</ol>
<h2 id="侧边栏"><a href="#侧边栏" class="headerlink" title="侧边栏"></a>侧边栏</h2><ol>
<li><p>Head</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res/android<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">xmlns:</span>app</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res-auto<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@dimen/nav_header_height<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>background</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@drawable/side_nav_bar<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>gravity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bottom<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>orientation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>vertical<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>paddingBottom</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@dimen/activity_vertical_margin<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>paddingLeft</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@dimen/activity_horizontal_margin<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>paddingRight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@dimen/activity_horizontal_margin<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>paddingTop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@dimen/activity_vertical_margin<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>theme</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@style/ThemeOverlay.AppCompat.Dark<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>weightSum</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ImageView</span>  
        <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/imageView<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>88dp<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>paddingTop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@dimen/nav_header_vertical_spacing<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@drawable/touxiang<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextView</span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>paddingTop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@dimen/nav_header_vertical_spacing<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>GaoMing<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>textAppearance</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@style/TextAppearance.AppCompat.Body1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextView</span>  
        <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/textView<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>所爱山海间<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>Menu</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>menu</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res/android<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>group</span> <span class="token attr-name"><span class="token namespace">android:</span>checkableBehavior</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>single<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span>  
            <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/nav_camera<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>icon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@drawable/ic_menu_camera<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>登录<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span>  
            <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/nav_gallery<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>icon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@drawable/ic_menu_gallery<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>发帖<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span>  
            <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/nav_slideshow<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>icon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@drawable/ic_menu_slideshow<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>GaoMing’s Web <span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span>  
            <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/nav_manage<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>icon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@drawable/ic_menu_manage<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>地图
 <span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>group</span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span> <span class="token attr-name"><span class="token namespace">android:</span>title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Communicate<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>menu</span><span class="token punctuation">></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span>  
                <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/nav_share<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>icon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@drawable/ic_menu_share<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Share<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span>  
                <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/nav_send<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>icon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@drawable/ic_menu_send<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Send<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>menu</span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">></span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>menu</span><span class="token punctuation">></span></span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<h2 id="帖子详情页面"><a href="#帖子详情页面" class="headerlink" title="帖子详情页面"></a>帖子详情页面</h2><ol>
<li><p>活动核心代码</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NewsContentActivity</span> <span class="token keyword">extends</span> <span class="token class-name">AppCompatActivity</span> <span class="token keyword">implements</span> <span class="token class-name">NavigationView<span class="token punctuation">.</span>OnNavigationItemSelectedListener</span> <span class="token punctuation">&#123;</span>  
    <span class="token keyword">private</span> <span class="token class-name">ImageView</span> imageViewContent<span class="token punctuation">;</span>  
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">actionStart</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> <span class="token class-name">String</span> newsTitle<span class="token punctuation">,</span> <span class="token class-name">String</span> newsContent<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token class-name">Intent</span> intent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token class-name">NewsContentActivity</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        intent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">"news_title"</span><span class="token punctuation">,</span> newsTitle<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        intent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">"news_content"</span><span class="token punctuation">,</span> newsContent<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        context<span class="token punctuation">.</span><span class="token function">startActivity</span><span class="token punctuation">(</span>intent<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">setContentView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_news_content<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        imageViewContent <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ImageView</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>imageContent<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">int</span> cnt <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            imageViewContent<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>img_1<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            imageViewContent<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>img_2<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            imageViewContent<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>img_3<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            imageViewContent<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>img_5<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            imageViewContent<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>img_5<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            imageViewContent<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>img_6<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            imageViewContent<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>img_7<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            imageViewContent<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>img_8<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            imageViewContent<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>img_9<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            imageViewContent<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>img_10<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">==</span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            imageViewContent<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>img_11<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  
            imageViewContent<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>img_12<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
        <span class="token class-name">Toolbar</span> toolbar <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Toolbar</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>toolbar<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">String</span> newsTitle <span class="token operator">=</span> <span class="token function">getIntent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStringExtra</span><span class="token punctuation">(</span><span class="token string">"news_title"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">String</span> newContent <span class="token operator">=</span> <span class="token function">getIntent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStringExtra</span><span class="token punctuation">(</span><span class="token string">"news_content"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">NewsContentFragment</span> newsContentFragment <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">NewsContentFragment</span><span class="token punctuation">)</span> <span class="token function">getSupportFragmentManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
                <span class="token punctuation">.</span><span class="token function">findFragmentById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>news_content_fragment<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        newsContentFragment<span class="token punctuation">.</span><span class="token function">refresh</span><span class="token punctuation">(</span>newsTitle<span class="token punctuation">,</span> newContent<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        toolbar<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span>newsTitle<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        toolbar<span class="token punctuation">.</span><span class="token function">setSubtitle</span><span class="token punctuation">(</span>newsTitle<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">setSupportActionBar</span><span class="token punctuation">(</span>toolbar<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">getSupportActionBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setDisplayHomeAsUpEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//左侧添加一个默认的返回图标  </span>
        <span class="token function">getSupportActionBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setHomeButtonEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置返回键可用  </span>
        toolbar<span class="token punctuation">.</span><span class="token function">setNavigationOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token annotation punctuation">@Override</span>  
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">onNavigationItemSelected</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> <span class="token class-name">MenuItem</span> item<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
<span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><strong>actionStart</strong>函数负责启动活动，<strong>onCreate</strong>生成活动窗口，初始化内容。</li>
</ul>
</li>
<li><p>帖子详情页面布局</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>android.support.design.widget.CoordinatorLayout</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res/android<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">xmlns:</span>app</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res-auto<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">xmlns:</span>tools</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/tools<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>fitsSystemWindows</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>orientation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>vertical<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>android.support.design.widget.AppBarLayout</span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>200dp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>android.support.design.widget.CollapsingToolbarLayout</span>  
            <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/toolbar_layout<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">app:</span>contentScrim</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@color/colorPrimary<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">app:</span>layout_scrollFlags</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>scroll|exitUntilCollapsed<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ImageView</span>  
                <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/imageContent<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>scaleType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>centerCrop<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">app:</span>layout_collapseMode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>parallax<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">app:</span>layout_collapseParallaxMultiplier</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0.9<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">tools:</span>ignore</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ContentDescription<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>android.support.v7.widget.Toolbar</span>  
                <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/toolbar<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>50dp<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>theme</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@style/ToolBarTheme<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">app:</span>layout_collapseMode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pin<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>android.support.design.widget.CollapsingToolbarLayout</span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>android.support.design.widget.AppBarLayout</span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>android.support.v4.widget.NestedScrollView</span>  
        <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/visibility_layout<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">app:</span>layout_behavior</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@string/appbar_scrolling_view_behavior<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>android.support.v7.widget.CardView</span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_marginBottom</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>15dp<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_marginLeft</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>15dp<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_marginRight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>15dp<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_marginTop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>15dp<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">app:</span>cardCornerRadius</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>10dp<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">app:</span>cardElevation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>10dp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextView</span>  
                <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/news_content<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>layout_gravity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>center_horizontal<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>textSize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>20sp<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>android.support.v7.widget.CardView</span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>android.support.v4.widget.NestedScrollView</span><span class="token punctuation">></span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>android.support.design.widget.CoordinatorLayout</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>内容布局采用<code>CoordinatorLayout</code>（Super-power FrameLayout）<strong>作为顶部布局和同时负责协调子view交互。使用</strong><code>AppBarLayout</code><strong>响应滚动手势和</strong><code>ToorBar</code>**作为顶部子项。使用<code>CardView</code>作为帖子详细内容主体。</li>
</ul>
</li>
</ol>
<h2 id="发布帖子页面"><a href="#发布帖子页面" class="headerlink" title="发布帖子页面"></a>发布帖子页面</h2><ol>
<li><p><code>PublishPost</code>核心代码</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PublishPost</span> <span class="token keyword">extends</span> <span class="token class-name">AppCompatActivity</span> <span class="token punctuation">&#123;</span>  
    <span class="token keyword">private</span> <span class="token class-name">Uri</span> imageUri<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> number <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">ImageView</span> imageView<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">EditText</span> editText1<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">EditText</span> editText2<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">EditText</span> editText3<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">Toolbar</span> toolbar<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">Button</span> button<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> CODE_PICK_PHOTO <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> RESULT_REQUEST_CODE <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> bitmapToString<span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> photoPath <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">Bitmap</span> bitmap<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">setContentView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_publish_post<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">Intent</span> intentRec <span class="token operator">=</span> <span class="token function">getIntent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        username <span class="token operator">=</span> intentRec<span class="token punctuation">.</span><span class="token function">getStringExtra</span><span class="token punctuation">(</span><span class="token string">"userName"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">Toolbar</span> toolbar <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Toolbar</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>toolbar<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">final</span> <span class="token class-name">Handler</span> handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Handler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Handler<span class="token punctuation">.</span>Callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token annotation punctuation">@Override</span>  
            <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">handleMessage</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token annotation punctuation">@Override</span>  
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token class-name">Message</span> msg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//message用于给handler传递参数  </span>
                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>  
                    <span class="token class-name">MySQLConnections</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"Blog"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"TAG"</span><span class="token punctuation">,</span> <span class="token string">" 数据操作异常"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token punctuation">&#125;</span>  
                handler<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>  
           <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        imageView <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ImageView</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>imageUp<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        imageView<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token annotation punctuation">@Override</span>  
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token class-name">Intent</span> intent_gallery <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token class-name">Intent</span><span class="token punctuation">.</span>ACTION_PICK<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                intent_gallery<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">"image/*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token function">startActivityForResult</span><span class="token punctuation">(</span>intent_gallery<span class="token punctuation">,</span> CODE_PICK_PHOTO<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        editText1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">EditText</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>upAuthor<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        editText2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">EditText</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>uptitle<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        editText3 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">EditText</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>upcontent<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        button <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Button</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>buttonPub<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        button<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token annotation punctuation">@Override</span>  
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token keyword">final</span> <span class="token class-name">String</span> title <span class="token operator">=</span> editText1<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token keyword">final</span> <span class="token class-name">String</span> author <span class="token operator">=</span> editText2<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token keyword">final</span> <span class="token class-name">String</span> content <span class="token operator">=</span> editText3<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                    <span class="token annotation punctuation">@Override</span>  
                    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>  
                            <span class="token class-name">MySQLConnections</span><span class="token punctuation">.</span><span class="token function">insertIntoData</span><span class="token punctuation">(</span><span class="token class-name">PublishPost</span><span class="token punctuation">.</span>number<span class="token operator">++</span><span class="token punctuation">,</span> title<span class="token punctuation">,</span> author<span class="token punctuation">,</span> content<span class="token punctuation">,</span>bitmapToString<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用插入数据库语句  </span>
                        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        <span class="token punctuation">&#125;</span>  
                    <span class="token punctuation">&#125;</span>  
                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token class-name">Saving</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span>content<span class="token punctuation">,</span>username<span class="token punctuation">,</span>bitmapToString<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token class-name">Intent</span> intent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token class-name">PublishPost</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                intent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">"postTitle"</span><span class="token punctuation">,</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                intent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">"UNAME"</span><span class="token punctuation">,</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token function">setResult</span><span class="token punctuation">(</span>RESULT_OK<span class="token punctuation">,</span> intent<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        toolbar <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Toolbar</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>toolbarPub<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        toolbar<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">"发帖"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        toolbar<span class="token punctuation">.</span><span class="token function">setSubtitle</span><span class="token punctuation">(</span><span class="token string">"GaoMing"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">setSupportActionBar</span><span class="token punctuation">(</span>toolbar<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">getSupportActionBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setDisplayHomeAsUpEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">getSupportActionBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setHomeButtonEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        toolbar<span class="token punctuation">.</span><span class="token function">setNavigationOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token annotation punctuation">@Override</span>  
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
  
   <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token class-name">Saving</span><span class="token punctuation">(</span><span class="token class-name">String</span> title<span class="token punctuation">,</span> <span class="token class-name">String</span> content<span class="token punctuation">,</span> <span class="token class-name">String</span> username<span class="token punctuation">,</span> <span class="token class-name">String</span> bitmapToString<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token class-name">MyPost</span> mypost <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyPost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        mypost<span class="token punctuation">.</span><span class="token function">setNewstitle</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        mypost<span class="token punctuation">.</span><span class="token function">setNewscontent</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        mypost<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        mypost<span class="token punctuation">.</span><span class="token function">setImagePost</span><span class="token punctuation">(</span>bitmapToString<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">boolean</span> is_ok <span class="token operator">=</span> mypost<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"Answer:"</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>is_ok<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onActivityResult</span><span class="token punctuation">(</span><span class="token keyword">int</span> requestCode<span class="token punctuation">,</span> <span class="token keyword">int</span> resultCode<span class="token punctuation">,</span> <span class="token class-name">Intent</span> data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onActivityResult</span><span class="token punctuation">(</span>requestCode<span class="token punctuation">,</span> resultCode<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>requestCode <span class="token operator">==</span> CODE_PICK_PHOTO<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//相册  </span>
            imageUri<span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token comment">//获取照片路径  </span>
            imageView<span class="token punctuation">.</span><span class="token function">setImageURI</span><span class="token punctuation">(</span>imageUri<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token class-name">Bitmap</span> bitmap <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>  
                bitmap <span class="token operator">=</span> <span class="token class-name">MediaStore<span class="token punctuation">.</span>Images<span class="token punctuation">.</span>Media</span><span class="token punctuation">.</span><span class="token function">getBitmap</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getContentResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> imageUri<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                bitmapToString <span class="token operator">=</span> <span class="token class-name">ImageHelper</span><span class="token punctuation">.</span><span class="token function">bitmapToString</span><span class="token punctuation">(</span>bitmap<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span>  
    <span class="token punctuation">&#125;</span>  
  
<span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><strong>onCreate</strong>函数初始化发帖活动和布局，同时开启线程连接服务器的数据库（<code>MySQL</code>）<strong>。</strong>在<strong>onActivityResult函数处理图片解析，将图片解析成字符串并保存到数据库。点击发布按钮，触发开启线程插入帖子到数据库</strong>（<code>MySQLConnections.insertIntoData</code>）。</li>
</ul>
</li>
<li><p>PublishPost布局</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res/android<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">xmlns:</span>app</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res-auto<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">xmlns:</span>tools</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/tools<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>fitsSystemWindows</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>orientation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>vertical<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">tools:</span>context</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cn.com.text.Activity.PublishPost<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>android.support.design.widget.AppBarLayout</span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>theme</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@style/AppTheme.NoActionBar.AppBarOverlay<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>android.support.v7.widget.Toolbar</span>  
            <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/toolbarPub<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>?attr/actionBarSize<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>background</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>?attr/colorPrimary<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">app:</span>popupTheme</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@style/AppTheme.NoActionBar.PopupOverlay<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>android.support.design.widget.AppBarLayout</span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>orientation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>vertical<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Button</span>  
            <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/buttonPub<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>发布<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>368dp<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>orientation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>vertical<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span>  
        <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/include<span class="token punctuation">"</span></span>  
        <span class="token attr-name">layout</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@layout/content_publish_post<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>429dp<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">></span></span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<h2 id="WebBlog"><a href="#WebBlog" class="headerlink" title="WebBlog"></a>WebBlog</h2><ol>
<li><p>此模块使用WebView实现APP内嵌网页，网页链接到我的个人博客（<code>GaoMing’s Web</code>），并且添加<code>ToolBar</code>作为顶部，添加返回键。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebBlog</span> <span class="token keyword">extends</span> <span class="token class-name">AppCompatActivity</span> <span class="token punctuation">&#123;</span>  
    <span class="token keyword">private</span> <span class="token class-name">Toolbar</span> toolbar<span class="token punctuation">;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">setContentView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_web_blog<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        toolbar <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Toolbar</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>toolbarWeb<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        toolbar<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">"Blog"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        toolbar<span class="token punctuation">.</span><span class="token function">setSubtitle</span><span class="token punctuation">(</span><span class="token string">"GaoMing"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">setSupportActionBar</span><span class="token punctuation">(</span>toolbar<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token comment">//        toolbar.setNavigationIcon(R.drawable.ic_action_n);  </span>
        <span class="token function">getSupportActionBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setDisplayHomeAsUpEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//左侧添加一个默认的返回图标  </span>
        <span class="token function">getSupportActionBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setHomeButtonEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置返回键可用  </span>
        toolbar<span class="token punctuation">.</span><span class="token function">setNavigationOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token annotation punctuation">@Override</span>  
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">WebView</span> webView <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">WebView</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>web_view<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        webView<span class="token punctuation">.</span><span class="token function">getSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setJavaScriptEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        webView<span class="token punctuation">.</span><span class="token function">setWebViewClient</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">WebViewClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        webView<span class="token punctuation">.</span><span class="token function">loadUrl</span><span class="token punctuation">(</span><span class="token string">"http://www.keegan.cn"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
<span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<h2 id="登录功能"><a href="#登录功能" class="headerlink" title="登录功能"></a>登录功能</h2><ol>
<li><p>登录活动实现用户登录和注册，否则用户只有看帖操作，无发帖删帖更新帖子的操作。后台获取到<code>username</code>和<code>password</code>，会进行<strong>验证是否为空</strong>，根据点击的按钮触发注册或者登录，如果是注册，会<strong>查询数据库是否已存在该用户</strong>，没有的话就进行<strong>插入</strong>操作，如果是点击登录，会<strong>查询数据库是否存在该用户</strong>，如果存在，则跳转登录到主页，否则弹出不存在该用户的<code>Toast</code>提示。对于头像上传，要求注册时<strong>必须选择头像</strong>，否则会注册失败。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LogActivity</span> <span class="token keyword">extends</span> <span class="token class-name">AppCompatActivity</span> <span class="token punctuation">&#123;</span>  
    <span class="token keyword">private</span> <span class="token class-name">Button</span> button_submit<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">EditText</span> username<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">EditText</span> password<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">Button</span> button_reg<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">ImageView</span> imageView<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> CODE_PICK_PHOTO <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">Uri</span> imageUri<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> bitmapToString <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">setContentView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_log<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">LitePal</span><span class="token punctuation">.</span><span class="token function">getDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        username <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">EditText</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        password <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">EditText</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        imageView <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ImageView</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>userImage<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        imageView<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token annotation punctuation">@Override</span>  
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token class-name">Intent</span> intent_gallery <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token class-name">Intent</span><span class="token punctuation">.</span>ACTION_PICK<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                intent_gallery<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">"image/*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token function">startActivityForResult</span><span class="token punctuation">(</span>intent_gallery<span class="token punctuation">,</span> CODE_PICK_PHOTO<span class="token punctuation">)</span><span class="token punctuation">;</span>  
           <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        button_submit <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Button</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>button_submit<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        button_submit<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token annotation punctuation">@Override</span>  
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">TextUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>username<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">TextUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>password<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                    <span class="token class-name">User</span> usr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    usr<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>username<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    usr<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span>password<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    usr<span class="token punctuation">.</span><span class="token function">setImage</span><span class="token punctuation">(</span>bitmapToString<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token comment">//检查是否有此用户  </span>
                    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> userList <span class="token operator">=</span> <span class="token class-name">DataSupport</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">"name = ? and password = ?"</span><span class="token punctuation">,</span> usr<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>usr<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>userList<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                        <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">LogActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">"用户名或密码错误"</span><span class="token punctuation">,</span> <span class="token class-name">Toast</span><span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  
                        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">,</span> username<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">LogActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">"登陆成功"</span><span class="token punctuation">,</span> <span class="token class-name">Toast</span><span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        <span class="token class-name">Intent</span> intent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token class-name">LogActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        intent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">,</span>usr<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        intent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">,</span>usr<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                       <span class="token comment">// intent.putExtra("image",bitmapToString);  </span>
                        <span class="token function">setResult</span><span class="token punctuation">(</span>RESULT_OK<span class="token punctuation">,</span>intent<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        <span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token punctuation">&#125;</span>  
                <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  
                    <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">LogActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token string">"用户名或密码不为空"</span><span class="token punctuation">,</span><span class="token class-name">Toast</span><span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token punctuation">&#125;</span>  
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        button_reg <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Button</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>reg_button<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        button_reg<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token annotation punctuation">@Override</span>  
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">TextUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>username<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">TextUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>password<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                    <span class="token keyword">final</span> <span class="token class-name">User</span> usr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token keyword">final</span> <span class="token class-name">String</span> usrname <span class="token operator">=</span> username<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token keyword">final</span> <span class="token class-name">String</span> usrpassword <span class="token operator">=</span> password<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    usr<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>usrname<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    usr<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span>usrpassword<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    usr<span class="token punctuation">.</span><span class="token function">setImage</span><span class="token punctuation">(</span>bitmapToString<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token comment">//检查是否有此用户  </span>
                    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> userList <span class="token operator">=</span> <span class="token class-name">DataSupport</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">"name = ?"</span><span class="token punctuation">,</span> usr<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token keyword">if</span><span class="token punctuation">(</span>bitmapToString <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>userList<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                            <span class="token class-name">Thread</span> thread <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
                            thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                                <span class="token annotation punctuation">@Override</span>  
                                <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                                    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>  
                                        <span class="token class-name">MySQLConnections</span><span class="token punctuation">.</span><span class="token function">insertIntoUser</span><span class="token punctuation">(</span>usrname<span class="token punctuation">,</span>usrpassword<span class="token punctuation">,</span>bitmapToString<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                                    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                                        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                                    <span class="token punctuation">&#125;</span>  
                                <span class="token punctuation">&#125;</span>  
                            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>  
                                thread<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            <span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  
                                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            <span class="token punctuation">&#125;</span>  
                            usr<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">LogActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">"注册成功"</span><span class="token punctuation">,</span> <span class="token class-name">Toast</span><span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  
                            <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">LogActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">"重复注册，请登录"</span><span class="token punctuation">,</span> <span class="token class-name">Toast</span><span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        <span class="token punctuation">&#125;</span>  
                    <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  
                        <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">LogActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token string">"请选择头像"</span><span class="token punctuation">,</span><span class="token class-name">Toast</span><span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token punctuation">&#125;</span>  
  
                <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>  
                    <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">LogActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token string">"注册用户名或密码不为空"</span><span class="token punctuation">,</span><span class="token class-name">Toast</span><span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token punctuation">&#125;</span>  
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onActivityResult</span><span class="token punctuation">(</span><span class="token keyword">int</span> requestCode<span class="token punctuation">,</span> <span class="token keyword">int</span> resultCode<span class="token punctuation">,</span> <span class="token class-name">Intent</span> data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onActivityResult</span><span class="token punctuation">(</span>requestCode<span class="token punctuation">,</span> resultCode<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>requestCode <span class="token operator">==</span> CODE_PICK_PHOTO<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//相册  </span>
            imageUri<span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token comment">//获取照片路径  </span>
            imageView<span class="token punctuation">.</span><span class="token function">setImageURI</span><span class="token punctuation">(</span>imageUri<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token class-name">Bitmap</span> bitmap <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>  
                bitmap <span class="token operator">=</span> <span class="token class-name">MediaStore<span class="token punctuation">.</span>Images<span class="token punctuation">.</span>Media</span><span class="token punctuation">.</span><span class="token function">getBitmap</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getContentResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> imageUri<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                bitmapToString <span class="token operator">=</span> <span class="token class-name">ImageHelper</span><span class="token punctuation">.</span><span class="token function">bitmapToString</span><span class="token punctuation">(</span>bitmap<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span>  
    <span class="token punctuation">&#125;</span>  
<span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>登录页面布局</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res/android<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">xmlns:</span>app</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res-auto<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">xmlns:</span>tools</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/tools<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/activity_main<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>orientation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>vertical<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>paddingBottom</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@dimen/activity_vertical_margin<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>paddingLeft</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@dimen/activity_horizontal_margin<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>paddingRight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@dimen/activity_horizontal_margin<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>paddingTop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@dimen/activity_vertical_margin<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>weightSum</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">tools:</span>context</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cn.com.text.Activity.LogActivity<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>133dp<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_weight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0.02<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>orientation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>vertical<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ImageView</span>  
            <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/userImage<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_gravity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>center_horizontal<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">app:</span>srcCompat</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@drawable/touxiang<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>16dp<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>orientation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>vertical<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>76dp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextView</span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>账户：<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>EditText</span>  
            <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/username<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>76dp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextView</span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>密码：<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>EditText</span>  
            <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/password<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Button</span>  
        <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/button_submit<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>69dp<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>登录<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Button</span>  
        <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/reg_button<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>69dp<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>注册<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<h2 id="用户中心页面"><a href="#用户中心页面" class="headerlink" title="用户中心页面"></a>用户中心页面</h2><ol>
<li><p><code>MyPostActivity</code>实现用户信息显示和已发帖显示，支持点击查看帖子详情和修改删除该贴。实现过程如下：从<code>MainActivity</code>传输的<code>intent</code>中获取当前登录的用户名，查询数据库<code>MyPost</code>表，用户发过的帖子经过<code>PublishPost</code>都已经保存了，所以此时读取到数据后，使用适配器填充<code>ListView</code>的内容显示出来，增加<code>onItem</code>点击事件跳转到其他页面或者选择删除该贴。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyPostActivity</span> <span class="token keyword">extends</span> <span class="token class-name">AppCompatActivity</span> <span class="token punctuation">&#123;</span>  
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MyPost</span><span class="token punctuation">></span></span> mypost <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MyPost</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> username <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">ImageView</span> imageView<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> imageBit <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">setContentView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_my_post<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">Intent</span> intent <span class="token operator">=</span> <span class="token function">getIntent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        username <span class="token operator">=</span> intent<span class="token punctuation">.</span><span class="token function">getStringExtra</span><span class="token punctuation">(</span><span class="token string">"userName"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        imageView <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ImageView</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>imageUserTouxiang<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> userList <span class="token operator">=</span> <span class="token class-name">DataSupport</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">"name = ?"</span><span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>userList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            imageBit <span class="token operator">=</span> userList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getImage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>imageBit<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            imageView<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>touxiang<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  
            imageView<span class="token punctuation">.</span><span class="token function">setImageBitmap</span><span class="token punctuation">(</span><span class="token class-name">ImageHelper</span><span class="token punctuation">.</span><span class="token function">stringToBitmap</span><span class="token punctuation">(</span>imageBit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
        <span class="token function">initMyPost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">MyPostAdapter</span> myPostAdapter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyPostAdapter</span><span class="token punctuation">(</span><span class="token class-name">MyPostActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>mypost_item<span class="token punctuation">,</span> mypost<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">ListView</span> listview <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ListView</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>list_MyPost<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        listview<span class="token punctuation">.</span><span class="token function">setAdapter</span><span class="token punctuation">(</span>myPostAdapter<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        listview<span class="token punctuation">.</span><span class="token function">setOnItemClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AdapterView<span class="token punctuation">.</span>OnItemClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token annotation punctuation">@Override</span>  
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onItemClick</span><span class="token punctuation">(</span><span class="token class-name">AdapterView</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> parent<span class="token punctuation">,</span> <span class="token class-name">View</span> view<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token keyword">int</span> position<span class="token punctuation">,</span> <span class="token keyword">long</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token keyword">final</span> <span class="token class-name">MyPost</span> post <span class="token operator">=</span> mypost<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token function">showNormalDialog</span><span class="token punctuation">(</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token comment">//                Intent intent = new Intent(MyPostActivity.this,NewsContentActivity.class);  </span>
<span class="token comment">//                intent.putExtra("news_title", post.getNewstitle());  </span>
<span class="token comment">//                intent.putExtra("news_content", post.getNewscontent());  </span>
<span class="token comment">//                startActivity(intent);  </span>
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
  
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">initMyPost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        mypost <span class="token operator">=</span> <span class="token class-name">DataSupport</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">"username = ?"</span><span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token class-name">MyPost</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">showNormalDialog</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token keyword">int</span> position<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token comment">//创建dialog构造器  </span>
        <span class="token class-name">AlertDialog<span class="token punctuation">.</span>Builder</span> normalDialog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AlertDialog<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//设置title  </span>
        normalDialog<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">"选择"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//设置内容  </span>
        normalDialog<span class="token punctuation">.</span><span class="token function">setMessage</span><span class="token punctuation">(</span><span class="token string">"你确定这样做么？"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//设置按钮  </span>
        normalDialog<span class="token punctuation">.</span><span class="token function">setPositiveButton</span><span class="token punctuation">(</span><span class="token string">"查看"</span>  
                <span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DialogInterface<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                    <span class="token annotation punctuation">@Override</span>  
                    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">DialogInterface</span> dialog<span class="token punctuation">,</span> <span class="token keyword">int</span> which<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                        <span class="token keyword">final</span> <span class="token class-name">MyPost</span> post <span class="token operator">=</span> mypost<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        <span class="token class-name">Intent</span> intent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token class-name">MyPostActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token class-name">NewsContentActivity</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        intent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">"news_title"</span><span class="token punctuation">,</span> post<span class="token punctuation">.</span><span class="token function">getNewstitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        intent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">"news_content"</span><span class="token punctuation">,</span> post<span class="token punctuation">.</span><span class="token function">getNewscontent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        <span class="token function">startActivity</span><span class="token punctuation">(</span>intent<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        dialog<span class="token punctuation">.</span><span class="token function">dismiss</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token punctuation">&#125;</span>  
                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        normalDialog<span class="token punctuation">.</span><span class="token function">setNegativeButton</span><span class="token punctuation">(</span><span class="token string">"更改"</span><span class="token punctuation">,</span>  
                <span class="token keyword">new</span> <span class="token class-name">DialogInterface<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                    <span class="token annotation punctuation">@Override</span>  
                    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">DialogInterface</span> dialog<span class="token punctuation">,</span> <span class="token keyword">int</span> which<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                        <span class="token keyword">final</span> <span class="token class-name">MyPost</span> post <span class="token operator">=</span> mypost<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        <span class="token class-name">Intent</span> intent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token class-name">MyPostActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token class-name">UpdataPost</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        intent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        intent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">"title"</span><span class="token punctuation">,</span> post<span class="token punctuation">.</span><span class="token function">getNewstitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        intent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">"content"</span><span class="token punctuation">,</span> post<span class="token punctuation">.</span><span class="token function">getNewscontent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        <span class="token function">startActivity</span><span class="token punctuation">(</span>intent<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token punctuation">&#125;</span>  
                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//创建并显示  </span>
        normalDialog<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
<span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>用户帖子适配器</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyPostAdapter</span> <span class="token keyword">extends</span> <span class="token class-name">ArrayAdapter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MyPost</span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span>  
    <span class="token keyword">private</span> <span class="token keyword">int</span> rescoureId<span class="token punctuation">;</span>  
    <span class="token keyword">public</span> <span class="token class-name">MyPostAdapter</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> <span class="token keyword">int</span> textViewResourceId<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MyPost</span><span class="token punctuation">></span></span> objects<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">super</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span>textViewResourceId<span class="token punctuation">,</span>objects<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>rescoureId <span class="token operator">=</span> textViewResourceId<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
  
    <span class="token annotation punctuation">@NonNull</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token class-name">View</span> <span class="token function">getView</span><span class="token punctuation">(</span><span class="token keyword">int</span> position<span class="token punctuation">,</span> <span class="token class-name">View</span> convertView<span class="token punctuation">,</span> <span class="token class-name">ViewGroup</span> parent<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token class-name">MyPost</span> myPost <span class="token operator">=</span> <span class="token function">getItem</span><span class="token punctuation">(</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">View</span> view <span class="token operator">=</span> <span class="token class-name">LayoutInflater</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">inflate</span><span class="token punctuation">(</span>rescoureId<span class="token punctuation">,</span>parent<span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">ImageView</span> imageView <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ImageView</span><span class="token punctuation">)</span> view<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>imageViewMyPost<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">TextView</span> postTitle <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">TextView</span><span class="token punctuation">)</span> view<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>textViewTitle<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">TextView</span> postContent <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">TextView</span><span class="token punctuation">)</span> view<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>textViewContent<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        imageView<span class="token punctuation">.</span><span class="token function">setImageBitmap</span><span class="token punctuation">(</span><span class="token class-name">ImageHelper</span><span class="token punctuation">.</span><span class="token function">stringToBitmap</span><span class="token punctuation">(</span>myPost<span class="token punctuation">.</span><span class="token function">getImagePost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        postTitle<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>myPost<span class="token punctuation">.</span><span class="token function">getNewstitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        postContent<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>myPost<span class="token punctuation">.</span><span class="token function">getNewscontent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> view<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
<span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
</li>
<li><p>用户中心页面布局</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>android.support.design.widget.CoordinatorLayout</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res/android<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">xmlns:</span>app</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res-auto<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">xmlns:</span>tools</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/tools<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>fitsSystemWindows</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>orientation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>vertical<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>android.support.design.widget.AppBarLayout</span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>200dp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>android.support.design.widget.CollapsingToolbarLayout</span>  
            <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/toolbar_layout1<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">app:</span>contentScrim</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@color/colorPrimary<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">app:</span>layout_scrollFlags</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>scroll|exitUntilCollapsed<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ImageView</span>  
                <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/imageUserTouxiang<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>scaleType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>centerCrop<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">app:</span>layout_collapseMode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>parallax<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">app:</span>layout_collapseParallaxMultiplier</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0.9<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">tools:</span>ignore</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ContentDescription<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>android.support.v7.widget.Toolbar</span>  
                <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/toolbar<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>50dp<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>theme</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@style/ToolBarTheme<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">app:</span>layout_collapseMode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pin<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>android.support.design.widget.CollapsingToolbarLayout</span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>android.support.design.widget.AppBarLayout</span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>android.support.v4.widget.NestedScrollView</span>  
        <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/visibility_layout<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>fillViewport</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">app:</span>layout_behavior</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@string/appbar_scrolling_view_behavior<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ListView</span>  
            <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/list_MyPost<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ListView</span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>android.support.v4.widget.NestedScrollView</span><span class="token punctuation">></span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>android.support.design.widget.CoordinatorLayout</span><span class="token punctuation">></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>用户页面List子布局</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res/android<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">xmlns:</span>app</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res-auto<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>100dp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ImageView</span>  
        <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/imageViewMyPost<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>100dp<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">app:</span>srcCompat</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@color/Blue<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
        <span class="token attr-name"><span class="token namespace">android:</span>orientation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>horizontal<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>orientation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>vertical<span class="token punctuation">"</span></span>  
            <span class="token attr-name"><span class="token namespace">android:</span>weightSum</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextView</span>  
                <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/textViewTitle<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>50dp<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>gravity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>center_horizontal<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>TextView<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span>  
                <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>  
                <span class="token attr-name"><span class="token namespace">android:</span>orientation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>horizontal<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextView</span>  
                    <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/textViewContent<span class="token punctuation">"</span></span>  
                    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
                    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>  
                    <span class="token attr-name"><span class="token namespace">android:</span>layout_weight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>  
                    <span class="token attr-name"><span class="token namespace">android:</span>gravity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>center_horizontal<span class="token punctuation">"</span></span>  
                    <span class="token attr-name"><span class="token namespace">android:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>TextView<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">></span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">></span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
</li>
</ol>
<h2 id="地图"><a href="#地图" class="headerlink" title="地图"></a>地图</h2><p>借助高德地图API开发包，参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_38436214/article/details/111628025?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522164247700616780255218519%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=164247700616780255218519&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~hot_rank-1-111628025.pc_search_result_control_group&utm_term=android%E9%AB%98%E5%BE%B7%E5%9C%B0%E5%9B%BE&spm=1018.2226.3001.4187">博客</a></p>
<ol>
<li><p>该模块借助高德地图开发包，实现APP内嵌地图和定位，查找地区等功能。</p>
<p>进入活动后，首先请求获取<strong>相应权限</strong>，获取成功后，调用<strong>initLocation</strong>初始化位置以及调用<strong>initMap</strong>初始化地图，根据用户位置，调用<strong>updateMapCenter</strong>使得相机视角转到用户位置。同时设计<strong>短时点击和长按点击监听事件</strong>，优化用户体验。<strong>搜索地址</strong>实现原理是获取到输入的内容，搜索位置，得到经纬度，随后调用<strong>updateMapCenter</strong>使得视角转向地址。</p>
</li>
<li><p>核心代码</p>
</li>
</ol>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MapActivity</span> <span class="token keyword">extends</span> <span class="token class-name">AppCompatActivity</span> <span class="token keyword">implements</span>  
        <span class="token class-name">AMapLocationListener</span><span class="token punctuation">,</span> <span class="token class-name">LocationSource</span><span class="token punctuation">,</span>  
        <span class="token class-name">PoiSearch<span class="token punctuation">.</span>OnPoiSearchListener</span><span class="token punctuation">,</span> <span class="token class-name">AMap<span class="token punctuation">.</span>OnMapClickListener</span><span class="token punctuation">,</span> <span class="token class-name">AMap<span class="token punctuation">.</span>OnMapLongClickListener</span><span class="token punctuation">,</span>  
        <span class="token class-name">GeocodeSearch<span class="token punctuation">.</span>OnGeocodeSearchListener</span><span class="token punctuation">,</span> <span class="token class-name">EditText<span class="token punctuation">.</span>OnKeyListener</span> <span class="token punctuation">&#123;</span>  
    <span class="token comment">//输入框  </span>
    <span class="token keyword">private</span> <span class="token class-name">EditText</span> etAddress<span class="token punctuation">;</span>  
    <span class="token comment">//城市  </span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> city<span class="token punctuation">;</span>  
    <span class="token comment">//地理编码搜索  </span>
    <span class="token keyword">private</span> <span class="token class-name">GeocodeSearch</span> geocodeSearch<span class="token punctuation">;</span>  
    <span class="token comment">//解析成功标识码  </span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> PARSE_SUCCESS_CODE <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>  
    <span class="token comment">//POI查询对象  </span>
    <span class="token keyword">private</span> <span class="token class-name">PoiSearch<span class="token punctuation">.</span>Query</span> query<span class="token punctuation">;</span>  
    <span class="token comment">//POI搜索对象  </span>
    <span class="token keyword">private</span> <span class="token class-name">PoiSearch</span> poiSearch<span class="token punctuation">;</span>  
    <span class="token comment">//城市码  </span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> cityCode <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
    <span class="token comment">//浮动按钮  </span>
    <span class="token keyword">private</span> <span class="token class-name">FloatingActionButton</span> fabPOI<span class="token punctuation">;</span>  
    <span class="token comment">//定义一个UiSettings对象  </span>
    <span class="token keyword">private</span> <span class="token class-name">UiSettings</span> mUiSettings<span class="token punctuation">;</span>  
    <span class="token comment">//定位样式  </span>
    <span class="token keyword">private</span> <span class="token class-name">MyLocationStyle</span> myLocationStyle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyLocationStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token comment">//地图控制器  </span>
    <span class="token keyword">private</span> <span class="token class-name">AMap</span> aMap <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
    <span class="token comment">//位置更改监听  </span>
    <span class="token keyword">private</span> <span class="token class-name">OnLocationChangedListener</span> mListener<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">MapView</span> mapView<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> REQUEST_PERMISSIONS <span class="token operator">=</span> <span class="token number">9527</span><span class="token punctuation">;</span>  
    <span class="token comment">//声明AMapLocationClient类对象  </span>
    <span class="token keyword">public</span> <span class="token class-name">AMapLocationClient</span> mLocationClient <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
    <span class="token comment">//声明AMapLocationClientOption对象  </span>
    <span class="token keyword">public</span> <span class="token class-name">AMapLocationClientOption</span> mLocationOption <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">Toolbar</span> toolbar<span class="token punctuation">;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">setContentView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_map<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">ServiceSettings</span><span class="token punctuation">.</span><span class="token function">updatePrivacyShow</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">ServiceSettings</span><span class="token punctuation">.</span><span class="token function">updatePrivacyAgree</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        toolbar <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Toolbar</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>toolbarMap<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        toolbar<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">"地图"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">setSupportActionBar</span><span class="token punctuation">(</span>toolbar<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token comment">//        toolbar.setNavigationIcon(R.drawable.ic_action_n);  </span>
        <span class="token function">getSupportActionBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setDisplayHomeAsUpEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//左侧添加一个默认的返回图标  </span>
        <span class="token function">getSupportActionBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setHomeButtonEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置返回键可用  </span>
        toolbar<span class="token punctuation">.</span><span class="token function">setNavigationOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token annotation punctuation">@Override</span>  
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        fabPOI <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">FloatingActionButton</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>fab_poi<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        etAddress <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">EditText</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>et_address<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        etAddress<span class="token punctuation">.</span><span class="token function">setOnKeyListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        mapView <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">MapView</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>map_view<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        mapView<span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">initLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>  
            <span class="token function">initMap</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">AMapException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
        <span class="token function">checkingAndroidVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token comment">/** 
     * 检查Android版本 
     */</span>  
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">checkingAndroidVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Build</span><span class="token punctuation">.</span>VERSION<span class="token punctuation">.</span>SDK_INT <span class="token operator">>=</span> <span class="token class-name">Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>M</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token comment">//Android6.0及以上先获取权限再定位  </span>
            <span class="token function">requestPermission</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  
            <span class="token comment">//Android6.0以下直接定位  </span>
            mLocationClient<span class="token punctuation">.</span><span class="token function">startLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token annotation punctuation">@AfterPermissionGranted</span><span class="token punctuation">(</span>REQUEST_PERMISSIONS<span class="token punctuation">)</span>  
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">requestPermission</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> permissions <span class="token operator">=</span> <span class="token punctuation">&#123;</span>  
                <span class="token class-name">Manifest</span><span class="token punctuation">.</span>permission<span class="token punctuation">.</span>ACCESS_COARSE_LOCATION<span class="token punctuation">,</span>  
                <span class="token class-name">Manifest</span><span class="token punctuation">.</span>permission<span class="token punctuation">.</span>ACCESS_FINE_LOCATION<span class="token punctuation">,</span>  
                <span class="token class-name">Manifest</span><span class="token punctuation">.</span>permission<span class="token punctuation">.</span>READ_PHONE_STATE<span class="token punctuation">,</span>  
                <span class="token class-name">Manifest</span><span class="token punctuation">.</span>permission<span class="token punctuation">.</span>WRITE_EXTERNAL_STORAGE  
        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">EasyPermissions</span><span class="token punctuation">.</span><span class="token function">hasPermissions</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> permissions<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token comment">//true 有权限 开始定位  </span>
            <span class="token function">showMsg</span><span class="token punctuation">(</span><span class="token string">"已获得权限，可以定位啦！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            mLocationClient<span class="token punctuation">.</span><span class="token function">startLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  
            <span class="token comment">//false 无权限  </span>
            <span class="token class-name">EasyPermissions</span><span class="token punctuation">.</span><span class="token function">requestPermissions</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">"需要权限"</span><span class="token punctuation">,</span> REQUEST_PERMISSIONS<span class="token punctuation">,</span> permissions<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token comment">/** 
     * 请求权限结果 
     * 
     * @param requestCode 
     * @param permissions 
     * @param grantResults 
     */</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onRequestPermissionsResult</span><span class="token punctuation">(</span><span class="token keyword">int</span> requestCode<span class="token punctuation">,</span> <span class="token annotation punctuation">@NonNull</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> permissions<span class="token punctuation">,</span> <span class="token annotation punctuation">@NonNull</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> grantResults<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onRequestPermissionsResult</span><span class="token punctuation">(</span>requestCode<span class="token punctuation">,</span> permissions<span class="token punctuation">,</span> grantResults<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//设置权限请求结果  </span>
        <span class="token class-name">EasyPermissions</span><span class="token punctuation">.</span><span class="token function">onRequestPermissionsResult</span><span class="token punctuation">(</span>requestCode<span class="token punctuation">,</span> permissions<span class="token punctuation">,</span> grantResults<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token comment">/** 
     * 初始化定位 
     */</span>  
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">initLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token comment">//初始化定位  </span>
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>  
            mLocationClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AMapLocationClient</span><span class="token punctuation">(</span><span class="token function">getApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
        <span class="token comment">//设置定位回调监听  </span>
        mLocationClient<span class="token punctuation">.</span><span class="token function">setLocationListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//初始化AMapLocationClientOption对象  </span>
        mLocationOption <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AMapLocationClientOption</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//设置定位模式为AMapLocationMode.Hight_Accuracy，高精度模式。  </span>
        mLocationOption<span class="token punctuation">.</span><span class="token function">setLocationMode</span><span class="token punctuation">(</span><span class="token class-name">AMapLocationClientOption<span class="token punctuation">.</span>AMapLocationMode<span class="token punctuation">.</span>Hight_Accuracy</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//获取最近3s内精度最高的一次定位结果：  </span>
        <span class="token comment">//设置setOnceLocationLatest(boolean b)接口为true，启动定位时SDK会返回最近3s内精度最高的一次定位结果。如果设置其为true，setOnceLocation(boolean b)接口也会被设置为true，反之不会，默认为false。  </span>
        mLocationOption<span class="token punctuation">.</span><span class="token function">setOnceLocationLatest</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//设置是否返回地址信息（默认返回地址信息）  </span>
        mLocationOption<span class="token punctuation">.</span><span class="token function">setNeedAddress</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//设置定位请求超时时间，单位是毫秒，默认30000毫秒，建议超时时间不要低于8000毫秒。  </span>
        mLocationOption<span class="token punctuation">.</span><span class="token function">setHttpTimeOut</span><span class="token punctuation">(</span><span class="token number">20000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//关闭缓存机制，高精度定位会产生缓存。  </span>
        mLocationOption<span class="token punctuation">.</span><span class="token function">setLocationCacheEnable</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//给定位客户端对象设置定位参数  </span>
        mLocationClient<span class="token punctuation">.</span><span class="token function">setLocationOption</span><span class="token punctuation">(</span>mLocationOption<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">showMsg</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">MapActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> s<span class="token punctuation">,</span> <span class="token class-name">Toast</span><span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onLocationChanged</span><span class="token punctuation">(</span><span class="token class-name">AMapLocation</span> aMapLocation<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>aMapLocation <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token keyword">if</span> <span class="token punctuation">(</span>aMapLocation<span class="token punctuation">.</span><span class="token function">getErrorCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token comment">//地址  </span>
                <span class="token class-name">String</span> address <span class="token operator">=</span> aMapLocation<span class="token punctuation">.</span><span class="token function">getAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token keyword">double</span> latitude <span class="token operator">=</span> aMapLocation<span class="token punctuation">.</span><span class="token function">getLatitude</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token keyword">double</span> longitude <span class="token operator">=</span> aMapLocation<span class="token punctuation">.</span><span class="token function">getLongitude</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token class-name">StringBuffer</span> stringBuffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                stringBuffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"纬度："</span> <span class="token operator">+</span> latitude <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                stringBuffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"经度："</span> <span class="token operator">+</span> longitude <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                stringBuffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"地址："</span> <span class="token operator">+</span> address <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"MapActivity:"</span><span class="token punctuation">,</span> stringBuffer<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token keyword">if</span> <span class="token punctuation">(</span>mListener <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                    mListener<span class="token punctuation">.</span><span class="token function">onLocationChanged</span><span class="token punctuation">(</span>aMapLocation<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token punctuation">&#125;</span>  
                mLocationClient<span class="token punctuation">.</span><span class="token function">stopLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token comment">//显示浮空按钮  </span>
                fabPOI<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token comment">//赋值  </span>
                cityCode <span class="token operator">=</span> aMapLocation<span class="token punctuation">.</span><span class="token function">getCityCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token comment">//城市赋值  </span>
                city <span class="token operator">=</span> aMapLocation<span class="token punctuation">.</span><span class="token function">getCity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token function">updateMapCenter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LatLng</span><span class="token punctuation">(</span>latitude<span class="token punctuation">,</span> longitude<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  
                <span class="token comment">//定位失败时，可通过ErrCode（错误码）信息来确定失败的原因，errInfo是错误信息，详见错误码表。  </span>
                <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">"AmapError"</span><span class="token punctuation">,</span> <span class="token string">"location Error, ErrCode:"</span>  
                        <span class="token operator">+</span> aMapLocation<span class="token punctuation">.</span><span class="token function">getErrorCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", errInfo:"</span>  
                        <span class="token operator">+</span> aMapLocation<span class="token punctuation">.</span><span class="token function">getErrorInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//销毁定位客户端，同时销毁本地定位服务。  </span>
        mLocationClient<span class="token punctuation">.</span><span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onResume</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onResume</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//在activity执行onResume时执行mMapView.onResume ()，重新绘制加载地图  </span>
        mapView<span class="token punctuation">.</span><span class="token function">onResume</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onPause</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onPause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//在activity执行onPause时执行mMapView.onPause ()，暂停地图的绘制  </span>
        mapView<span class="token punctuation">.</span><span class="token function">onPause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onSaveInstanceState</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> outState<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onSaveInstanceState</span><span class="token punctuation">(</span>outState<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//在activity执行onSaveInstanceState时执行mMapView.onSaveInstanceState (outState)，保存地图当前的状态  </span>
        mapView<span class="token punctuation">.</span><span class="token function">onSaveInstanceState</span><span class="token punctuation">(</span>outState<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token comment">/** 
     * 初始化地图 
     * 
     * @param savedInstanceState 
     */</span>  
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">initMap</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">AMapException</span> <span class="token punctuation">&#123;</span>  
        mapView <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">MapView</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>map_view<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//在activity执行onCreate时执行mMapView.onCreate(savedInstanceState)，创建地图  </span>
        mapView<span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//初始化地图控制器对象  </span>
        aMap <span class="token operator">=</span> mapView<span class="token punctuation">.</span><span class="token function">getMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//设置最小缩放等级为16 ，缩放级别范围为[3, 20]  </span>
        aMap<span class="token punctuation">.</span><span class="token function">setMinZoomLevel</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//开启室内地图  </span>
        aMap<span class="token punctuation">.</span><span class="token function">showIndoorMap</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        aMap<span class="token punctuation">.</span><span class="token function">setOnMapClickListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        aMap<span class="token punctuation">.</span><span class="token function">setOnMapLongClickListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">// 自定义精度范围的圆形边框颜色  都为0则透明  </span>
        myLocationStyle<span class="token punctuation">.</span><span class="token function">strokeColor</span><span class="token punctuation">(</span><span class="token class-name">Color</span><span class="token punctuation">.</span><span class="token function">argb</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">// 自定义精度范围的圆形边框宽度  0 无宽度  </span>
        myLocationStyle<span class="token punctuation">.</span><span class="token function">strokeWidth</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">// 设置圆形的填充颜色  都为0则透明  </span>
        myLocationStyle<span class="token punctuation">.</span><span class="token function">radiusFillColor</span><span class="token punctuation">(</span><span class="token class-name">Color</span><span class="token punctuation">.</span><span class="token function">argb</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//设置定位蓝点的Style  </span>
        aMap<span class="token punctuation">.</span><span class="token function">setMyLocationStyle</span><span class="token punctuation">(</span>myLocationStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">// 设置定位监听  </span>
        aMap<span class="token punctuation">.</span><span class="token function">setLocationSource</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">// 设置为true表示显示定位层并可触发定位，false表示隐藏定位层并不可触发定位，默认是false  </span>
        aMap<span class="token punctuation">.</span><span class="token function">setMyLocationEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//实例化UiSettings类对象  </span>
        mUiSettings <span class="token operator">=</span> aMap<span class="token punctuation">.</span><span class="token function">getUiSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//隐藏缩放按钮  </span>
        mUiSettings<span class="token punctuation">.</span><span class="token function">setZoomControlsEnabled</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//显示比例尺 默认不显示  </span>
        mUiSettings<span class="token punctuation">.</span><span class="token function">setScaleControlsEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//构建GeocodeSearch对象  </span>
        geocodeSearch <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GeocodeSearch</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        geocodeSearch<span class="token punctuation">.</span><span class="token function">setOnGeocodeSearchListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
  
    <span class="token comment">/** 
     * 通过经纬度获取地址 
     * 
     * @param latLng 
     */</span>  
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">latlonToAddress</span><span class="token punctuation">(</span><span class="token class-name">LatLng</span> latLng<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token comment">//位置点  通过经纬度进行构建  </span>
        <span class="token class-name">LatLonPoint</span> latLonPoint <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LatLonPoint</span><span class="token punctuation">(</span>latLng<span class="token punctuation">.</span>latitude<span class="token punctuation">,</span> latLng<span class="token punctuation">.</span>longitude<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//逆编码查询  第一个参数表示一个Latlng，第二参数表示范围多少米，第三个参数表示是火系坐标系还是GPS原生坐标系  </span>
        <span class="token class-name">RegeocodeQuery</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegeocodeQuery</span><span class="token punctuation">(</span>latLonPoint<span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token class-name">GeocodeSearch</span><span class="token punctuation">.</span>AMAP<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//异步获取地址信息  </span>
        geocodeSearch<span class="token punctuation">.</span><span class="token function">getFromLocationAsyn</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">activate</span><span class="token punctuation">(</span><span class="token class-name">OnLocationChangedListener</span> onLocationChangedListener<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        mListener <span class="token operator">=</span> onLocationChangedListener<span class="token punctuation">;</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>mLocationClient <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            mLocationClient<span class="token punctuation">.</span><span class="token function">startLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//启动定位  </span>
        <span class="token punctuation">&#125;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deactivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        mListener <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>mLocationClient <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            mLocationClient<span class="token punctuation">.</span><span class="token function">stopLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            mLocationClient<span class="token punctuation">.</span><span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
        mLocationClient <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token comment">/** 
     * 浮动按钮点击查询附近POI 
     * 
     * @param view 
     */</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">queryPOI</span><span class="token punctuation">(</span><span class="token class-name">View</span> view<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">AMapException</span> <span class="token punctuation">&#123;</span>  
        <span class="token comment">//构造query对象  </span>
        query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PoiSearch<span class="token punctuation">.</span>Query</span><span class="token punctuation">(</span><span class="token string">"购物"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> cityCode<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">// 设置每页最多返回多少条poiitem  </span>
        query<span class="token punctuation">.</span><span class="token function">setPageSize</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//设置查询页码  </span>
        query<span class="token punctuation">.</span><span class="token function">setPageNum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//构造 PoiSearch 对象  </span>
        poiSearch <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PoiSearch</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> query<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//设置搜索回调监听  </span>
        poiSearch<span class="token punctuation">.</span><span class="token function">setOnPoiSearchListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//发起搜索附近POI异步请求  </span>
        poiSearch<span class="token punctuation">.</span><span class="token function">searchPOIAsyn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onPoiSearched</span><span class="token punctuation">(</span><span class="token class-name">PoiResult</span> poiResult<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token comment">//解析result获取POI信息  </span>
        <span class="token comment">//获取POI组数列表  </span>
        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PoiItem</span><span class="token punctuation">></span></span> poiItems <span class="token operator">=</span> poiResult<span class="token punctuation">.</span><span class="token function">getPois</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">PoiItem</span> poiItem <span class="token operator">:</span> poiItems<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"MainActivity"</span><span class="token punctuation">,</span> <span class="token string">" Title："</span> <span class="token operator">+</span> poiItem<span class="token punctuation">.</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" Snippet："</span> <span class="token operator">+</span> poiItem<span class="token punctuation">.</span><span class="token function">getSnippet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onPoiItemSearched</span><span class="token punctuation">(</span><span class="token class-name">PoiItem</span> poiItem<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
  
    <span class="token punctuation">&#125;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onMapClick</span><span class="token punctuation">(</span><span class="token class-name">LatLng</span> latLng<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token function">showMsg</span><span class="token punctuation">(</span><span class="token string">"点击了地图，经度："</span> <span class="token operator">+</span> latLng<span class="token punctuation">.</span>longitude <span class="token operator">+</span> <span class="token string">"，纬度："</span> <span class="token operator">+</span> latLng<span class="token punctuation">.</span>latitude<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">latlonToAddress</span><span class="token punctuation">(</span>latLng<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">updateMapCenter</span><span class="token punctuation">(</span>latLng<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onMapLongClick</span><span class="token punctuation">(</span><span class="token class-name">LatLng</span> latLng<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token function">showMsg</span><span class="token punctuation">(</span><span class="token string">"长按了地图，经度："</span> <span class="token operator">+</span> latLng<span class="token punctuation">.</span>longitude <span class="token operator">+</span> <span class="token string">"，纬度："</span> <span class="token operator">+</span> latLng<span class="token punctuation">.</span>latitude<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">latlonToAddress</span><span class="token punctuation">(</span>latLng<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onRegeocodeSearched</span><span class="token punctuation">(</span><span class="token class-name">RegeocodeResult</span> regeocodeResult<span class="token punctuation">,</span> <span class="token keyword">int</span> rCode<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token comment">//解析result获取地址描述信息  </span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>rCode <span class="token operator">==</span> PARSE_SUCCESS_CODE<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token class-name">RegeocodeAddress</span> regeocodeAddress <span class="token operator">=</span> regeocodeResult<span class="token punctuation">.</span><span class="token function">getRegeocodeAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token comment">//显示解析后的地址  </span>
            <span class="token function">showMsg</span><span class="token punctuation">(</span><span class="token string">"地址："</span> <span class="token operator">+</span> regeocodeAddress<span class="token punctuation">.</span><span class="token function">getFormatAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  
            <span class="token function">showMsg</span><span class="token punctuation">(</span><span class="token string">"获取地址失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
    <span class="token punctuation">&#125;</span>  
  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onGeocodeSearched</span><span class="token punctuation">(</span><span class="token class-name">GeocodeResult</span> geocodeResult<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> PARSE_SUCCESS_CODE<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GeocodeAddress</span><span class="token punctuation">></span></span> geocodeAddressList <span class="token operator">=</span> geocodeResult<span class="token punctuation">.</span><span class="token function">getGeocodeAddressList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token keyword">if</span> <span class="token punctuation">(</span>geocodeAddressList <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> geocodeAddressList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token class-name">LatLonPoint</span> latLonPoint <span class="token operator">=</span> geocodeAddressList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLatLonPoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token comment">//显示解析后的坐标  </span>
                <span class="token function">showMsg</span><span class="token punctuation">(</span><span class="token string">"坐标csac："</span> <span class="token operator">+</span> latLonPoint<span class="token punctuation">.</span><span class="token function">getLongitude</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"，"</span> <span class="token operator">+</span> latLonPoint<span class="token punctuation">.</span><span class="token function">getLatitude</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token class-name">LatLng</span> latLng <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LatLng</span><span class="token punctuation">(</span>latLonPoint<span class="token punctuation">.</span><span class="token function">getLatitude</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> latLonPoint<span class="token punctuation">.</span><span class="token function">getLongitude</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token function">updateMapCenter</span><span class="token punctuation">(</span>latLng<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  
            <span class="token function">showMsg</span><span class="token punctuation">(</span><span class="token string">"获取坐标失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">onKey</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">,</span> <span class="token keyword">int</span> keyCode<span class="token punctuation">,</span> <span class="token class-name">KeyEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>keyCode <span class="token operator">==</span> <span class="token class-name">KeyEvent</span><span class="token punctuation">.</span>KEYCODE_ENTER <span class="token operator">&amp;&amp;</span> event<span class="token punctuation">.</span><span class="token function">getAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">KeyEvent</span><span class="token punctuation">.</span>ACTION_UP<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token comment">//获取输入框的值  </span>
            <span class="token class-name">String</span> address <span class="token operator">=</span> etAddress<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token keyword">if</span> <span class="token punctuation">(</span>address <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> address<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token function">showMsg</span><span class="token punctuation">(</span><span class="token string">"请输入地址"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  
                <span class="token class-name">InputMethodManager</span> imm <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">InputMethodManager</span><span class="token punctuation">)</span> <span class="token function">getSystemService</span><span class="token punctuation">(</span><span class="token class-name">Context</span><span class="token punctuation">.</span>INPUT_METHOD_SERVICE<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token comment">//隐藏软键盘  </span>
                imm<span class="token punctuation">.</span><span class="token function">hideSoftInputFromWindow</span><span class="token punctuation">(</span><span class="token function">getWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDecorView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getWindowToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token comment">// name表示地址，第二个参数表示查询城市，中文或者中文全拼，citycode、adcode  </span>
                <span class="token class-name">GeocodeQuery</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GeocodeQuery</span><span class="token punctuation">(</span>address<span class="token punctuation">,</span> city<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                geocodeSearch<span class="token punctuation">.</span><span class="token function">getFromLocationNameAsyn</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span>  
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token comment">/** 
     * 改变地图中心位置 
     * 
     * @param latLng 位置 
     */</span>  
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">updateMapCenter</span><span class="token punctuation">(</span><span class="token class-name">LatLng</span> latLng<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token comment">// CameraPosition 第一个参数： 目标位置的屏幕中心点经纬度坐标。  </span>
        <span class="token comment">// CameraPosition 第二个参数： 目标可视区域的缩放级别  </span>
        <span class="token comment">// CameraPosition 第三个参数： 目标可视区域的倾斜度，以角度为单位。  </span>
        <span class="token comment">// CameraPosition 第四个参数： 可视区域指向的方向，以角度为单位，从正北向顺时针方向计算，从0度到360度  </span>
<span class="token class-name">Da</span> 
        <span class="token comment">//位置变更  </span>
        <span class="token class-name">CameraUpdate</span> cameraUpdate <span class="token operator">=</span> <span class="token class-name">CameraUpdateFactory</span><span class="token punctuation">.</span><span class="token function">newCameraPosition</span><span class="token punctuation">(</span>cameraPosition<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//改变位置  </span>
        aMap<span class="token punctuation">.</span><span class="token function">animateCamera</span><span class="token punctuation">(</span>cameraUpdate<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
<span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="更新帖子"><a href="#更新帖子" class="headerlink" title="更新帖子"></a>更新帖子</h2><ol>
<li><p>该模块实现更新修改用户已经发布的帖子。</p>
</li>
<li><p>核心代码</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UpdataPost</span> <span class="token keyword">extends</span> <span class="token class-name">AppCompatActivity</span> <span class="token punctuation">&#123;</span>  
    <span class="token keyword">private</span> <span class="token class-name">ImageView</span> imageView<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">EditText</span> editText1<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">EditText</span> editText2<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">EditText</span> editText3<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">Toolbar</span> toolbar<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">Button</span> button<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">Connection</span> connection<span class="token punctuation">;</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">setContentView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_updata_post<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        imageView <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ImageView</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>imageUp<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        editText1  <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">EditText</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>upAuthor<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        editText2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">EditText</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>uptitle<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        editText3 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">EditText</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>upcontent<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">Intent</span> intent <span class="token operator">=</span> <span class="token function">getIntent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">String</span> title <span class="token operator">=</span> intent<span class="token punctuation">.</span><span class="token function">getStringExtra</span><span class="token punctuation">(</span><span class="token string">"title"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">final</span> <span class="token class-name">String</span> content <span class="token operator">=</span> intent<span class="token punctuation">.</span><span class="token function">getStringExtra</span><span class="token punctuation">(</span><span class="token string">"content"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        editText2<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        editText3<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        button <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Button</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>buttonUp<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        button<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token annotation punctuation">@Override</span>  
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                    <span class="token annotation punctuation">@Override</span>  
                    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                        <span class="token keyword">try</span><span class="token punctuation">&#123;</span>  
                           connection <span class="token operator">=</span> <span class="token class-name">MySQLConnections</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"blog"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            <span class="token class-name">String</span> title1 <span class="token operator">=</span> editText2<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            <span class="token class-name">String</span> content1 <span class="token operator">=</span> editText3<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"update Blog set title='"</span><span class="token operator">+</span>title1<span class="token operator">+</span><span class="token string">"' where content='"</span><span class="token operator">+</span>content<span class="token operator">+</span><span class="token string">"'"</span><span class="token punctuation">;</span>  
                            <span class="token class-name">PreparedStatement</span> pst<span class="token punctuation">;</span>  
                            pst <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            pst<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            sql <span class="token operator">=</span> <span class="token string">"update Blog set content='"</span><span class="token operator">+</span>content1<span class="token operator">+</span><span class="token string">"' where title='"</span><span class="token operator">+</span>title1<span class="token operator">+</span><span class="token string">"'"</span><span class="token punctuation">;</span>  
                            pst<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        <span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  
                            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        <span class="token punctuation">&#125;</span>  
                    <span class="token punctuation">&#125;</span>  
                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
<span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<h2 id="数据库设计"><a href="#数据库设计" class="headerlink" title="数据库设计"></a>数据库设计</h2><ol>
<li><p><code>News</code></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">News</span> <span class="token punctuation">&#123;</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> title<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> content<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> author<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> image<span class="token punctuation">;</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">return</span> title<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token class-name">String</span> title<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> title<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">return</span> content<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setContent</span><span class="token punctuation">(</span><span class="token class-name">String</span> content<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> content<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">return</span> id<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getAuthor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">return</span> author<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAuthor</span><span class="token punctuation">(</span><span class="token class-name">String</span> author<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>author <span class="token operator">=</span> author<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getImage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">return</span> image<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setImage</span><span class="token punctuation">(</span><span class="token class-name">String</span> image<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>image <span class="token operator">=</span> image<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
<span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p><code>MyPost</code></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyPost</span> <span class="token keyword">extends</span> <span class="token class-name">DataSupport</span> <span class="token punctuation">&#123;</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> newstitle<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> newscontent<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> imagePost<span class="token punctuation">;</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getNewstitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">return</span> newstitle<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setNewstitle</span><span class="token punctuation">(</span><span class="token class-name">String</span> newstitle<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>newstitle <span class="token operator">=</span> newstitle<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">return</span> username<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>username <span class="token operator">=</span> username<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getNewscontent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">return</span> newscontent<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setNewscontent</span><span class="token punctuation">(</span><span class="token class-name">String</span> newscontent<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>newscontent <span class="token operator">=</span> newscontent<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getImagePost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">return</span> imagePost<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setImagePost</span><span class="token punctuation">(</span><span class="token class-name">String</span> imagePost<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>imagePost <span class="token operator">=</span> imagePost<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
 <span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p><code>User</code></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">DataSupport</span> <span class="token punctuation">&#123;</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> image<span class="token punctuation">;</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">return</span> name<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">return</span> password<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>password <span class="token operator">=</span> password<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getImage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">return</span> image<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setImage</span><span class="token punctuation">(</span><span class="token class-name">String</span> image<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>image <span class="token operator">=</span> image<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
<span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<h2 id="工具包类"><a href="#工具包类" class="headerlink" title="工具包类"></a>工具包类</h2><ol>
<li><p><code>ImageHelper</code></p>
<ul>
<li> 实现Bitmap和String的转换</li>
</ul>
  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ImageHelper</span> <span class="token punctuation">&#123;</span>  
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Bitmap</span> <span class="token function">stringToBitmap</span><span class="token punctuation">(</span><span class="token class-name">String</span> string<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token comment">// 将字符串转换成Bitmap类型  </span>
        <span class="token class-name">Bitmap</span> bitmap <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>  
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bitmapArray<span class="token punctuation">;</span>  
            bitmapArray <span class="token operator">=</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>string<span class="token punctuation">,</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            bitmap <span class="token operator">=</span> <span class="token class-name">BitmapFactory</span><span class="token punctuation">.</span><span class="token function">decodeByteArray</span><span class="token punctuation">(</span>bitmapArray<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>  
                    bitmapArray<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
        <span class="token keyword">return</span> bitmap<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token comment">//把bitmap转换成字符串  </span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">bitmapToString</span><span class="token punctuation">(</span><span class="token class-name">Bitmap</span> bitmap<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token class-name">String</span> string <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
        <span class="token class-name">ByteArrayOutputStream</span> btString <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        bitmap<span class="token punctuation">.</span><span class="token function">compress</span><span class="token punctuation">(</span><span class="token class-name">Bitmap<span class="token punctuation">.</span>CompressFormat</span><span class="token punctuation">.</span>JPEG<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> btString<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> btString<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        string <span class="token operator">=</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">encodeToString</span><span class="token punctuation">(</span>bytes<span class="token punctuation">,</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> string<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
<span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p><code>MySQLConnection</code></p>
<ul>
<li> 实现服务器数据库的连接以及数据库的操作(导入MySqlConnector包)。</li>
</ul>
  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MySQLConnections</span> <span class="token punctuation">&#123;</span>  
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> number <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> driver <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> dbURL <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> user <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> password <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">MySQLConnections</span> connection <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Connection</span> conn <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">PreparedStatement</span> stmt <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">News</span><span class="token punctuation">></span></span>newsList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">News</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">MySQLConnections</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>  
        driver <span class="token operator">=</span> <span class="token string">"com.mysql.jdbc.Driver"</span><span class="token punctuation">;</span>  
        dbURL <span class="token operator">=</span> <span class="token string">"jdbc:mysql://182.92.153.231:3306/blog"</span><span class="token punctuation">;</span>  
        user <span class="token operator">=</span> <span class="token string">"lkk"</span><span class="token punctuation">;</span>  
        password <span class="token operator">=</span> <span class="token string">"123456"</span><span class="token punctuation">;</span>  
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"dbURL:"</span> <span class="token operator">+</span> dbURL<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Connection</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token class-name">String</span> dbName<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
        <span class="token class-name">Connection</span> conn <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>connection <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>  
                connection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MySQLConnections</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span>  
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>  
            <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>connection<span class="token punctuation">.</span>driver<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            conn <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>connection<span class="token punctuation">.</span>dbURL<span class="token punctuation">,</span>  
                    connection<span class="token punctuation">.</span>user<span class="token punctuation">,</span> connection<span class="token punctuation">.</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">&#125;</span>  
        <span class="token keyword">return</span> conn<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">insertIntoData</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token keyword">int</span> id<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token class-name">String</span> author<span class="token punctuation">,</span><span class="token keyword">final</span> <span class="token class-name">String</span> title<span class="token punctuation">,</span><span class="token keyword">final</span> <span class="token class-name">String</span> content<span class="token punctuation">,</span><span class="token class-name">String</span> image<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">&#123;</span><span class="token comment">//增加数据  </span>
        <span class="token class-name">Connection</span>  conn <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
        conn <span class="token operator">=</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"blog"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//填写需要连接的数据库的名称，我是用的是person  </span>
        <span class="token comment">//使用DriverManager获取数据库连接  </span>
        <span class="token class-name">Statement</span> stmt <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//使用Connection来创建一个Statment对象  </span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"insert INTO Blog (id,author,title,content,image)VALUES('"</span><span class="token operator">+</span>id<span class="token operator">+</span><span class="token string">"','"</span><span class="token operator">+</span>author<span class="token operator">+</span><span class="token string">"','"</span><span class="token operator">+</span>title<span class="token operator">+</span><span class="token string">"','"</span><span class="token operator">+</span>content<span class="token operator">+</span><span class="token string">"','"</span><span class="token operator">+</span>image<span class="token operator">+</span><span class="token string">"')"</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> stmt<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//返回的同时执行sql语句，返回受影响的条目数量，一般不作处理  </span>
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">News</span><span class="token punctuation">></span></span> <span class="token function">querycol</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">&#123;</span><span class="token comment">//读取某一行  </span>
        <span class="token comment">//加载数据库驱动  </span>
        <span class="token keyword">final</span> <span class="token class-name">Handler</span> handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Handler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Handler<span class="token punctuation">.</span>Callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token annotation punctuation">@Override</span>  
            <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">handleMessage</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token comment">//下一步执行的代码  </span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>  
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
            <span class="token annotation punctuation">@Override</span>  
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                <span class="token class-name">Message</span> msg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//message用于给handler传递参数  </span>
                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>  
                    <span class="token comment">//调用连接数据库方法的代码  </span>
                    conn <span class="token operator">=</span> <span class="token class-name">MySQLConnections</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"Blog"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"TAG"</span><span class="token punctuation">,</span> <span class="token string">" 数据操作异常"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token punctuation">&#125;</span>handler<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>  
                    <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"select * from Blog"</span><span class="token punctuation">;</span>  
                    <span class="token keyword">if</span><span class="token punctuation">(</span>conn <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  
                        stmt <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        conn<span class="token punctuation">.</span><span class="token function">setAutoCommit</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        <span class="token class-name">ResultSet</span> rs <span class="token operator">=</span>stmt<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//用rs接收sql语句返回的查询结果  </span>
                        <span class="token comment">//执行查询语句并且保存结果  </span>
                        <span class="token keyword">while</span> <span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  
                            <span class="token class-name">News</span> news <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">News</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            news<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            news<span class="token punctuation">.</span><span class="token function">setAuthor</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"author"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            news<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"title"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            news<span class="token punctuation">.</span><span class="token function">setContent</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"content"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            news<span class="token punctuation">.</span><span class="token function">setImage</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"image"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                            newsList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>news<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        <span class="token punctuation">&#125;</span>  
                        rs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token punctuation">&#125;</span>  
                    <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token punctuation">&#125;</span>  
            <span class="token punctuation">&#125;</span>  
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> newsList<span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">insertIntoUser</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">,</span> <span class="token class-name">String</span> image<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">&#123;</span>  
        <span class="token class-name">Connection</span>  conn <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
        conn <span class="token operator">=</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"blog"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//填写需要连接的数据库的名称，我是用的是person  </span>
        <span class="token comment">//使用DriverManager获取数据库连接  </span>
        <span class="token class-name">Statement</span> stmt <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">//使用Connection来创建一个Statment对象  </span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"insert INTO User (name,password,image)VALUES('"</span><span class="token operator">+</span>name<span class="token operator">+</span><span class="token string">"','"</span><span class="token operator">+</span>password<span class="token operator">+</span><span class="token string">"','"</span><span class="token operator">+</span>image<span class="token operator">+</span><span class="token string">"')"</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> stmt<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">&#125;</span>  
<span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<h1 id="项目Gitee"><a href="#项目Gitee" class="headerlink" title="项目Gitee"></a>项目Gitee</h1><ul>
<li>   地址：<a target="_blank" rel="noopener" href="https://gitee.com/lkksxxdxxd/android">https://gitee.com/lkksxxdxxd/android</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://keeganli.github.com/2021/11/12/ssm1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GaoMing">
      <meta itemprop="description" content="终身浪漫">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GaoMing's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/12/ssm1/" class="post-title-link" itemprop="url">ssm1</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-11-11 18:41:40 / 修改时间：10:43:31" itemprop="dateCreated datePublished" datetime="2021-11-11T18:41:40Z">2021-11-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ssm/" itemprop="url" rel="index"><span itemprop="name">ssm</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>title: ssm<br>date: 2021-05-20 21:05:15<br>tags: ssm<br>categories: ssm</p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p><code>ssm</code>全称<code>Spring</code>+<code>SpringMVC</code>+<code>MyBatis</code>，是目前比较主流的<code>Java EE</code>企业级框架，将整个系统划分为表现层，<code>controller</code>层，<code>service</code> 层，<code>DAO</code> 层四层。</p>
<ul>
<li>使用<code>spring MVC</code>负责<strong>请求的转发和视图管理</strong></li>
<li><code>spring</code>实现业务对象管理</li>
<li><code>mybatis</code>作为数据对象的持久化引擎</li>
</ul>
<h3 id="SpringMVC"><a href="#SpringMVC" class="headerlink" title="SpringMVC"></a><code>SpringMVC</code></h3><ol>
<li><p><code>SpringMVC</code>原理图</p>
<ul>
<li>客户端发送请求到 <code>DispacherServlet</code>（前端控制器即分发器），这里可以设置拦截器，对请求进行过滤处理；</li>
<li>由 <code>DispacherServlet </code>控制器查询 <code>HanderMapping</code>，通过解析请求，判断请求希望执行的具体方法，即找到处理请求的 Controller；</li>
<li>通过 <code>HandlerAdapter </code>调用具体的<code>Controller</code>方法；</li>
<li><code>Controller</code> 调用业务逻辑处理后，返回 <code>ModelAndView</code>，即控制器结果返回给视图解析器；</li>
<li><code>DispacherServlet</code> 查询视图解析器，找到<code>ModelAndView </code>指定的视图</li>
<li>视图负责将结果显示到客户端</li>
</ul>
<p><img src="/.com//Users\86176\AppData\Roaming\Typora\typora-user-images\image-20211111173745311.png" alt="image-20211111173745311"></p>
</li>
<li><p><code>SpringMVC</code>配置文件</p>
<ul>
<li><p>web.xml：在 中要配置前端控制器，springmvc 的配置文件位置、自启动、拦截器以及编码过滤器；</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">></span></span>SpringDispatcherServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">></span></span>org.springframework.web.servlet.DispatcherServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>init-param</span><span class="token punctuation">></span></span> <span class="token comment">&lt;!-- servlet 初始化参数配置 --></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">></span></span>contextConfigLocation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">></span></span>   <span class="token comment">&lt;!-- key --></span>
     <span class="token comment">&lt;!-- 引入spring配置文件 --></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">></span></span>classpath:spring/spring-*.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">></span></span> <span class="token comment">&lt;!-- val --></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>init-param</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">></span></span>SpringDispatcherServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">></span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">></span></span>
     <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>springmvc.xml ：配置扫描包，即项目中所有 controller 位置，配置注解驱动（一般使用注解），配置不要拦截静态资源、自定义视图解析器（就是前后缀，可以和 controller 的返回值相连接，构成完整的页面路径）；</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>context</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/context<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>mvc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/mvc<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans
	http://www.springframework.org/schema/beans/spring-beans.xsd
	http://www.springframework.org/schema/context
	http://www.springframework.org/schema/context/spring-context.xsd
	http://www.springframework.org/schema/mvc
	http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token comment">&lt;!-- 配置SpringMVC --></span>
    <span class="token comment">&lt;!-- 1.开启SpringMVC注解模式 --></span>
    <span class="token comment">&lt;!-- 简化配置：
        (1)自动注册DefaultAnootationHandlerMapping,AnotationMethodHandlerAdapter
        (2)提供一些列：数据绑定，数字和日期的format @NumberFormat, @DateTimeFormat, xml,json默认读写支持
    --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mvc:</span>annotation-driven</span> <span class="token punctuation">/></span></span>

    <span class="token comment">&lt;!-- 2.静态资源默认servlet配置
        (1)加入对静态资源的处理：js,gif,png
        (2)允许使用"/"做整体映射
     --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mvc:</span>default-servlet-handler</span><span class="token punctuation">/></span></span>

    <span class="token comment">&lt;!-- 3.配置jsp 显示ViewResolver --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.springframework.web.servlet.view.InternalResourceViewResolver<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewClass<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.springframework.web.servlet.view.JstlView<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>prefix<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/WEB-INF/jsp/<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>suffix<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>.jsp<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span>
    <span class="token comment">&lt;!-- 4.扫描web相关的bean --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>component-scan</span> <span class="token attr-name">base-package</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.ssm.controller<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
</li>
<li></li>
</ol>
<h3 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a><code>Spring</code></h3><ul>
<li><strong>可以装载bean（也就是我们Java中的类，当然也包括service dao里面的</strong>），有了这个机制，我们就不用在每次使用这个类的时候为它初始化，很少看到关键字new。另外spring的aop，事务管理等等都是我们经常用到的。</li>
</ul>
<h3 id="Mybatis"><a href="#Mybatis" class="headerlink" title="Mybatis"></a>Mybatis</h3><ul>
<li><code>Mybatis：mybatis</code>是对<code>jdbc</code>的封装，它让数据库底层操作变的透明。<code>mybatis</code>的操作都是围绕一个<code>sqlSessionFactory</code>实例展开的。<code>mybatis</code>通过配置文件关联到各实体类的Mapper文件，Mapper文件中配置了每个类对数据库所需进行的<code>sql</code>语句映射**。在每次与数据库交互时，通过<code>sqlSessionFactory</code>拿到一个<code>sqlSession</code>，再执行<code>sql</code>命令。</li>
<li><code>mybatis</code>通过配置文件创建<code>sqlsessionFactory</code>，<code>sqlsessionFactory</code>根据配置文件，配置文件来源于两个方面:一个是<code>xml</code>，一个是<code>Java</code>中的注解，获取<code>sqlSession</code>。<code>SQLSession</code>包含了执行<code>sql</code>语句的所有方法，可以通过<code>SQLSession</code>直接运行映射的<code>sql</code>语句，完成对数据的增删改查和事物的提交工作，用完之后关闭<code>SQLSession</code>。</li>
</ul>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><ul>
<li>   view层，控制层，逻辑层，数据访问层</li>
<li>  设计各层可以采用设计接口 ，对应接口的实现类</li>
</ul>
<ol>
<li> 数据访问层（<code>dao</code>）</li>
</ol>
<ul>
<li> 这一层主要是做数据持久层的工作，负责与数据库进行联络的一些任务都封装在此</li>
<li>也就是说，我们在这一层创建的类都是数据库中某个关系，例如数据库现在有file表，表的属性有三个，那么就可以在entity层（dao）设计一个file类，它有对应名字的三个内部属性。</li>
<li>如何映射呢？我们需要对每一个<code>entity</code>编写对应的<code>.xml</code>，idea对应插件<code>Mybatis</code></li>
</ul>
<ol start="2">
<li><p>Service</p>
<ul>
<li><p>这一层主要是进一步封装，我们在<code>dao</code>层写好的<code>.xml</code>会有如下</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectByPrimaryKey<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>java.lang.Integer<span class="token punctuation">"</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>BaseResultMap<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
       <span class="token comment">&lt;!--@mbg.generated--></span>
       select
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">refid</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Base_Column_List<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
       from file
       where id = #&#123;id,jdbcType=INTEGER&#125;
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>其中<code>id </code>属性就是将这个<code>select</code>操作映射为我们熟悉的函数<code>selectByPrimaryKey</code>，这样我们在Mapper定义的接口，Service层依旧按照接口到实现类，就可以调用直接的函数，而不涉及<code>dao</code>层的操作</p>
</li>
</ul>
</li>
<li><p><code>controller</code></p>
<ul>
<li>调用<code>service</code>接口</li>
</ul>
</li>
<li><p>配置各层</p>
<ul>
<li>spring-dao.xml</li>
</ul>
<p>​           扫描<code>dao</code>层，配置数据库连接池，配置<code>SqlSessionFactory</code>对象</p>
<pre><code>    <pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>context</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/context<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans
       	http://www.springframework.org/schema/beans/spring-beans.xsd
	http://www.springframework.org/schema/context
	http://www.springframework.org/schema/context/spring-context.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token comment">&lt;!-- 配置整合mybatis过程 --></span>
    <span class="token comment">&lt;!-- 1.配置数据库相关参数properties的属性：$&#123;url&#125; --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>property-placeholder</span> <span class="token attr-name">location</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>classpath:jdbc.properties<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>

    <span class="token comment">&lt;!-- 2.数据库连接池 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dataSource<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.mchange.v2.c3p0.ComboPooledDataSource<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!-- 配置连接池属性 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>driverClass<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;jdbc.driver&#125;<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>jdbcUrl<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;jdbc.url&#125;<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;jdbc.username&#125;<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;jdbc.password&#125;<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token comment">&lt;!-- c3p0连接池的私有属性 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>maxPoolSize<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>minPoolSize<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token comment">&lt;!-- 关闭连接后不自动commit --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>autoCommitOnClose<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token comment">&lt;!-- 获取连接超时时间 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>checkoutTimeout<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>10000<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token comment">&lt;!-- 当获取连接失败重试次数 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>acquireRetryAttempts<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span>
    
    <span class="token comment">&lt;!-- 3.配置SqlSessionFactory对象 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sqlSessionFactory<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.mybatis.spring.SqlSessionFactoryBean<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!-- 注入数据库连接池 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dataSource<span class="token punctuation">"</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dataSource<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token comment">&lt;!-- 配置MyBaties全局配置文件:mybatis-config.xml --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>configLocation<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>classpath:mybatis-config.xml<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token comment">&lt;!-- 扫描entity包 使用别名 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>typeAliasesPackage<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.ssm.entity<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token comment">&lt;!-- 扫描sql配置文件:mapper需要的xml文件 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mapperLocations<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>classpath:com/ssm/entity/*/*.xml<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span>
    
    <span class="token comment">&lt;!-- 4.配置扫描Dao接口包，动态实现Dao接口，注入到spring容器中 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.mybatis.spring.mapper.MapperScannerConfigurer<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!-- 注入sqlSessionFactory --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sqlSessionFactoryBeanName<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sqlSessionFactory<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token comment">&lt;!-- 给出需要扫描Dao接口包 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>basePackage<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.ssm.mapper<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</code></pre>
<p><img src="/.com//Users\86176\AppData\Roaming\Typora\typora-user-images\image-20211111183336074.png" alt="image-20211111183336074"></p>
</li>
</ol>
<p><img src="/.com//Users\86176\AppData\Roaming\Typora\typora-user-images\image-20211111183454546.png" alt="image-20211111183454546"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://keeganli.github.com/2021/11/11/ssm%E6%A1%86%E6%9E%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GaoMing">
      <meta itemprop="description" content="终身浪漫">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GaoMing's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/11/ssm%E6%A1%86%E6%9E%B6/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-11-11 09:20:56 / 修改时间：10:41:48" itemprop="dateCreated datePublished" datetime="2021-11-11T09:20:56Z">2021-11-11</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>title: ssm<br>date: 2021-05-20 21:05:15<br>tags: ssm<br>categories: ssm</p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p><code>ssm</code>全称<code>Spring</code>+<code>SpringMVC</code>+<code>MyBatis</code>，是目前比较主流的<code>Java EE</code>企业级框架，将整个系统划分为表现层，<code>controller</code>层，<code>service</code> 层，<code>DAO</code> 层四层。</p>
<ul>
<li>使用<code>spring MVC</code>负责<strong>请求的转发和视图管理</strong></li>
<li><code>spring</code>实现业务对象管理</li>
<li><code>mybatis</code>作为数据对象的持久化引擎</li>
</ul>
<h3 id="SpringMVC"><a href="#SpringMVC" class="headerlink" title="SpringMVC"></a><code>SpringMVC</code></h3><ol>
<li><p><code>SpringMVC</code>原理图</p>
<ul>
<li>客户端发送请求到 <code>DispacherServlet</code>（前端控制器即分发器），这里可以设置拦截器，对请求进行过滤处理；</li>
<li>由 <code>DispacherServlet </code>控制器查询 <code>HanderMapping</code>，通过解析请求，判断请求希望执行的具体方法，即找到处理请求的 Controller；</li>
<li>通过 <code>HandlerAdapter </code>调用具体的<code>Controller</code>方法；</li>
<li><code>Controller</code> 调用业务逻辑处理后，返回 <code>ModelAndView</code>，即控制器结果返回给视图解析器；</li>
<li><code>DispacherServlet</code> 查询视图解析器，找到<code>ModelAndView </code>指定的视图</li>
<li>视图负责将结果显示到客户端</li>
</ul>
<p><img src="/.com//Users\86176\AppData\Roaming\Typora\typora-user-images\image-20211111173745311.png" alt="image-20211111173745311"></p>
</li>
<li><p><code>SpringMVC</code>配置文件</p>
<ul>
<li><p>web.xml：在 中要配置前端控制器，springmvc 的配置文件位置、自启动、拦截器以及编码过滤器；</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">></span></span>SpringDispatcherServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">></span></span>org.springframework.web.servlet.DispatcherServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>init-param</span><span class="token punctuation">></span></span> <span class="token comment">&lt;!-- servlet 初始化参数配置 --></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">></span></span>contextConfigLocation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">></span></span>   <span class="token comment">&lt;!-- key --></span>
     <span class="token comment">&lt;!-- 引入spring配置文件 --></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">></span></span>classpath:spring/spring-*.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">></span></span> <span class="token comment">&lt;!-- val --></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>init-param</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">></span></span>SpringDispatcherServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">></span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">></span></span>
     <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>springmvc.xml ：配置扫描包，即项目中所有 controller 位置，配置注解驱动（一般使用注解），配置不要拦截静态资源、自定义视图解析器（就是前后缀，可以和 controller 的返回值相连接，构成完整的页面路径）；</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>context</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/context<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>mvc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/mvc<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans
	http://www.springframework.org/schema/beans/spring-beans.xsd
	http://www.springframework.org/schema/context
	http://www.springframework.org/schema/context/spring-context.xsd
	http://www.springframework.org/schema/mvc
	http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token comment">&lt;!-- 配置SpringMVC --></span>
    <span class="token comment">&lt;!-- 1.开启SpringMVC注解模式 --></span>
    <span class="token comment">&lt;!-- 简化配置：
        (1)自动注册DefaultAnootationHandlerMapping,AnotationMethodHandlerAdapter
        (2)提供一些列：数据绑定，数字和日期的format @NumberFormat, @DateTimeFormat, xml,json默认读写支持
    --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mvc:</span>annotation-driven</span> <span class="token punctuation">/></span></span>

    <span class="token comment">&lt;!-- 2.静态资源默认servlet配置
        (1)加入对静态资源的处理：js,gif,png
        (2)允许使用"/"做整体映射
     --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mvc:</span>default-servlet-handler</span><span class="token punctuation">/></span></span>

    <span class="token comment">&lt;!-- 3.配置jsp 显示ViewResolver --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.springframework.web.servlet.view.InternalResourceViewResolver<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewClass<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.springframework.web.servlet.view.JstlView<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>prefix<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/WEB-INF/jsp/<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>suffix<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>.jsp<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span>
    <span class="token comment">&lt;!-- 4.扫描web相关的bean --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>component-scan</span> <span class="token attr-name">base-package</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.ssm.controller<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
</li>
<li></li>
</ol>
<h3 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a><code>Spring</code></h3><ul>
<li><strong>可以装载bean（也就是我们Java中的类，当然也包括service dao里面的</strong>），有了这个机制，我们就不用在每次使用这个类的时候为它初始化，很少看到关键字new。另外spring的aop，事务管理等等都是我们经常用到的。</li>
</ul>
<h3 id="Mybatis"><a href="#Mybatis" class="headerlink" title="Mybatis"></a>Mybatis</h3><ul>
<li><code>Mybatis：mybatis</code>是对<code>jdbc</code>的封装，它让数据库底层操作变的透明。<code>mybatis</code>的操作都是围绕一个<code>sqlSessionFactory</code>实例展开的。<code>mybatis</code>通过配置文件关联到各实体类的Mapper文件，Mapper文件中配置了每个类对数据库所需进行的<code>sql</code>语句映射**。在每次与数据库交互时，通过<code>sqlSessionFactory</code>拿到一个<code>sqlSession</code>，再执行<code>sql</code>命令。</li>
<li><code>mybatis</code>通过配置文件创建<code>sqlsessionFactory</code>，<code>sqlsessionFactory</code>根据配置文件，配置文件来源于两个方面:一个是<code>xml</code>，一个是<code>Java</code>中的注解，获取<code>sqlSession</code>。<code>SQLSession</code>包含了执行<code>sql</code>语句的所有方法，可以通过<code>SQLSession</code>直接运行映射的<code>sql</code>语句，完成对数据的增删改查和事物的提交工作，用完之后关闭<code>SQLSession</code>。</li>
</ul>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><ul>
<li>   view层，控制层，逻辑层，数据访问层</li>
<li>  设计各层可以采用设计接口 ，对应接口的实现类</li>
</ul>
<ol>
<li> 数据访问层（<code>dao</code>）</li>
</ol>
<ul>
<li> 这一层主要是做数据持久层的工作，负责与数据库进行联络的一些任务都封装在此</li>
<li>也就是说，我们在这一层创建的类都是数据库中某个关系，例如数据库现在有file表，表的属性有三个，那么就可以在entity层（dao）设计一个file类，它有对应名字的三个内部属性。</li>
<li>如何映射呢？我们需要对每一个<code>entity</code>编写对应的<code>.xml</code>，idea对应插件<code>Mybatis</code></li>
</ul>
<ol start="2">
<li><p>Service</p>
<ul>
<li><p>这一层主要是进一步封装，我们在<code>dao</code>层写好的<code>.xml</code>会有如下</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectByPrimaryKey<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>java.lang.Integer<span class="token punctuation">"</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>BaseResultMap<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
       <span class="token comment">&lt;!--@mbg.generated--></span>
       select
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">refid</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Base_Column_List<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
       from file
       where id = #&#123;id,jdbcType=INTEGER&#125;
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>其中<code>id </code>属性就是将这个<code>select</code>操作映射为我们熟悉的函数<code>selectByPrimaryKey</code>，这样我们在Mapper定义的接口，Service层依旧按照接口到实现类，就可以调用直接的函数，而不涉及<code>dao</code>层的操作</p>
</li>
</ul>
</li>
<li><p><code>controller</code></p>
<ul>
<li>调用<code>service</code>接口</li>
</ul>
</li>
<li><p>配置各层</p>
<ul>
<li>spring-dao.xml</li>
</ul>
<p>​           扫描<code>dao</code>层，配置数据库连接池，配置<code>SqlSessionFactory</code>对象</p>
<pre><code>    <pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>context</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/context<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans
       	http://www.springframework.org/schema/beans/spring-beans.xsd
	http://www.springframework.org/schema/context
	http://www.springframework.org/schema/context/spring-context.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token comment">&lt;!-- 配置整合mybatis过程 --></span>
    <span class="token comment">&lt;!-- 1.配置数据库相关参数properties的属性：$&#123;url&#125; --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>property-placeholder</span> <span class="token attr-name">location</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>classpath:jdbc.properties<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>

    <span class="token comment">&lt;!-- 2.数据库连接池 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dataSource<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.mchange.v2.c3p0.ComboPooledDataSource<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!-- 配置连接池属性 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>driverClass<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;jdbc.driver&#125;<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>jdbcUrl<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;jdbc.url&#125;<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;jdbc.username&#125;<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;jdbc.password&#125;<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token comment">&lt;!-- c3p0连接池的私有属性 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>maxPoolSize<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>minPoolSize<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token comment">&lt;!-- 关闭连接后不自动commit --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>autoCommitOnClose<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token comment">&lt;!-- 获取连接超时时间 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>checkoutTimeout<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>10000<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token comment">&lt;!-- 当获取连接失败重试次数 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>acquireRetryAttempts<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span>

    <span class="token comment">&lt;!-- 3.配置SqlSessionFactory对象 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sqlSessionFactory<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.mybatis.spring.SqlSessionFactoryBean<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!-- 注入数据库连接池 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dataSource<span class="token punctuation">"</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dataSource<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token comment">&lt;!-- 配置MyBaties全局配置文件:mybatis-config.xml --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>configLocation<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>classpath:mybatis-config.xml<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token comment">&lt;!-- 扫描entity包 使用别名 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>typeAliasesPackage<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.ssm.entity<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token comment">&lt;!-- 扫描sql配置文件:mapper需要的xml文件 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mapperLocations<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>classpath:com/ssm/entity/*/*.xml<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span>

    <span class="token comment">&lt;!-- 4.配置扫描Dao接口包，动态实现Dao接口，注入到spring容器中 --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.mybatis.spring.mapper.MapperScannerConfigurer<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!-- 注入sqlSessionFactory --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sqlSessionFactoryBeanName<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sqlSessionFactory<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token comment">&lt;!-- 给出需要扫描Dao接口包 --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>basePackage<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.ssm.mapper<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</code></pre>
<p><img src="/.com//Users\86176\AppData\Roaming\Typora\typora-user-images\image-20211111183336074.png" alt="image-20211111183336074"></p>
</li>
</ol>
<p><img src="/.com//Users\86176\AppData\Roaming\Typora\typora-user-images\image-20211111183454546.png" alt="image-20211111183454546"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://keeganli.github.com/2021/09/09/%E4%BB%8E%E9%9B%B6%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E8%BF%9B%E9%98%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GaoMing">
      <meta itemprop="description" content="终身浪漫">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GaoMing's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/09/09/%E4%BB%8E%E9%9B%B6%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E8%BF%9B%E9%98%B6/" class="post-title-link" itemprop="url">从零搭建个人博客进阶</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-09-08 20:00:26 / 修改时间：12:40:08" itemprop="dateCreated datePublished" datetime="2021-09-08T20:00:26Z">2021-09-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Hexo%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/" itemprop="url" rel="index"><span itemprop="name">Hexo个人博客搭建</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Hexo%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/%E4%BB%8E%E9%9B%B6%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E8%BF%9B%E9%98%B6/" itemprop="url" rel="index"><span itemprop="name">从零搭建个人博客进阶</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>​        经过上一篇，大家已经初步实现了个人独立博客网站的建立，通过本地编写<code>.md</code>文件，利用<code>Hexo</code>渲染，上传到<code>Github</code>上。但是，相信大家也有所发现，输入的博客地址并不美观，网站需要输入<code>.github.com</code>，如果可以像百度一样，输入<code>baidu.com</code>就好了。嘿嘿嘿，不要着急，我这就手把手带大家申请自己的专属网站域名！！！</p>
<h1 id="域名"><a href="#域名" class="headerlink" title="域名"></a>域名</h1><p>​        域名，通俗地讲就是由一串用点分隔的字符串组成的标识计算机地址的名称。它和我们所说的<code>ip</code>类似。</p>
<p>​        申请域名并不麻烦，这里呢，我就以申请腾讯云的域名给大家讲解一哈。</p>
<h2 id="域名购买和设置"><a href="#域名购买和设置" class="headerlink" title="域名购买和设置"></a>域名购买和设置</h2><ul>
<li>登录到<a target="_blank" rel="noopener" href="https://dnspod.cloud.tencent.com/">腾讯云</a>，进行实名认证</li>
<li>注册完后点击此<a target="_blank" rel="noopener" href="https://cloud.tencent.com/act/domainsales?from=dnspodqcloud">链接</a></li>
<li>不同的域名价格不一样，大家自行选择自己适合的一个域名</li>
<li>购买之后，点击页面右上角控制台</li>
<li>进入之后点击域名注册，进入域名控制台<ul>
<li>点击解析，修改内容<br>记录类型：CNAME<br>主机记录：@或者www均可<br>解析线路：默认<br>记录值：<code>[用户名].github.io</code> 很关键</li>
</ul>
</li>
</ul>
<h2 id="Github仓库设置"><a href="#Github仓库设置" class="headerlink" title="Github仓库设置"></a><code>Github</code>仓库设置</h2><p>​    上面的域名解析完成后，打开我们的<code>Github</code>，进入新建的博客仓库，点击<code>Settings，选择</code>Pages`</p>
<p>修改<code>Custom domain</code>,输入你的域名，比如我购买的是<code>.cn</code>，我就输入<code>keegan.cn</code>，点击<code>save</code>保存即可</p>
<h2 id="本地设置"><a href="#本地设置" class="headerlink" title="本地设置"></a>本地设置</h2><p>这一步需要我们在本地添加解析</p>
<p>具体操作很简单，首先打开本地博客目录(与<code>_config.yml</code>同目录)，新建文件<code>CNAME</code>，<strong>无任何后缀</strong></p>
<p>在里面输入你的域名，例如我的，我就输入<code>www.keegan.cn</code>，保存即可。</p>
<p>最后，在博客目录下，打开<code>git bash</code>，输入</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">hexo c
hexo g
hexo d<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>如果你可以在浏览器输入你的域名并成功打开你的网站，说明成功啦！！！</p>
<p>如果出现问题，可以及时联系我，我的联系方式在右上角<code>about</code>界面</p>
<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><p>那这一期的域名设置就讲解完啦，下一期我会和大家讲解<code>_config.yml</code>的基本属性，下下期讲<code>.md</code>编辑器的推荐以及<code>.md</code>书写规则</p>
<p>阿巴阿巴阿巴阿巴，还有好多可以讲的，那么我们下期再见啦！！！</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://keeganli.github.com/2021/09/07/Hexo%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GaoMing">
      <meta itemprop="description" content="终身浪漫">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GaoMing's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/09/07/Hexo%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/" class="post-title-link" itemprop="url">Hexo个人博客搭建</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-09-06 21:26:04" itemprop="dateCreated datePublished" datetime="2021-09-06T21:26:04Z">2021-09-06</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-09-07 09:42:45" itemprop="dateModified" datetime="2021-09-07T09:42:45Z">2021-09-07</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Hexo%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/" itemprop="url" rel="index"><span itemprop="name">Hexo个人博客搭建</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Hexo%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/%E4%BB%8E%E9%9B%B6%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/" itemprop="url" rel="index"><span itemprop="name">从零搭建个人博客</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="个人博客的重要性"><a href="#个人博客的重要性" class="headerlink" title="个人博客的重要性"></a>个人博客的重要性</h1><p>​    当前博客有两种，一种是使用第三方平台的个人博客，例如CSDN，博客园，掘金等；还有一种是独立博客，自己搭建和购买域名的。</p>
<p>无论哪一种，书写博客可以使我们加深对技术的理解，而且还能从中获取自信感，看着通过自己的不断耕耘，收获感十足。</p>
<p>本篇博客就详细介绍如何使用<code>Hexo</code>搭建个人博客</p>
<h1 id="前期准备"><a href="#前期准备" class="headerlink" title="前期准备"></a>前期准备</h1><h2 id="知识储备"><a href="#知识储备" class="headerlink" title="知识储备"></a>知识储备</h2><ul>
<li><p>网站</p>
<p>​       当我们访问某一网站，例如百度(<a target="_blank" rel="noopener" href="http://www.baidu.com)时,我们在地址栏中输入的便是网址(也称域名),实际上是我们在连接百度的服务器,百度服务器接收到我们的访问请求后,会返回文件(`.html`等),经过本地浏览器的渲染处理,就可以看到百度网站./">www.baidu.com)时，我们在地址栏中输入的便是网址(也称域名),实际上是我们在连接百度的服务器，百度服务器接收到我们的访问请求后，会返回文件(`.html`等)，经过本地浏览器的渲染处理，就可以看到百度网站。</a></p>
</li>
<li><p><code>Github</code></p>
<p>​    <code>GitHub</code>是一个项目的托管平台，因为只支持<code>Git</code>作为唯一的版本库格式进行托管，故名<code>GitHub</code>。<code>GitHub</code>可以托管各种<code>git</code>库，并提供一个<code>web</code>界面。使用<code>Github</code>我们可以使用<code>Git</code>将本地的网站静态托管到<code>Github</code>，这样我们便实现了网络访问网站，同时云存储了网站内容，可谓强的离谱。</p>
<ul>
<li><p><code>Git</code></p>
<p>​    Git是目前世界上最先进的分布式版本控制系统。我们不需要对<code>Git</code>有太多了解，只需知道我们通过<code>Git</code>客户端连接<code>Github</code>和本地。想要具体了解<code>Git</code>，可以看<a target="_blank" rel="noopener" href="https://www.liaoxuefeng.com/wiki/896043488029600">廖雪峰的系列教程</a></p>
</li>
</ul>
</li>
<li><p><code>Hexo</code></p>
<p>​    <code>Hexo</code>是快速、简洁且高效的博客框架。通过博客框架，我们便免去了繁琐复杂的<code>css</code>格式设置，各种页面的编写，以及简单化了部署到<code>Github</code>的操作。</p>
</li>
<li><p><code>Node.js</code></p>
<p>​    简单的说 <code>Node.js </code>就是运行在服务端的 <code>JavaScript</code>。<code>Node.js</code> 是一个基于<code>Chrome JavaScript </code>运行时建立的一个平台。<code>Node.js</code>是一个事件驱动<code>I/O</code>服务端<code>JavaScript</code>环境，基于<code>Google</code>的<code>V8</code>引擎，<code>V8</code>引擎执行<code>Javascript</code>的速度非常快，性能非常好。我们需要下载<code>node.js</code>来渲染本地的<code>hexo</code>文件。</p>
</li>
</ul>
<h2 id="下载准备"><a href="#下载准备" class="headerlink" title="下载准备"></a>下载准备</h2><p>​    我们需要下载的有连接服务端(<code>Github</code>)的<code>Git</code>，以及博客模板<code>Hexo</code>和<code>Node.js</code>，以及一些插件等。</p>
<ul>
<li><h3 id="安装Git"><a href="#安装Git" class="headerlink" title="安装Git"></a>安装<code>Git</code></h3><p>直接前往官网<a target="_blank" rel="noopener" href="https://git-scm.com/downloads">下载</a></p>
</li>
<li><h3 id="安装-node-js"><a href="#安装-node-js" class="headerlink" title="安装 node.js"></a>安装<code> node.js</code></h3><p>直接前往官网<a target="_blank" rel="noopener" href="https://nodejs.org/en/download/">下载</a></p>
</li>
<li><h3 id="安装-Hexo"><a href="#安装-Hexo" class="headerlink" title="安装 Hexo"></a>安装 <code>Hexo</code></h3><p>首先在电脑主盘下新建文件夹-blog，然后在<code>git bash</code>端<code>cd</code>到该文件夹下，输入命令</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">npm install <span class="token operator">-</span>g hexo<span class="token operator">-</span>cli<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>安装完事后，使用命令检测安装的版本</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">hexo <span class="token operator">-</span>v<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>随后初始化<code>hexo</code>，<code>Blog</code>随便起的名字</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">hexo init Blog<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>然后进入到目录</p>
<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">cd Blog &#x2F;&#x2F;进入到Blog文件下
npm install &#x2F;&#x2F;执行安装hexo命令（此命令依赖的是nodejs）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>等待片刻，安装结束后，打开文件可以看到如下</p>
<p>（当然，我的目录下多一些其他的，这是我自己导入的一些插件之类的，主文件有就行啦）</p>
<p><img src="https://i.ibb.co/PwdnRrt/QQ-20210907143005.jpg"></p>
<p>其中，<code>node_modules</code>是依赖包，<code>public</code>是存放生成的页面(<code>.html</code>)，<code>scaffolds</code>是模板，<code>source</code>是各种资源(包括我们自己写的文章)，<code>themes</code>是主题包</p>
<p>最重要的是<code>_config.yml</code>，这个是博客的<strong>配置文件</strong>，经常使用，十分重要！！！（注意备份一份，以防不备，血的教训）</p>
<p>在做完这些后，我们就可以在<code>git bash</code>命令窗口敲下如下<code>hexo</code>命令（注意当前git显示的目录应该在这个blog下）</p>
<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">hexo g &#x2F;&#x2F;用来渲染博客页面
hexo s &#x2F;&#x2F;用来生成页面<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="https://i.ibb.co/bNgPZPG/QQ-20210907145003.jpg"></p>
<p>到了这一步，提前恭喜你了，打开浏览器，输入他给的地址（我的是<a href="http://localhost:4000），就可以看到生成的博客了。">http://localhost:4000），就可以看到生成的博客了。</a></p>
</li>
</ul>
<h1 id="Github仓库设置"><a href="#Github仓库设置" class="headerlink" title="Github仓库设置"></a><code>Github</code>仓库设置</h1><p>​    我们本地的<code>hexo</code>设置好后，我们需要设置一个自己的<code>Github</code>仓库，并连接到本地，实现上传博客到仓库，托管网站的功能</p>
<ul>
<li><p>注册<code>Github</code>账号</p>
</li>
<li><p>新建仓库</p>
<p>​    <img src="https://i.ibb.co/jRqg6st/QQ-20210907145531.jpg"></p>
<p>这里设置仓库名时一定是满足 “yourNickName.github.io”格式，如图</p>
<p><img src="https://i.ibb.co/93sj9xm/QQ-20210907145732.jpg"></p>
<p>随后点击<code>Create repository</code></p>
</li>
<li><p>生成<code>ssh</code>密钥连接本地</p>
<p>​     <code>SSH</code>是一种安全协议。<code>SSH</code>登录是需要用户名和密码的，要实现无密码登录，就需要创建<code>SSH </code>密钥（<code>ssh key</code>），<code>SSH</code> 密钥可以认为是和另一台电脑通信时的唯一的识别证，<code>SSH</code>密钥对可以让我们方便的登录到 <code>SSH</code> 服务器，而无需输入密码。</p>
<p>​    此操作需要我们在<code>git</code>端输入以下命令</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">git config <span class="token operator">--</span>global user<span class="token punctuation">.</span>name <span class="token string">"yourname"</span>	<span class="token comment">//你的github用户名</span>
git config <span class="token operator">--</span>global user<span class="token punctuation">.</span>email <span class="token string">"youremail"</span>	<span class="token comment">//你的github注册的邮箱</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>然后创建本地的<code>ssh</code>密钥</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">ssh<span class="token operator">-</span>keygen <span class="token operator">-</span>t rsa <span class="token operator">-</span>C <span class="token string">"youremail"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>不报错的情况下到本地的用户目录下的<code>.shh</code>文件夹</p>
<p><img src="https://i.ibb.co/x7ZHncp/QQ-20210907154041.jpg"></p>
<p>复制 <code>id-rsa</code>中的内容（<code>txt</code>打开即可）,然后在<code>Github</code>端添加，具体操作是打开<code>Setting</code>,找到<code>SSH and GPG keys</code>选项，<code>Ctrl + v</code>就可以啦。</p>
<p><img src="https://i.ibb.co/bdxdvW8/QQ-20210907154632.jpg"></p>
</li>
</ul>
<h1 id="Hexo部署到Github"><a href="#Hexo部署到Github" class="headerlink" title="Hexo部署到Github"></a><code>Hexo</code>部署到<code>Github</code></h1><p>​    这一步我们需要将<code>hexo</code>和<code>Github</code>仓库连接，实现将本地<code>hexo</code>生成的文章部署到<code>Github</code>。</p>
<p>​    具体操作如下：</p>
<ul>
<li><p>打开本地<code>Blog</code>目录下的<code>_config.yml</code>配置文件，<code>Ctrl + f</code>查找 <code>deploy</code></p>
<pre class="line-numbers language-yml" data-language="yml"><code class="language-yml">deploy:
  type: git
  repo:    
   	    github: git@github.com:yourNickName&#x2F;yourNickName.github.io.git 
   	    # yourNickName是注册Github时的用户名
  branch: master<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>然后打开<code>Git</code>窗口，利用<code>npm</code>安装 <code>deploy-git</code></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">npm install hexo<span class="token operator">-</span>deployer<span class="token operator">-</span>git <span class="token operator">--</span>save<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>随后，万能三键式</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">hexo c	<span class="token comment">//清除之前的缓存</span>
hexo g	<span class="token comment">//将编写的md文件生成静态页面</span>
hexo d	<span class="token comment">//部署到Github</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>其中<code>hexo d</code>命令可能会输入密码，自己设置一个<strong>常用的即可</strong>。</p>
<p>如果没有报错，<code>git</code>端显示 <code>INFO  Deploy done: git</code>，说明成功啦！！！</p>
</li>
<li><p>最后，你就可以在浏览器地址栏缓缓敲入<code>http://yourNickName.github.io</code></p>
<p>如果成功打开，那么恭喜你，你已经有自己的个人独立博客啦！！！</p>
</li>
</ul>
<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><p>这一篇就先讲解如何成功拥有个人独立博客</p>
<p>接下来几篇我会教大家以下内容</p>
<ul>
<li>设置个人域名</li>
<li><code>_config.yml</code>的基本设置</li>
<li><code>hexo</code>主题的设置与更换</li>
<li>其他的网站优化加速访问的方法等等等干货</li>
</ul>
<p>持续关注哟！！！下篇再见</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>
<script src="/js/comments.js"></script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">GaoMing</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  






  





  
<script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>

</body>
</html>
